{"meta":{"title":"Davis' Blog","subtitle":"ä¸“æ³¨äºGolangã€Node.jsæŠ€æœ¯","description":"æ¬¢è¿æ¥åˆ°æ²¡äº‹æ”¾æ”¾ç‰›çš„ä¸ªäººåšå®¢ï¼","author":"æ²¡äº‹æ”¾æ”¾ç‰›","url":"https://pengfeidai.github.io"},"pages":[{"title":"","date":"2020-06-12T04:35:54.001Z","updated":"2020-05-22T12:29:23.000Z","comments":true,"path":"404.html","permalink":"https://pengfeidai.github.io/404.html","excerpt":"","text":"æ²¡äº‹æ”¾æ”¾ç‰›â€”msffn.com | 404 html, body { height: 100%; min-height: 100%; background: #161B20; overflow: hidden } #block { width: 1px; height: 1px; font-size: 10px } #block:after { content: ''; position: absolute; top: 36%; left: 50%; width: 1em; height: 1em; -webkit-transform: translateX(-14em); transform: translateX(-14em) } @media screen and (max-width:320px) { #block:after { -webkit-transform: translateX(-11.5em) scale(.8); transform: translateX(-11.5em) scale(.8) } } .home { position: absolute; bottom: 10%; left: 50%; margin-left: -14px; text-decoration: none } .icon-home { position: relative; display: block; width: 30px; height: 30px; background: #484C4D } .icon-home:before { content: ''; position: absolute; width: 0; height: 0; top: -40px; left: -9px; border: 24px solid transparent; border-bottom-color: #484C4D } .icon-home:after { content: ''; position: absolute; height: 0; width: 0; top: 16px; left: 7px; width: 16px; height: 14px; background: #161B20 } !function() { function n() { return \"#\" + (\"00000\" + (16777215 * Math.random() + .5 >> 0).toString(16)).slice( - 6) } function e(e, t) { return e + \"em \" + t + \"em \" + n() } function t(n, e, t, u) { var r = document.getElementById(n); r || (r = document.createElement(\"style\"), r.id = n), r.innerHTML = e + \"{\" + t + \":\" + u + \";}\", document.getElementsByTagName(\"head\")[0].appendChild(r) } function u(n, t, u, r) { for (var o = [], s = 0, h = t - .5; n + u >= s; s++, h = t - .5 * (s + 1)) if (s === n) for (var i = h + .5; t + r >= i; i++) o.push(e(i, n)); else o.push(e(t, s)), n > s && o.push(e(h, s + .5)); return o.join(\",\") } function r(n, t, u) { for (var r = [], o = 0, s = 0; u > s; s++) r.push(e(n + s, 0)), r.push(e(n + s, t)); for (r.push(e(n - .5, o + .5)), r.push(e(n + u - 1 + .5, o + .5)), o = t - 1, r.push(e(n - .5, o + .5)), r.push(e(n + u - 1 + .5, o + .5)), s = 1; t > s; s++) r.push(e(n - 1, s)), r.push(e(n + u, s)); return r.join(\",\") } setInterval(function() { t(\"style\", \"#block:after\", \"box-shadow\", u(10, 5, 2, 1) + \",\" + r(12, 12, 5) + \",\" + u(10, 26, 2, 1)) }, 200) } ();"},{"title":"å…³äºæˆ‘","date":"2017-07-07T13:19:11.000Z","updated":"2020-05-22T12:53:56.000Z","comments":true,"path":"about/index.html","permalink":"https://pengfeidai.github.io/about/index.html","excerpt":"","text":"ä¸ªäººç®€ä»‹ å§“åï¼š æˆ´é¹é£ å­¦æ ¡ï¼š é•¿æ±Ÿå¤§å­¦ ä¸“ä¸šï¼š è½¯ä»¶å·¥ç¨‹ QQï¼š 302804389(å¼€å§‹èŠå¤©) é‚®ç®±ï¼š 302804389@qq.com GitHubï¼š https://github.com/pengfeidai ä¸ªäººç®€ä»‹ï¼š ğŸ‘‰ç›®å‰ä¸“æ³¨äºGolangã€Nodejsçš„ç¨‹åºçŒ¿ä¸€æš(^ Ï‰ ^) ! ! ! æŠ€æœ¯æ¸…å•ï¼š Golangã€Node.js ã€Myslqã€MongoDBã€Redisã€åˆ†å¸ƒå¼ã€å®¹å™¨ç­‰"},{"title":"æˆ‘çš„ä½œå“","date":"2020-06-12T04:35:54.084Z","updated":"2020-05-23T15:45:15.000Z","comments":false,"path":"categories/index.html","permalink":"https://pengfeidai.github.io/categories/index.html","excerpt":"","text":"@timeline{ è¯¦æƒ…ç´¢å¼•@item{ 2020.04Gin-app-startåŸºäº Gin å°è£…çš„å¼€å‘æ¡†æ¶ï¼ŒåŒ…å«äº†ä¸€äº›å¸¸ç”¨ä¸­é—´ä»¶ã€æ–¹æ³•ä»¥åŠå¯¹æ•°æ®åº“çš„æ“ä½œï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä½¿ç”¨ç®€å•ã€‚ï¼ˆæŒç»­ï¼‰ } @item{ 2020.05ç”¨æˆ·ä¸­å¿ƒåŸºäºgin-app-startå®Œæˆçš„åŒä¸€çš„åº”ç”¨å±‚ç”¨æˆ·ä¸­å¿ƒåç«¯æœåŠ¡ï¼ŒåŒ…å«ç”¨æˆ·ç™»å½•ã€ä¼šè¯æ ¡éªŒã€è§’è‰²åˆ†é…ã€æƒé™ç®¡ç†ç­‰åŠŸèƒ½ã€‚ï¼ˆæŒç»­ï¼‰ } @item{ 2017.07ç§»åŠ¨ç«¯éŸ³ä¹ AppåŸºäº Vue å…¨å®¶æ¡¶ (2.x) åˆ¶ä½œçš„ç§»åŠ¨ç«¯éŸ³ä¹ WebAppã€‚ } @item{ 2017.08ç­çº§åšå®¢å‰ç«¯è¿ˆå‘å…¨æ ˆå…¥é—¨ç¯‡ã€‚åŸºäº Node.js + Express + ejs+ MongoDB + Bootstrap æ­å»ºçš„ç­çº§åšå®¢ç³»ç»Ÿã€‚ } }"},{"title":"tags","date":"2017-07-07T13:18:56.000Z","updated":"2020-05-22T12:54:35.000Z","comments":false,"path":"tags/index.html","permalink":"https://pengfeidai.github.io/tags/index.html","excerpt":"","text":"æ‚¨å¥½ï¼"}],"posts":[{"title":"etcdæ ¸å¿ƒåŸç†","slug":"etcdæ ¸å¿ƒåŸç†","date":"2020-06-05T14:52:28.000Z","updated":"2020-06-17T14:04:33.170Z","comments":true,"path":"2020/06/05/etcdæ ¸å¿ƒåŸç†/","link":"","permalink":"https://pengfeidai.github.io/2020/06/05/etcdæ ¸å¿ƒåŸç†/","excerpt":"","text":"etcdç®€ä»‹etcd æ˜¯ä¸€ä¸ªé«˜åº¦ä¸€è‡´çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œå®ƒæä¾›äº†ä¸€ç§å¯é çš„æ–¹å¼æ¥å­˜å‚¨éœ€è¦ç”±åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–æœºå™¨é›†ç¾¤è®¿é—®çš„æ•°æ®ã€‚åœ¨å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå®ƒå†…éƒ¨é‡‡ç”¨ raftåè®® ä½œä¸ºä¸€è‡´æ€§ç®—æ³•ï¼ŒåŸºäºGoè¯­è¨€å®ç°ã€‚å…¶ä¸»è¦åŠŸèƒ½æœ‰æœåŠ¡æ³¨å†Œä¸å‘ç°ã€æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…ã€è´Ÿè½½å‡è¡¡ã€åˆ†å¸ƒå¼é€šçŸ¥ä¸åè°ƒã€åˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼é˜Ÿåˆ—ã€é›†ç¾¤ç›‘æ§ä¸ leader é€‰ä¸¾ç­‰ã€‚ ä¸»è¦å…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š ç®€å•ï¼šå®‰è£…é…ç½®ç®€å•ï¼Œæ˜“äºéƒ¨ç½²ï¼Œæ˜“ä½¿ç”¨ã€‚åŸºäº HTTP+JSON çš„ API è®©ä½ ç”¨ curl å°±å¯ä»¥è½»æ¾ä½¿ç”¨ã€‚ å®‰å…¨ï¼šæ”¯æŒ SSL è¯ä¹¦éªŒè¯ã€‚ é”®å€¼å¯¹å­˜å‚¨ï¼šå°†æ•°æ®å­˜å‚¨åœ¨åˆ†å±‚ç»„ç»‡çš„ç›®å½•ä¸­ï¼Œå¦‚åŒåœ¨æ ‡å‡†æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ ç›‘æµ‹å˜æ›´ï¼šç›‘æµ‹ç‰¹å®šçš„é”®æˆ–ç›®å½•ä»¥è¿›è¡Œæ›´æ”¹ï¼Œå¹¶å¯¹å€¼çš„æ›´æ”¹åšå‡ºååº”ã€‚ å¿«é€Ÿï¼šæ ¹æ®å®˜æ–¹æä¾›çš„ benchmark æ•°æ®ï¼Œå•å®ä¾‹æ”¯æŒæ¯ç§’ 2k+ è¯»æ“ä½œã€‚ å¯é ï¼šé‡‡ç”¨raftç®—æ³•ï¼Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿæ•°æ®çš„å¯ç”¨æ€§å’Œä¸€è‡´æ€§ã€‚ å­˜å‚¨ç‰¹ç‚¹etcd æ˜¯ä¸€ä¸ª é”®å€¼å­˜å‚¨ çš„ç»„ä»¶ï¼Œå…¶ä»–çš„åº”ç”¨éƒ½æ˜¯åŸºäºå…¶é”®å€¼å­˜å‚¨çš„åŠŸèƒ½å±•å¼€ã€‚etcd çš„å­˜å‚¨æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š é‡‡ç”¨kvå‹æ•°æ®å­˜å‚¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¯”å…³ç³»å‹æ•°æ®åº“å¿«ã€‚ æ”¯æŒåŠ¨æ€å­˜å‚¨(å†…å­˜)ä»¥åŠé™æ€å­˜å‚¨(ç£ç›˜)ã€‚ åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå¯é›†æˆä¸ºå¤šèŠ‚ç‚¹é›†ç¾¤ã€‚ å­˜å‚¨æ–¹å¼ï¼Œé‡‡ç”¨ç±»ä¼¼ç›®å½•ç»“æ„ã€‚ åªæœ‰å¶å­èŠ‚ç‚¹æ‰èƒ½çœŸæ­£å­˜å‚¨æ•°æ®ï¼Œç›¸å½“äºæ–‡ä»¶ã€‚ å¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸€å®šæ˜¯ç›®å½•ï¼Œç›®å½•ä¸èƒ½å­˜å‚¨æ•°æ®ã€‚ etcdåº”ç”¨åœºæ™¯etcd çš„åœºæ™¯é»˜è®¤å¤„ç†çš„æ•°æ®éƒ½æ˜¯ç³»ç»Ÿä¸­çš„æ§åˆ¶æ•°æ®ã€‚æ‰€ä»¥etcdåœ¨ç³»ç»Ÿä¸­çš„è§’è‰²ä¸æ˜¯å…¶ä»–NoSQLäº§å“çš„æ›¿ä»£å“ï¼Œæ›´ä¸èƒ½ä½œä¸ºåº”ç”¨çš„ä¸»è¦æ•°æ®å­˜å‚¨ã€‚etcdä¸­åº”è¯¥ å°½é‡åªå­˜å‚¨ç³»ç»Ÿä¸­æœåŠ¡çš„é…ç½®ä¿¡æ¯ï¼Œå¯¹äºåº”ç”¨æ•°æ®åªæ¨èæŠŠæ•°æ®é‡å¾ˆå°ï¼Œä½†æ˜¯æ›´æ–°å’Œè®¿é—®é¢‘æ¬¡éƒ½å¾ˆé«˜çš„æ•°æ®å­˜å‚¨åœ¨etcdä¸­ã€‚ æœåŠ¡å‘ç°ï¼ˆService Discoveryï¼‰æœåŠ¡å‘ç°è¦è§£å†³çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€ï¼Œå³åœ¨åŒä¸€ä¸ªåˆ†å¸ƒå¼é›†ç¾¤ä¸­çš„è¿›ç¨‹æˆ–æœåŠ¡ï¼Œè¦å¦‚ä½•æ‰èƒ½æ‰¾åˆ°å¯¹æ–¹å¹¶å»ºç«‹è¿æ¥ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒæœåŠ¡å‘ç°å°±æ˜¯æƒ³è¦äº†è§£é›†ç¾¤ä¸­æ˜¯å¦æœ‰è¿›ç¨‹åœ¨ç›‘å¬ udp æˆ– tcp ç«¯å£ï¼Œå¹¶ä¸”é€šè¿‡åå­—å°±å¯ä»¥æŸ¥æ‰¾å’Œè¿æ¥ã€‚ è¦è§£å†³æœåŠ¡å‘ç°çš„é—®é¢˜ï¼Œéœ€è¦å…·å¤‡ä¸‹é¢ä¸‰ç§å¿…å¤‡å±æ€§ï¼š ä¸€ä¸ªå¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨çš„æœåŠ¡å­˜å‚¨ç›®å½•ã€‚ åŸºäºRalfç®—æ³•çš„etcdå¤©ç”Ÿå°±æ˜¯è¿™æ ·ä¸€ä¸ªå¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨çš„æœåŠ¡å­˜å‚¨ç›®å½•ã€‚ ä¸€ç§æ³¨å†ŒæœåŠ¡å’Œç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€çš„æœºåˆ¶ã€‚ ç”¨æˆ·å¯ä»¥åœ¨etcdä¸­æ³¨å†ŒæœåŠ¡ï¼Œå¹¶ä¸”å¯¹æ³¨å†Œçš„æœåŠ¡é…ç½® key TTLï¼Œå®šæ—¶ä¿æŒæœåŠ¡çš„å¿ƒè·³ä»¥è¾¾åˆ°ç›‘æ§å¥åº·çŠ¶æ€çš„æ•ˆæœã€‚ ä¸€ç§æŸ¥æ‰¾å’Œè¿æ¥æœåŠ¡çš„æœºåˆ¶ã€‚ é€šè¿‡åœ¨ etcd æŒ‡å®šçš„ä¸»é¢˜ï¼ˆç”±æœåŠ¡åç§°æ„æˆçš„æœåŠ¡ç›®å½•ï¼‰ä¸‹æ³¨å†Œçš„æœåŠ¡ä¹Ÿèƒ½åœ¨å¯¹åº”çš„ä¸»é¢˜ä¸‹æŸ¥æ‰¾åˆ°ã€‚ images æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ€é€‚ç”¨çš„ä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼å°±æ˜¯æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…ã€‚å³æ„å»ºä¸€ä¸ªé…ç½®å…±äº«ä¸­å¿ƒï¼Œæ•°æ®æä¾›è€…åœ¨è¿™ä¸ªé…ç½®ä¸­å¿ƒå‘å¸ƒæ¶ˆæ¯ï¼Œè€Œæ¶ˆæ¯ä½¿ç”¨è€…åˆ™è®¢é˜…ä»–ä»¬å…³å¿ƒçš„ä¸»é¢˜ï¼Œä¸€æ—¦ä¸»é¢˜æœ‰æ¶ˆæ¯å‘å¸ƒï¼Œå°±ä¼šå®æ—¶é€šçŸ¥è®¢é˜…è€…ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥åšåˆ°åˆ†å¸ƒå¼ç³»ç»Ÿé…ç½®çš„é›†ä¸­å¼ç®¡ç†ä¸åŠ¨æ€æ›´æ–°ã€‚","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"etcd","slug":"etcd","permalink":"https://pengfeidai.github.io/tags/etcd/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://pengfeidai.github.io/tags/åˆ†å¸ƒå¼/"}]},{"title":"Protobufç”ŸæˆGoä»£ç ","slug":"Protobufç”ŸæˆGoä»£ç æŒ‡å—","date":"2020-05-31T13:58:21.000Z","updated":"2020-06-03T17:24:43.000Z","comments":true,"path":"2020/05/31/Protobufç”ŸæˆGoä»£ç æŒ‡å—/","link":"","permalink":"https://pengfeidai.github.io/2020/05/31/Protobufç”ŸæˆGoä»£ç æŒ‡å—/","excerpt":"","text":"Protobufç®€ä»‹Protobufæ˜¯Protocol Buffersçš„ç®€ç§°ï¼Œç”±Googleå…¬å¸å¼€å‘çš„ä¸€ç§æ•°æ®æè¿°è¯­è¨€ï¼Œç”¨äºæè¿°ä¸€ç§è½»ä¾¿é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œå®ƒå¯ç”¨äºç»“æ„åŒ–æ•°æ®ä¸²è¡ŒåŒ–ï¼Œæˆ–è€…è¯´åºåˆ—åŒ–ã€‚å®ƒçš„è®¾è®¡éå¸¸é€‚ç”¨äºåœ¨ç½‘ç»œé€šè®¯ä¸­çš„æ•°æ®è½½ä½“ï¼Œå¾ˆé€‚åˆåšæ•°æ®å­˜å‚¨æˆ– RPC æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå®ƒåºåˆ—åŒ–å‡ºæ¥çš„æ•°æ®é‡å°‘å†åŠ ä¸Šä»¥ K-V çš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®ï¼Œå¯¹æ¶ˆæ¯çš„ç‰ˆæœ¬å…¼å®¹æ€§éå¸¸å¼ºï¼Œå¯ç”¨äºé€šè®¯åè®®ã€æ•°æ®å­˜å‚¨ç­‰é¢†åŸŸçš„è¯­è¨€æ— å…³ã€å¹³å°æ— å…³ã€å¯æ‰©å±•çš„åºåˆ—åŒ–ç»“æ„æ•°æ®æ ¼å¼ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡Protobufé™„å¸¦çš„å·¥å…·ç”Ÿæˆä»£ç å¹¶å®ç°å°†ç»“æ„åŒ–æ•°æ®åºåˆ—åŒ–çš„åŠŸèƒ½ã€‚ Protobufä¸­æœ€åŸºæœ¬çš„æ•°æ®å•å…ƒæ˜¯messageï¼Œæ˜¯ç±»ä¼¼Goè¯­è¨€ä¸­ç»“æ„ä½“çš„å­˜åœ¨ã€‚åœ¨messageä¸­å¯ä»¥åµŒå¥—messageæˆ–å…¶å®ƒçš„åŸºç¡€æ•°æ®ç±»å‹çš„æˆå‘˜ã€‚ protocå®‰è£…åˆ° https://github.com/google/protobuf/releases ä¸‹è½½å¯¹åº”çš„bufï¼Œç„¶åè¿›è¡Œç¼–è¯‘åï¼Œä½¿ç”¨ protoc --version èƒ½æŸ¥çœ‹å¯¹åº”ç‰ˆæœ¬ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚ ç¯å¢ƒå˜é‡é…ç½®ç¬¬ä¸€æ­¥ï¼šif zsh vim ~/.zshrc; if bash vim ~/.bash_profile123export GOPATH=\"/Users/zl/go\"export GOBIN=\"/Users/zl/go/bin\"export PATH=\"$PATH:$GOPATH:$GOBIN\" ç¬¬äºŒæ­¥ï¼šsource ~/.zshrc || source ~/.bash_profile ç¬¬ä¸‰æ­¥: æŸ¥çœ‹ç¯å¢ƒå˜é‡ 1echo $PATH æ³¨æ„ï¼š ä»¥ä¸Šé…ç½®å…·ä½“è·¯å¾„ GOPATH å’Œ GOBIN æ ¹å®é™…å¡«å†™å³å¯ï¼Œå¯ä½¿ç”¨go envæŸ¥çœ‹ã€‚ ç¼–è¯‘å™¨Protobufæ ¸å¿ƒçš„å·¥å…·é›†æ˜¯C++è¯­è¨€å¼€å‘çš„ï¼Œå®˜æ–¹çš„protocç¼–è¯‘å™¨ä¸­å¹¶ä¸æ”¯æŒGoè¯­è¨€ï¼Œéœ€è¦å®‰è£…æ’ä»¶æ‰èƒ½ç”ŸæˆGoä»£ç ã€‚ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š 1go get github.com/golang/protobuf/protoc-gen-go å®ƒæä¾›äº†ä¸€ä¸ª protoc-gen-go äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå½“ç¼–è¯‘å™¨è°ƒç”¨æ—¶ä¼ é€’äº†--go_out å‘½ä»¤è¡Œæ ‡å¿—æ—¶ protoc å°±ä¼šä½¿ç”¨å®ƒã€‚â€“go_outä»£è¡¨è¾“å‡ºçš„æ‰©å±•åä¸º .pb.go çš„æ–‡ä»¶ã€‚ç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ª.protoæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„æºä»£ç æ–‡ä»¶ã€‚ æ³¨æ„ï¼š protoè·¯å¾„ï¼ˆä½¿ç”¨â€“proto_pathæˆ–-Iå‘½ä»¤è¡Œæ ‡å¿—æŒ‡å®šï¼‰å°†æ›¿æ¢ä¸ºè¾“å‡ºè·¯å¾„ï¼ˆä½¿ç”¨â€“go_outæ ‡å¿—æŒ‡å®šï¼‰ã€‚ æ‰©å±•: go-micro æ˜¯goè¯­è¨€ä¸­ä¸€ä¸ªå¾ˆå¥½çš„å¾®æœåŠ¡æ¡†æ¶ï¼ŒåŠŸèƒ½å®Œå–„ã€‚å…³äº micro åé¢å†åšè¯¦ç»†ä»‹ç»ã€‚å®ƒä¹Ÿæœ‰ä¸ªç›¸å¯¹åº”çš„æ’ä»¶ï¼š 1go get github.com/micro/protoc-gen-micro å®šä¹‰protoæ–‡ä»¶å…ˆåœ¨ proto ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª hello.proto æ–‡ä»¶ï¼š 12345678910111213syntax = \"proto3\";message HelloRequest &#123; string name = 1;&#125;message HelloResponse &#123; string greeting = 1;&#125;service Greeter &#123; rpc Hello(HelloRequest) returns (HelloResponse) &#123;&#125;&#125; ç”ŸæˆåŸå‹1protoc --proto_path=. --go_out=. */*.proto ç¼–è¯‘å™¨ä¼šè¯»å–protoç›®å½•ä¸‹æ‰€æœ‰åç¼€åä¸º .protoçš„æ–‡ä»¶ï¼Œè¿™å°†ä¼šç”Ÿæˆä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ product.pb.goã€‚ åŒ…é»˜è®¤è§„åˆ™å¦‚æœä¸€ä¸ª.protoæ–‡ä»¶ä¸­æœ‰åŒ…å£°æ˜ï¼Œç”Ÿæˆçš„æºä»£ç å°†ä¼šä½¿ç”¨å®ƒæ¥ä½œä¸ºGoçš„åŒ…åï¼Œå¦‚æœ.protoçš„åŒ…åä¸­æœ‰ . åœ¨GoåŒ…åä¸­ä¼šå°† . è½¬æ¢ä¸º _ã€‚ä¸¾ä¾‹æ¥è¯´protoåŒ…å example.hello å°†ä¼šç”ŸæˆGoåŒ…åexample_helloã€‚ æŒ‡å®šåŒ…ååœ¨.protoæ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨option go_package æŒ‡ä»¤æ¥è¦†ç›–ä¸Šé¢é»˜è®¤ç”ŸæˆGoåŒ…åçš„è§„åˆ™ã€‚æ¯”å¦‚è¯´åŒ…å«å¦‚ä¸‹æŒ‡ä»¤çš„ä¸€ä¸ª.protoæ–‡ä»¶ï¼š 12package example.hello;option go_package = \"proto;hello\"; &quot;proto;hello&quot;ï¼šprotoè¡¨ç¤ºç›®å½•ï¼Œhello åˆ™æ˜¯ç”Ÿæˆçš„Goæºä»£ç çš„åŒ…åæ˜¯ã€‚ ä¸æŒ‡å®šåŒ…åå¦‚æœä¸€ä¸ª.protoæ–‡ä»¶ä¸­ä¸åŒ…å«packageå£°æ˜ï¼Œç”Ÿæˆçš„æºä»£ç å°†ä¼šä½¿ç”¨.protoæ–‡ä»¶çš„æ–‡ä»¶å(å»æ‰æ‰©å±•å)ä½œä¸ºGoåŒ…åï¼Œ.ä¼šè¢«é¦–å…ˆè½¬æ¢ä¸º_ã€‚å¦‚ï¼šhello.proto æ–‡ä»¶é»˜è®¤ç”Ÿæˆæºæ–‡ä»¶çš„åŒ…åä¸º helloã€‚ importå…¶ä»–proto","categories":[],"tags":[{"name":"Go","slug":"Go","permalink":"https://pengfeidai.github.io/tags/Go/"},{"name":"Protobuf","slug":"Protobuf","permalink":"https://pengfeidai.github.io/tags/Protobuf/"},{"name":"RPC","slug":"RPC","permalink":"https://pengfeidai.github.io/tags/RPC/"}]},{"title":"microå¾®æœåŠ¡","slug":"microå¾®æœåŠ¡","date":"2020-05-30T14:52:28.000Z","updated":"2020-05-31T13:33:52.000Z","comments":true,"path":"2020/05/30/microå¾®æœåŠ¡/","link":"","permalink":"https://pengfeidai.github.io/2020/05/30/microå¾®æœåŠ¡/","excerpt":"","text":"dockerå®‰è£…consul -serverï¼šä»¥æœåŠ¡ç«¯æ–¹å¼å¯åŠ¨ -bootstrapï¼šæŒ‡å®šè‡ªå·±ä¸ºleaderï¼Œä¸éœ€è¦é€‰ä¸¾ -uiï¼šå¯åŠ¨å†…ç½®ç®¡ç†webç•Œé¢ -clientï¼šæŒ‡å®šå®¢æˆ·ç«¯å¯ä»¥è®¿é—®çš„ipã€‚ 12345# å®‰è£…docker pull consul# å¯åŠ¨docker run -d --name=consul -p 8500:8500 consul agent -server -bootstrap -ui -client 0.0.0.0","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"Gin","slug":"Gin","permalink":"https://pengfeidai.github.io/tags/Gin/"},{"name":"micro","slug":"micro","permalink":"https://pengfeidai.github.io/tags/micro/"}]},{"title":"ä½¿ç”¨Golangæ„å»ºgRPCæœåŠ¡","slug":"ä½¿ç”¨Golangæ„å»ºgRPCæœåŠ¡","date":"2020-05-24T14:52:28.000Z","updated":"2020-05-31T13:34:21.000Z","comments":true,"path":"2020/05/24/ä½¿ç”¨Golangæ„å»ºgRPCæœåŠ¡/","link":"","permalink":"https://pengfeidai.github.io/2020/05/24/ä½¿ç”¨Golangæ„å»ºgRPCæœåŠ¡/","excerpt":"","text":"æœ¬æ•™ç¨‹æä¾›äº†Goä½¿ç”¨gRPCçš„åŸºç¡€æ•™ç¨‹ åœ¨æ•™ç¨‹ä¸­ä½ å°†ä¼šå­¦åˆ°å¦‚ä½•ï¼š åœ¨ .proto æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªæœåŠ¡ã€‚ ä½¿ç”¨protocol bufferç¼–è¯‘å™¨ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä»£ç ã€‚ ä½¿ç”¨gRPCçš„Go APIä¸ºä½ çš„æœåŠ¡å†™ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨gRPCå€ŸåŠ©gRPCï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ .proto æ–‡ä»¶ä¸­å®šä¹‰æˆ‘ä»¬çš„æœåŠ¡ï¼Œå¹¶ä»¥gRPCæ”¯æŒçš„ä»»ä½•è¯­è¨€æ¥å®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åˆå¯ä»¥åœ¨ä»æœåŠ¡å™¨åˆ°ä½ è‡ªå·±çš„å¹³æ¿ç”µè„‘çš„å„ç§ç¯å¢ƒä¸­è¿è¡Œ-gRPCè¿˜ä¼šä¸ºä½ è§£å†³æ‰€æœ‰ä¸åŒè¯­è¨€å’Œç¯å¢ƒä¹‹é—´é€šä¿¡çš„å¤æ‚æ€§ã€‚æˆ‘ä»¬è¿˜è·å¾—äº†ä½¿ç”¨protocol bufferçš„æ‰€æœ‰ä¼˜ç‚¹ï¼ŒåŒ…æ‹¬æœ‰æ•ˆçš„åºåˆ—åŒ–ï¼ˆé€Ÿåº¦å’Œä½“ç§¯ä¸¤æ–¹é¢éƒ½æ¯”JSONæ›´æœ‰æ•ˆç‡ï¼‰ï¼›ç®€å•çš„IDLï¼ˆæ¥å£å®šä¹‰è¯­è¨€ï¼‰å’Œè½»æ¾çš„æ¥å£æ›´æ–°ã€‚","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"gPRC","slug":"gPRC","permalink":"https://pengfeidai.github.io/tags/gPRC/"}]},{"title":"Golangä¸­etcdä½¿ç”¨æ•™ç¨‹","slug":"golangä¸­etcdä½¿ç”¨","date":"2020-05-13T14:52:28.000Z","updated":"2020-05-26T15:00:07.000Z","comments":true,"path":"2020/05/13/golangä¸­etcdä½¿ç”¨/","link":"","permalink":"https://pengfeidai.github.io/2020/05/13/golangä¸­etcdä½¿ç”¨/","excerpt":"","text":"å®‰è£…pakcgaeæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯v3ç‰ˆæœ¬çš„etcd clientï¼Œ é¦–å…ˆé€šè¿‡go getä¸‹è½½å¹¶ç¼–è¯‘å®‰è£…etcd clinet v3ã€‚ æ–‡æ¡£åœ°å€ï¼šhttps://godoc.org/github.com/coreos/etcd/clientv3 1go get github.com/coreos/etcd/clientv3 æ‰€æœ‰ç›¸å…³ä¾èµ–åŒ…ä¼šè‡ªåŠ¨ä¸‹è½½ç¼–è¯‘ï¼ŒåŒ…æ‹¬protobufã€grpcç­‰ã€‚è¿™é‡Œéœ€è¦æ³¨æ„éœ€è¦å°† go.mod ä¸­æ·»åŠ ä¸€è¡Œï¼Œä½¿ç”¨grpcçš„v1.26.0ç‰ˆæœ¬ï¼Œå¦åˆ™åé¢è¿æ¥ä¼šæŠ¥é”™ï¼šundefined: balancer.PickOptions 1replace google.golang.org/grpc =&gt; google.golang.org/grpc v1.26.0 è¿æ¥å®¢æˆ·ç«¯åˆ›å»ºå®¢æˆ·ç«¯ä½¿ç”¨ clientv3.Newï¼Œå®ƒéœ€è¦ä¼ å…¥ä¸€ä¸ªConfigé…ç½®ï¼Œè¿™é‡Œä¼ äº†2ä¸ªé€‰é¡¹ï¼š Endpointsï¼šetcdçš„å¤šä¸ªèŠ‚ç‚¹æœåŠ¡åœ°å€ã€‚ DialTimeoutï¼šåˆ›å»ºclientçš„é¦–æ¬¡è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œè¿™é‡Œä¼ äº†5ç§’ï¼Œå¦‚æœ5ç§’éƒ½æ²¡æœ‰è¿æ¥æˆåŠŸå°±ä¼šè¿”å›errï¼›ä¸€æ—¦clientåˆ›å»ºæˆåŠŸï¼Œæˆ‘ä»¬å°±ä¸ç”¨å†å…³å¿ƒåç»­åº•å±‚è¿æ¥çš„çŠ¶æ€äº†ï¼Œclientå†…éƒ¨ä¼šé‡è¿ã€‚ 12345678910111213141516171819202122232425262728293031323334package mainimport ( \"context\" \"fmt\" \"time\" \"github.com/coreos/etcd/clientv3\")var defaultTimeout = 5 * time.Secondvar Client *clientv3.Clientfunc Init() *clientv3.Client &#123; cli, err := clientv3.New(clientv3.Config&#123; Endpoints: []string&#123;\"localhost:2379\"&#125;, DialTimeout: defaultTimeout, &#125;) if err != nil &#123; fmt.Println(\"clientv3 Init error:\", err) panic(err) &#125; Client = cli fmt.Println(\"clientv3 Init success\") return cli&#125;func main() &#123; // \b\båˆå§‹åŒ– cli := Init() defer cli.Close()&#125; è¿”å›çš„ clientç±»å‹ä¸­ï¼Œå‡ ä¸ªetcdå®¢æˆ·ç«¯æ ¸å¿ƒåŠŸèƒ½æ¨¡å—å¦‚ä¸‹ï¼š Clusterï¼šå‘é›†ç¾¤é‡Œå¢åŠ etcdæœåŠ¡ç«¯èŠ‚ç‚¹ä¹‹ç±»ï¼Œå±äºç®¡ç†å‘˜æ“ä½œã€‚ KVï¼šæˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„åŠŸèƒ½ï¼Œå³K-Vé”®å€¼åº“çš„æ“ä½œã€‚ Leaseï¼šç§Ÿçº¦ç›¸å…³æ“ä½œï¼Œæ¯”å¦‚ç”³è¯·ä¸€ä¸ªTTL=10ç§’çš„ç§Ÿçº¦ï¼ˆåº”ç”¨ç»™keyå¯ä»¥å®ç°é”®å€¼çš„è‡ªåŠ¨è¿‡æœŸï¼‰ã€‚ Watcherï¼šè§‚å¯Ÿè®¢é˜…ï¼Œä»è€Œç›‘å¬æœ€æ–°çš„æ•°æ®å˜åŒ–ã€‚ Authï¼šç®¡ç†etcdçš„ç”¨æˆ·å’Œæƒé™ï¼Œå±äºç®¡ç†å‘˜æ“ä½œã€‚ Maintenanceï¼šç»´æŠ¤etcdï¼Œæ¯”å¦‚ä¸»åŠ¨è¿ç§»etcdçš„leaderèŠ‚ç‚¹ï¼Œå±äºç®¡ç†å‘˜æ“ä½œã€‚ Client.KV Client.KV æ˜¯æˆ‘ä»¬å¹³æ—¶ä¸»è¦ä½¿ç”¨çš„åŠŸèƒ½ï¼Œå®ƒæ˜¯ä¸€ä¸ª interfaceï¼Œæä¾›äº†æ‰€æœ‰å…³äºK-Væ“ä½œçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å‰é¢é€šè¿‡ etcdctl æ‰§è¡Œçš„ç›¸å…³å‘½ä»¤ï¼Œéƒ½å¯ä»¥åœ¨è¿™é‡Œæ¥æ“ä½œã€‚ æˆ‘ä»¬é€šè¿‡æ–¹æ³• clientv3.NewKV() æ¥è·å¾—KVæ¥å£çš„å®ç°ï¼ˆå®ç°ä¸­å†…ç½®äº†é”™è¯¯é‡è¯•æœºåˆ¶ï¼‰ï¼š 12345func main() &#123; ... kv := clientv3.NewKV(cli)&#125; æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†é€šè¿‡ kv æ“ä½œetcdä¸­çš„æ•°æ®ã€‚ Putetcd v3ä½¿ç”¨gRPCè¿›è¡Œè¿œç¨‹ç¨‹åºè°ƒç”¨ï¼Œå¹¶ä¸”clientv3ä½¿ç”¨ grpc-go è¿æ¥etcdã€‚ç¡®ä¿åœ¨ä½¿ç”¨å®Œå®¢æˆ·ç«¯åå…³é—­å®ƒï¼Œå¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰å…³é—­ï¼Œè¿æ¥å°†ä¼šæœ‰æ³„æ¼çš„goroutinesã€‚æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼Œé€šè¿‡ context.WithTimeout ä½¿ç”¨APIs: å‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š1Put(ctx context.Context, key, val string, opts ...OpOption) (*PutResponse, error) ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯goroutineçš„ä¸Šä¸‹æ–‡Contextã€‚åé¢ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯keyå’Œvalueï¼›å¦å¤–ï¼Œè¿˜æ”¯æŒä¸€ä¸ªå˜é•¿å‚æ•° ï¼Œå¯ä»¥ä¼ é€’ä¸€äº›æ§åˆ¶é¡¹æ¥å½±å“Putçš„è¡Œä¸ºï¼Œä¾‹å¦‚å¯ä»¥æºå¸¦ä¸€ä¸ªlease IDæ¥æ”¯æŒkeyè¿‡æœŸã€‚ ä¾‹ï¼š123456ctx, cancel := context.WithTimeout(context.Background(), defaultTimeout)putResp, err := kv.Put(ctx, \"/test\", \"Hello world\")cancel()fmt.Println(putResp)// &amp;&#123;cluster_id:14841639068965178418 member_id:10276657743932975437 revision:28 raft_term:5 &lt;nil&gt; &#123;&#125; [] 0&#125; æˆ‘ä»¬éœ€è¦åˆ¤æ–­erræ¥ç¡®å®šæ“ä½œæ˜¯å¦æˆåŠŸã€‚ ä¸åŒçš„KVæ“ä½œå¯¹åº”ä¸åŒçš„responseç»“æ„ï¼Œæ‰€æœ‰KVæ“ä½œè¿”å›çš„responseç»“æ„å¦‚ä¸‹ï¼š 1234567type ( CompactResponse pb.CompactionResponse PutResponse pb.PutResponse GetResponse pb.RangeResponse DeleteResponse pb.DeleteRangeResponse TxnResponse pb.TxnResponse) Getå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š123456789// Get retrieves keys.// By default, Get will return the value for \"key\", if any.// When passed WithRange(end), Get will return the keys in the range [key, end).// When passed WithFromKey(), Get returns keys greater than or equal to key.// When passed WithRev(rev) with rev &gt; 0, Get retrieves keys at the given revision;// if the required revision is compacted, the request will fail with ErrCompacted .// When passed WithLimit(limit), the number of returned keys is bounded by limit.// When passed WithSort(), the keys will be sorted.Get(ctx context.Context, key string, opts ...OpOption) (*GetResponse, error) æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€äº›æ§åˆ¶å‚æ•°æ¥å½±å“Getçš„è¡Œä¸ºï¼Œæ¯”å¦‚ï¼šWithFromKeyè¡¨ç¤ºè¯»å–ä»å‚æ•°keyå¼€å§‹é€’å¢çš„æ‰€æœ‰keyï¼Œè€Œä¸æ˜¯è¯»å–å•ä¸ªkeyã€‚ ä¾‹ï¼šä½¿ç”¨KVçš„Getæ–¹æ³•æ¥è¯»å–ç»™å®šé”®çš„å€¼ï¼š 123456resp, err := kv.Get(context.TODO(), \"/test\")for _, ev := range resp.Kvs &#123; fmt.Printf(\"%s : %s\\n\", ev.Key, ev.Value) // \"/test\": \"hello world\" &#125; ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ²¡æœ‰ä¼ é€’opOptionï¼Œæ‰€ä»¥å°±æ˜¯è·å– key=/test çš„æœ€æ–°ç‰ˆæœ¬æ•°æ®ã€‚ 12345678910type RangeResponse struct &#123; Header *ResponseHeader `protobuf:\"bytes,1,opt,name=header\" json:\"header,omitempty\"` // kvs is the list of key-value pairs matched by the range request. // kvs is empty when count is requested. Kvs []*mvccpb.KeyValue `protobuf:\"bytes,2,rep,name=kvs\" json:\"kvs,omitempty\"` // more indicates if there are more keys to return in the requested range. More bool `protobuf:\"varint,3,opt,name=more,proto3\" json:\"more,omitempty\"` // count is set to the number of keys within the range when requested. Count int64 `protobuf:\"varint,4,opt,name=count,proto3\" json:\"count,omitempty\"`&#125; Kvså­—æ®µï¼Œä¿å­˜äº†GetæŸ¥è¯¢åˆ°çš„æ‰€æœ‰k-vå¯¹ï¼Œå› ä¸ºä¸Šè¿°ä¾‹å­åªGetäº†ä¸€ä¸ªå•keyï¼Œæ‰€ä»¥åªéœ€è¦åˆ¤æ–­ä¸€ä¸‹ len(Kvs) æ˜¯å¦ç­‰äº1å³å¯çŸ¥é“keyæ˜¯å¦å­˜åœ¨ã€‚ RangeResponse.More å’Œ Countï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ withLimit() ç­‰é€‰é¡¹è¿›è¡ŒGetæ—¶ä¼šå‘æŒ¥ä½œç”¨ï¼Œç›¸å½“äºç¿»é¡µæŸ¥è¯¢ã€‚ WithPrefixå‰ç¼€åŒ¹é…1rangeResp, err := kv.Get(context.TODO(), &quot;/test/&quot;, clientv3.WithPrefix()) WithPrefix() æ˜¯æŒ‡æŸ¥æ‰¾ä»¥/test/ä¸ºå‰ç¼€çš„æ‰€æœ‰keyï¼Œå› æ­¤å¯ä»¥æ¨¡æ‹Ÿå‡ºæŸ¥æ‰¾å­ç›®å½•çš„æ•ˆæœã€‚ etcdæ˜¯ä¸€ä¸ªæœ‰åºçš„k-vå­˜å‚¨ï¼Œå› æ­¤ /test/ ä¸ºå‰ç¼€çš„keyæ€»æ˜¯é¡ºåºæ’åˆ—åœ¨ä¸€èµ·ã€‚ withPrefix()å®é™…ä¸Šä¼šè½¬åŒ–ä¸ºèŒƒå›´æŸ¥è¯¢ï¼Œå®ƒæ ¹æ®å‰ç¼€/test/ç”Ÿæˆäº†ä¸€ä¸ªå‰é—­åå¼€çš„ key rangeï¼š[â€œ/test/â€, â€œ/test0â€)ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ¯”/å¤§çš„å­—ç¬¦æ˜¯0ï¼Œæ‰€ä»¥ä»¥/test0ä½œä¸ºèŒƒå›´çš„æœ«å°¾ï¼Œå°±å¯ä»¥æ‰«æåˆ°æ‰€æœ‰ä»¥/test/ä¸ºå‰ç¼€çš„keyäº†ã€‚ Leaseetcdå®¢æˆ·ç«¯çš„Leaseå¯¹è±¡å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„ä»£ç è·å–åˆ° 1lease := clientv3.NewLease(cli) Leaseæä¾›äº†åŠŸèƒ½å¦‚ä¸‹ï¼š Grantï¼šåˆ†é…ä¸€ä¸ªç§Ÿçº¦ã€‚ Revokeï¼šé‡Šæ”¾ä¸€ä¸ªç§Ÿçº¦ã€‚ TimeToLiveï¼šè·å–å‰©ä½™TTLæ—¶é—´ã€‚ Leasesï¼šåˆ—ä¸¾æ‰€æœ‰etcdä¸­çš„ç§Ÿçº¦ã€‚ KeepAliveï¼šè‡ªåŠ¨å®šæ—¶çš„ç»­çº¦æŸä¸ªç§Ÿçº¦ã€‚ KeepAliveOnceï¼šä¸ºæŸä¸ªç§Ÿçº¦ç»­çº¦ä¸€æ¬¡ã€‚ Closeï¼šé‡Šæ”¾å½“å‰å®¢æˆ·ç«¯å»ºç«‹çš„æ‰€æœ‰ç§Ÿçº¦ã€‚ è¦æƒ³å®ç°keyè‡ªåŠ¨è¿‡æœŸï¼Œé¦–å…ˆå¾—åˆ›å»ºä¸€ä¸ªç§Ÿçº¦ï¼Œä¸‹é¢çš„ä»£ç åˆ›å»ºä¸€ä¸ªTTLä¸º60ç§’çš„ç§Ÿçº¦ï¼š 1grantResp, err := lease.Grant(context.TODO(), 10) è¿”å›çš„grantResponseçš„ç»“æ„ä½“ï¼š 1234567// LeaseGrantResponse wraps the protobuf message LeaseGrantResponse.type LeaseGrantResponse struct &#123; *pb.ResponseHeader ID LeaseID TTL int64 Error string&#125; æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸ªLeaseå¾€etcdä¸­å­˜å‚¨ä¸€ä¸ª60ç§’è¿‡æœŸçš„keyï¼š 1putResp, err := kv.Put(context.TODO(), \"/test/key1\", \"hello world\", clientv3.WithLease(grantResp.ID)) æ³¨æ„ï¼š å¦‚æœPutä¹‹å‰Leaseå·²ç»è¿‡æœŸäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªPutæ“ä½œä¼šè¿”å›errorï¼Œæ­¤æ—¶éœ€è¦é‡æ–°åˆ†é…Leaseã€‚ å®ç°æœåŠ¡æ³¨å†Œæ—¶ï¼Œéœ€è¦ä¸»åŠ¨ç»™Leaseè¿›è¡Œç»­çº¦ï¼Œé€šå¸¸æ˜¯ä»¥å°äºTTLçš„é—´éš”å¾ªç¯è°ƒç”¨Leaseçš„ KeepAliveOnce() æ–¹æ³•å¯¹ç§Ÿçº¦è¿›è¡Œç»­æœŸï¼Œä¸€æ—¦æŸä¸ªæœåŠ¡èŠ‚ç‚¹å‡ºé”™æ— æ³•å®Œæˆç§Ÿçº¦çš„ç»­æœŸï¼Œç­‰keyè¿‡æœŸåå®¢æˆ·ç«¯å³æ— æ³•åœ¨æŸ¥è¯¢æœåŠ¡æ—¶è·å¾—å¯¹åº”èŠ‚ç‚¹çš„æœåŠ¡ï¼Œè¿™æ ·å°±é€šè¿‡ç§Ÿçº¦åˆ°æœŸå®ç°äº†æœåŠ¡çš„é”™è¯¯éš”ç¦»ã€‚ 1keepResp, err := lease.KeepAliveOnce(context.TODO(), grantResp.ID) Txnäº‹åŠ¡etcdä¸­äº‹åŠ¡æ˜¯ åŸå­æ‰§è¡Œ çš„ï¼Œåªæ”¯æŒ if â€¦ then â€¦ else â€¦ è¿™ç§è¡¨è¾¾ã€‚é¦–å…ˆæ¥çœ‹ä¸€ä¸‹Txnä¸­å®šä¹‰çš„æ–¹æ³•ï¼š 1234567891011121314151617type Txn interface &#123; // If takes a list of comparison. If all comparisons passed in succeed, // the operations passed into Then() will be executed. Or the operations // passed into Else() will be executed. If(cs ...Cmp) Txn // Then takes a list of operations. The Ops list will be executed, if the // comparisons passed in If() succeed. Then(ops ...Op) Txn // Else takes a list of operations. The Ops list will be executed, if the // comparisons passed in If() fail. Else(ops ...Op) Txn // Commit tries to commit the transaction. Commit() (*TxnResponse, error)&#125; \bé€šè¿‡KVå¯¹è±¡å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼š1txn := kv.Txn(context.TODO()) ä¾‹ï¼šä¸‹é¢çš„æµ‹è¯•ç¨‹åºï¼Œåˆ¤æ–­å¦‚æœkeyçš„ç‰ˆæœ¬å·æ˜¯2ï¼Œåˆ™Put é”®å€¼k1å’Œk2ï¼Œå¦åˆ™Puté”®å€¼k3å’Œ4ã€‚ 1234567kv.Txn(context.TODO()).If( clientv3.Compare(clientv3.Version(key), \"=\", 2)).Then( clientv3.OpPut(k1,v1), clentv3.OpPut(k2,v2)).Else( clientv3.OpPut(k3,v3), clientv3.OpPut(k4,v4)).Commit() WatchWatchç”¨äº ç›‘å¬æŸä¸ªé”®çš„å˜åŒ–, Watchè°ƒç”¨åè¿”å›ä¸€ä¸ª WatchChanï¼Œå®ƒçš„ç±»å‹å£°æ˜å¦‚ä¸‹: 123456789101112type WatchChan &lt;-chan WatchResponsetype WatchResponse struct &#123; Header pb.ResponseHeader Events []*Event CompactRevision int64 Canceled bool Created bool&#125; å½“ç›‘å¬çš„keyæœ‰å˜åŒ–åä¼šå‘ WatchChan å‘é€ WatchResponseã€‚ åº”ç”¨åœºæ™¯ï¼šç³»ç»Ÿé…ç½®çš„çƒ­åŠ è½½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿè¯»å–åˆ°å­˜å‚¨åœ¨etcd keyä¸­çš„é…ç½®åï¼Œç”¨Watchç›‘å¬keyçš„å˜åŒ–ã€‚åœ¨å•ç‹¬çš„ goroutine ä¸­æ¥æ”¶WatchChanå‘é€è¿‡æ¥çš„æ•°æ®ï¼Œå¹¶å°†æ›´æ–°åº”ç”¨åˆ°ç³»ç»Ÿè®¾ç½®çš„é…ç½®å˜é‡ä¸­ï¼Œè¿™æ ·ç³»ç»Ÿå°±å®ç°äº†é…ç½®å˜é‡çš„çƒ­åŠ è½½ã€‚ 12345678910111213141516171819202122type Config struct &#123; config1 string config2 string&#125;var appConfig Appconfigfunc watchConfig(clt *clientv3.Client, key string, c interface&#123;&#125;) &#123; watchCh := clt.Watch(context.TODO(), key) go func() &#123; for res := range watchCh &#123; value := res.Events[0].Kv.Value if err := json.Unmarshal(value, c); err != nil &#123; fmt.Println(\"watchConfig err:\", err) continue &#125; fmt.Println(\"watchConfig\", c) &#125; &#125;()&#125;watchConfig(client, \"config_key\", &amp;Config)","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"etcd","slug":"etcd","permalink":"https://pengfeidai.github.io/tags/etcd/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://pengfeidai.github.io/tags/åˆ†å¸ƒå¼/"}]},{"title":"Galangå¸¸ç”¨åŒ…æ•´ç†","slug":"Galangå¸¸ç”¨åŒ…æ•´ç†","date":"2020-05-12T14:52:28.000Z","updated":"2020-06-03T14:20:05.000Z","comments":true,"path":"2020/05/12/Galangå¸¸ç”¨åŒ…æ•´ç†/","link":"","permalink":"https://pengfeidai.github.io/2020/05/12/Galangå¸¸ç”¨åŒ…æ•´ç†/","excerpt":"","text":"godocgodoc å¼€å‘æ¡†æ¶ gin beego æ•°æ®åº“ mysql momgo redis å¾®æœåŠ¡æ¡†æ¶ micro å·¥å…·ç±» protobuf logrus","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"}]},{"title":"etcdæŠ€æœ¯åŸç†æ¢ç©¶","slug":"etcdæŠ€æœ¯åŸç†æ¢ç©¶","date":"2020-05-12T14:52:28.000Z","updated":"2020-05-25T17:13:01.000Z","comments":true,"path":"2020/05/12/etcdæŠ€æœ¯åŸç†æ¢ç©¶/","link":"","permalink":"https://pengfeidai.github.io/2020/05/12/etcdæŠ€æœ¯åŸç†æ¢ç©¶/","excerpt":"","text":"etcdç®€ä»‹etcd æ˜¯ä¸€ä¸ªé«˜åº¦ä¸€è‡´çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œå®ƒæä¾›äº†ä¸€ç§å¯é çš„æ–¹å¼æ¥å­˜å‚¨éœ€è¦ç”±åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–æœºå™¨é›†ç¾¤è®¿é—®çš„æ•°æ®ã€‚åœ¨å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå®ƒå†…éƒ¨é‡‡ç”¨ raftåè®® ä½œä¸ºä¸€è‡´æ€§ç®—æ³•ï¼ŒåŸºäºGoè¯­è¨€å®ç°ã€‚å…¶ä¸»è¦åŠŸèƒ½æœ‰æœåŠ¡æ³¨å†Œä¸å‘ç°ã€æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…ã€è´Ÿè½½å‡è¡¡ã€åˆ†å¸ƒå¼é€šçŸ¥ä¸åè°ƒã€åˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼é˜Ÿåˆ—ã€é›†ç¾¤ç›‘æ§ä¸ leader é€‰ä¸¾ç­‰ã€‚ ä¸»è¦å…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š ç®€å•ï¼šå®‰è£…é…ç½®ç®€å•ï¼Œæ˜“äºéƒ¨ç½²ï¼Œæ˜“ä½¿ç”¨ã€‚åŸºäº HTTP çš„ API è®©ä½ ç”¨ curl å°±å¯ä»¥è½»æ¾ä½¿ç”¨ã€‚ å®‰å…¨ï¼šæ”¯æŒ SSL è¯ä¹¦éªŒè¯ã€‚ é”®å€¼å¯¹å­˜å‚¨ï¼šå°†æ•°æ®å­˜å‚¨åœ¨åˆ†å±‚ç»„ç»‡çš„ç›®å½•ä¸­ï¼Œå¦‚åŒåœ¨æ ‡å‡†æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ ç›‘æµ‹å˜æ›´ï¼šç›‘æµ‹ç‰¹å®šçš„é”®æˆ–ç›®å½•ä»¥è¿›è¡Œæ›´æ”¹ï¼Œå¹¶å¯¹å€¼çš„æ›´æ”¹åšå‡ºååº”ã€‚ å¿«é€Ÿï¼šæ ¹æ®å®˜æ–¹æä¾›çš„ benchmark æ•°æ®ï¼Œå•å®ä¾‹æ”¯æŒæ¯ç§’ 2k+ è¯»æ“ä½œã€‚ å¯é ï¼šé‡‡ç”¨raftç®—æ³•ï¼Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿæ•°æ®çš„å¯ç”¨æ€§å’Œä¸€è‡´æ€§ã€‚ å­˜å‚¨ç‰¹ç‚¹etcd æ˜¯ä¸€ä¸ª é”®å€¼å­˜å‚¨ çš„ç»„ä»¶ï¼Œå…¶ä»–çš„åº”ç”¨éƒ½æ˜¯åŸºäºå…¶é”®å€¼å­˜å‚¨çš„åŠŸèƒ½å±•å¼€ã€‚etcd çš„å­˜å‚¨æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š é‡‡ç”¨kvå‹æ•°æ®å­˜å‚¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¯”å…³ç³»å‹æ•°æ®åº“å¿«ã€‚ æ”¯æŒåŠ¨æ€å­˜å‚¨(å†…å­˜)ä»¥åŠé™æ€å­˜å‚¨(ç£ç›˜)ã€‚ åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå¯é›†æˆä¸ºå¤šèŠ‚ç‚¹é›†ç¾¤ã€‚ å­˜å‚¨æ–¹å¼ï¼Œé‡‡ç”¨ç±»ä¼¼ç›®å½•ç»“æ„ã€‚ åªæœ‰å¶å­èŠ‚ç‚¹æ‰èƒ½çœŸæ­£å­˜å‚¨æ•°æ®ï¼Œç›¸å½“äºæ–‡ä»¶ã€‚ å¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸€å®šæ˜¯ç›®å½•ï¼Œç›®å½•ä¸èƒ½å­˜å‚¨æ•°æ®ã€‚ etcdåº”ç”¨åœºæ™¯etcd çš„åœºæ™¯é»˜è®¤å¤„ç†çš„æ•°æ®éƒ½æ˜¯ç³»ç»Ÿä¸­çš„æ§åˆ¶æ•°æ®ã€‚æ‰€ä»¥etcdåœ¨ç³»ç»Ÿä¸­çš„è§’è‰²ä¸æ˜¯å…¶ä»–NoSQLäº§å“çš„æ›¿ä»£å“ï¼Œæ›´ä¸èƒ½ä½œä¸ºåº”ç”¨çš„ä¸»è¦æ•°æ®å­˜å‚¨ã€‚etcdä¸­åº”è¯¥ å°½é‡åªå­˜å‚¨ç³»ç»Ÿä¸­æœåŠ¡çš„é…ç½®ä¿¡æ¯ï¼Œå¯¹äºåº”ç”¨æ•°æ®åªæ¨èæŠŠæ•°æ®é‡å¾ˆå°ï¼Œä½†æ˜¯æ›´æ–°å’Œè®¿é—®é¢‘æ¬¡éƒ½å¾ˆé«˜çš„æ•°æ®å­˜å‚¨åœ¨etcdä¸­ã€‚ æœåŠ¡å‘ç°ï¼ˆService Discoveryï¼‰æœåŠ¡å‘ç°è¦è§£å†³çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€ï¼Œå³åœ¨åŒä¸€ä¸ªåˆ†å¸ƒå¼é›†ç¾¤ä¸­çš„è¿›ç¨‹æˆ–æœåŠ¡ï¼Œè¦å¦‚ä½•æ‰èƒ½æ‰¾åˆ°å¯¹æ–¹å¹¶å»ºç«‹è¿æ¥ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒæœåŠ¡å‘ç°å°±æ˜¯æƒ³è¦äº†è§£é›†ç¾¤ä¸­æ˜¯å¦æœ‰è¿›ç¨‹åœ¨ç›‘å¬ udp æˆ– tcp ç«¯å£ï¼Œå¹¶ä¸”é€šè¿‡åå­—å°±å¯ä»¥æŸ¥æ‰¾å’Œè¿æ¥ã€‚ è¦è§£å†³æœåŠ¡å‘ç°çš„é—®é¢˜ï¼Œéœ€è¦å…·å¤‡ä¸‹é¢ä¸‰ç§å¿…å¤‡å±æ€§ï¼š ä¸€ä¸ªå¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨çš„æœåŠ¡å­˜å‚¨ç›®å½•ã€‚ åŸºäºRalfç®—æ³•çš„etcdå¤©ç”Ÿå°±æ˜¯è¿™æ ·ä¸€ä¸ªå¼ºä¸€è‡´æ€§ã€é«˜å¯ç”¨çš„æœåŠ¡å­˜å‚¨ç›®å½•ã€‚ ä¸€ç§æ³¨å†ŒæœåŠ¡å’Œç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€çš„æœºåˆ¶ã€‚ ç”¨æˆ·å¯ä»¥åœ¨etcdä¸­æ³¨å†ŒæœåŠ¡ï¼Œå¹¶ä¸”å¯¹æ³¨å†Œçš„æœåŠ¡é…ç½® key TTLï¼Œå®šæ—¶ä¿æŒæœåŠ¡çš„å¿ƒè·³ä»¥è¾¾åˆ°ç›‘æ§å¥åº·çŠ¶æ€çš„æ•ˆæœã€‚ ä¸€ç§æŸ¥æ‰¾å’Œè¿æ¥æœåŠ¡çš„æœºåˆ¶ã€‚ é€šè¿‡åœ¨ etcd æŒ‡å®šçš„ä¸»é¢˜ï¼ˆç”±æœåŠ¡åç§°æ„æˆçš„æœåŠ¡ç›®å½•ï¼‰ä¸‹æ³¨å†Œçš„æœåŠ¡ä¹Ÿèƒ½åœ¨å¯¹åº”çš„ä¸»é¢˜ä¸‹æŸ¥æ‰¾åˆ°ã€‚ etcdæ¶æ„å›¾ images ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œetcd ä¸»è¦åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ã€‚ HTTP Serverï¼šç”¨äºå¤„ç†ç”¨æˆ·å‘é€çš„ API è¯·æ±‚ä»¥åŠå…¶å®ƒ etcd èŠ‚ç‚¹çš„åŒæ­¥ä¸å¿ƒè·³ä¿¡æ¯è¯·æ±‚ã€‚ Storeï¼šç”¨äºå¤„ç† etcd æ”¯æŒçš„å„ç±»åŠŸèƒ½çš„äº‹åŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®ç´¢å¼•ã€èŠ‚ç‚¹çŠ¶æ€å˜æ›´ã€ç›‘æ§ä¸åé¦ˆã€äº‹ä»¶å¤„ç†ä¸æ‰§è¡Œç­‰ç­‰ï¼Œæ˜¯ etcd å¯¹ç”¨æˆ·æä¾›çš„å¤§å¤šæ•° API åŠŸèƒ½çš„å…·ä½“å®ç°ã€‚ Raftï¼šRaft å¼ºä¸€è‡´æ€§ç®—æ³•çš„å…·ä½“å®ç°ï¼Œæ˜¯ etcd çš„æ ¸å¿ƒã€‚ WALï¼šWrite Ahead Logï¼ˆé¢„å†™å¼æ—¥å¿—ï¼‰ï¼Œæ˜¯ etcd çš„æ•°æ®å­˜å‚¨æ–¹å¼ã€‚é™¤äº†åœ¨å†…å­˜ä¸­å­˜æœ‰æ‰€æœ‰æ•°æ®çš„çŠ¶æ€ä»¥åŠèŠ‚ç‚¹çš„ç´¢å¼•ä»¥å¤–ï¼Œetcd å°±é€šè¿‡ WAL è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ã€‚WAL ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®æäº¤å‰éƒ½ä¼šäº‹å…ˆè®°å½•æ—¥å¿—ã€‚Snapshot æ˜¯ä¸ºäº†é˜²æ­¢æ•°æ®è¿‡å¤šè€Œè¿›è¡Œçš„çŠ¶æ€å¿«ç…§ï¼›Entry è¡¨ç¤ºå­˜å‚¨çš„å…·ä½“æ—¥å¿—å†…å®¹ã€‚ é€šå¸¸ï¼Œä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚å‘é€è¿‡æ¥ï¼Œä¼šç»ç”± HTTP Server è½¬å‘ç»™ Store è¿›è¡Œå…·ä½“çš„äº‹åŠ¡å¤„ç†ï¼Œå¦‚æœæ¶‰åŠåˆ°èŠ‚ç‚¹çš„ä¿®æ”¹ï¼Œåˆ™äº¤ç»™ Raft æ¨¡å—è¿›è¡ŒçŠ¶æ€çš„å˜æ›´ã€æ—¥å¿—çš„è®°å½•ï¼Œç„¶åå†åŒæ­¥ç»™åˆ«çš„ etcd èŠ‚ç‚¹ä»¥ç¡®è®¤æ•°æ®æäº¤ï¼Œæœ€åè¿›è¡Œæ•°æ®çš„æäº¤ï¼Œå†æ¬¡åŒæ­¥ã€‚ æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ€é€‚ç”¨çš„ä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼å°±æ˜¯æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…ã€‚å³æ„å»ºä¸€ä¸ª é…ç½®å…±äº«ä¸­å¿ƒï¼Œæ•°æ®æä¾›è€…åœ¨è¿™ä¸ªé…ç½®ä¸­å¿ƒå‘å¸ƒæ¶ˆæ¯ï¼Œè€Œæ¶ˆæ¯ä½¿ç”¨è€…åˆ™è®¢é˜…ä»–ä»¬å…³å¿ƒçš„ä¸»é¢˜ï¼Œä¸€æ—¦ä¸»é¢˜æœ‰æ¶ˆæ¯å‘å¸ƒï¼Œå°±ä¼šå®æ—¶é€šçŸ¥è®¢é˜…è€…ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥åšåˆ°åˆ†å¸ƒå¼ç³»ç»Ÿé…ç½®çš„é›†ä¸­å¼ç®¡ç†ä¸åŠ¨æ€æ›´æ–°ã€‚ images åº”ç”¨ä¸­ç”¨åˆ°çš„ä¸€äº› é…ç½®ä¿¡æ¯ æ”¾åˆ°etcdä¸Šè¿›è¡Œé›†ä¸­ç®¡ç†ã€‚ä½¿ç”¨æ–¹å¼ï¼šåº”ç”¨åœ¨å¯åŠ¨çš„æ—¶å€™ä¸»åŠ¨ä»etcdè·å–ä¸€æ¬¡é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶ï¼Œåœ¨etcdèŠ‚ç‚¹ä¸Šæ³¨å†Œä¸€ä¸ªWatcherå¹¶ç­‰å¾…ï¼Œä»¥åæ¯æ¬¡é…ç½®æœ‰æ›´æ–°çš„æ—¶å€™ï¼Œetcdéƒ½ä¼šå®æ—¶é€šçŸ¥è®¢é˜…è€…ï¼Œä»¥æ­¤è¾¾åˆ°è·å–æœ€æ–°é…ç½®ä¿¡æ¯çš„ç›®çš„ã€‚ åˆ†å¸ƒå¼æœç´¢æœåŠ¡ä¸­ï¼Œç´¢å¼•çš„å…ƒä¿¡æ¯å’ŒæœåŠ¡å™¨é›†ç¾¤æœºå™¨çš„èŠ‚ç‚¹çŠ¶æ€å­˜æ”¾åœ¨etcdä¸­ï¼Œä¾›å„ä¸ªå®¢æˆ·ç«¯è®¢é˜…ä½¿ç”¨ã€‚ä½¿ç”¨etcdçš„key TTLåŠŸèƒ½å¯ä»¥ç¡®ä¿æœºå™¨çŠ¶æ€æ˜¯å®æ—¶æ›´æ–°çš„ã€‚ åˆ†å¸ƒå¼æ—¥å¿—æ”¶é›†ç³»ç»Ÿï¼Œè¿™ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒå·¥ä½œæ˜¯æ”¶é›†åˆ†å¸ƒåœ¨ä¸åŒæœºå™¨çš„æ—¥å¿—ã€‚æ”¶é›†å™¨é€šå¸¸æ˜¯æŒ‰ç…§åº”ç”¨ï¼ˆæˆ–ä¸»é¢˜ï¼‰æ¥åˆ†é…æ”¶é›†ä»»åŠ¡å•å…ƒï¼Œå› æ­¤å¯ä»¥åœ¨etcdä¸Šåˆ›å»ºä¸€ä¸ªä»¥åº”ç”¨ï¼ˆä¸»é¢˜ï¼‰å‘½åçš„ç›®å½•Pï¼Œå¹¶å°†è¿™ä¸ªåº”ç”¨ï¼ˆä¸»é¢˜ç›¸å…³ï¼‰çš„æ‰€æœ‰æœºå™¨ipï¼Œä»¥å­ç›®å½•çš„å½¢å¼å­˜å‚¨åˆ°ç›®å½•Pä¸Šï¼Œç„¶åè®¾ç½®ä¸€ä¸ª etcd é€’å½’çš„Watcherï¼Œé€’å½’å¼çš„ç›‘æ§åº”ç”¨ï¼ˆä¸»é¢˜ï¼‰ç›®å½•ä¸‹æ‰€æœ‰ä¿¡æ¯çš„å˜åŠ¨ã€‚è¿™æ ·å°±å®ç°äº†æœºå™¨IPï¼ˆæ¶ˆæ¯ï¼‰å˜åŠ¨çš„æ—¶å€™ï¼Œèƒ½å¤Ÿå®æ—¶é€šçŸ¥åˆ°æ”¶é›†å™¨è°ƒæ•´ä»»åŠ¡åˆ†é…ã€‚ ç”¨æˆ·ä»é›†ç¾¤ä¸­å“ªä¸ªèŠ‚ç‚¹è¯»å†™æ•°æ®ï¼Ÿä¸ºäº†ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œetcdé›†ç¾¤ä¸­æ‰€æœ‰çš„æ•°æ®æµå‘éƒ½æ˜¯ä¸€ä¸ªæ–¹å‘ï¼Œä» Leader ï¼ˆä¸»èŠ‚ç‚¹ï¼‰æµå‘ Followerï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰ Follower çš„æ•°æ®å¿…é¡»ä¸ Leader ä¿æŒä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ä¼šè¢«è¦†ç›–ã€‚ ç®€å•ç‚¹è¯´å°±æ˜¯ï¼Œç”¨æˆ·å¯ä»¥å¯¹etcdé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹è¿›è¡Œè¯»å†™ï¼Œè¯»å–éå¸¸ç®€å•å› ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜çš„æ•°æ®æ˜¯å¼ºä¸€è‡´çš„ã€‚å¯¹äºå†™å…¥æ¥è¯´ï¼Œetcdé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºLeaderèŠ‚ç‚¹ï¼Œå¦‚æœå†™å…¥è¯·æ±‚æ¥è‡ªLeaderèŠ‚ç‚¹å³å¯ç›´æ¥å†™å…¥ç„¶åLeaderèŠ‚ç‚¹ä¼šæŠŠå†™å…¥åˆ†å‘ç»™æ‰€æœ‰Followerï¼Œå¦‚æœå†™å…¥è¯·æ±‚æ¥è‡ªå…¶ä»–FollowerèŠ‚ç‚¹é‚£ä¹ˆå†™å…¥è¯·æ±‚ä¼šç»™è½¬å‘ç»™LeaderèŠ‚ç‚¹ï¼Œç”±LeaderèŠ‚ç‚¹å†™å…¥ä¹‹åå†åˆ†å‘ç»™é›†ç¾¤ä¸Šçš„æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ã€‚ å¦‚ä½•é€‰ä¸¾LeaderèŠ‚ç‚¹å‡è®¾é›†ç¾¤ä¸­æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œé›†ç¾¤å¯åŠ¨ä¹‹åˆèŠ‚ç‚¹ä¸­å¹¶æ²¡æœ‰è¢«é€‰ä¸¾å‡ºçš„Leaderã€‚ Raftç®—æ³•ä½¿ç”¨ éšæœºTimer æ¥åˆå§‹åŒ–Leaderé€‰ä¸¾æµç¨‹ã€‚æ¯”å¦‚è¯´åœ¨ä¸Šé¢ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œäº†Timerï¼ˆæ¯ä¸ªTimerçš„æŒç»­æ—¶é—´æ˜¯éšæœºçš„ï¼‰ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹ç‡å…ˆå®Œæˆäº†Timerï¼Œéšåå®ƒå°±ä¼šå‘å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹å‘é€æˆä¸ºLeaderçš„è¯·æ±‚ï¼Œå…¶ä»–èŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚åä¼šä»¥ æŠ•ç¥¨å›åº” ç„¶åç¬¬ä¸€ä¸ªèŠ‚ç‚¹è¢«é€‰ä¸¾ä¸ºLeaderã€‚ æˆä¸ºLeaderåï¼Œè¯¥èŠ‚ç‚¹ä¼š ä»¥å›ºå®šæ—¶é—´é—´éš”å‘å…¶ä»–èŠ‚ç‚¹å‘é€é€šçŸ¥ï¼Œç¡®ä¿è‡ªå·±ä»æ˜¯Leaderã€‚ æœ‰äº›æƒ…å†µä¸‹å½“Followerä»¬æ”¶ä¸åˆ°Leaderçš„é€šçŸ¥åï¼Œæ¯”å¦‚è¯´LeaderèŠ‚ç‚¹å®•æœºæˆ–è€…å¤±å»äº†è¿æ¥ï¼Œå…¶ä»–èŠ‚ç‚¹ä¼šé‡å¤ä¹‹å‰é€‰ä¸¾è¿‡ç¨‹é€‰ä¸¾å‡ºæ–°çš„Leaderã€‚ åˆ¤æ–­å†™å…¥æ˜¯å¦æˆåŠŸetcdè®¤ä¸ºå†™å…¥è¯·æ±‚è¢«LeaderèŠ‚ç‚¹å¤„ç†å¹¶åˆ†å‘ç»™äº† å¤šæ•°èŠ‚ç‚¹ åï¼Œå°±æ˜¯ä¸€ä¸ªæˆåŠŸçš„å†™å…¥ã€‚å¦‚ä½•ç•Œå®šå¤šæ•°èŠ‚ç‚¹å‘¢ï¼Ÿå‡è®¾æ€»ç»“ç‚¹æ•°æ˜¯Nï¼Œé‚£ä¹ˆç•Œå®šå¤šæ•°èŠ‚ç‚¹çš„å…¬å¼æ˜¯ Quorum=N/2+1ã€‚ å®¹é”™èŠ‚ç‚¹æ•°ï¼šé›†ç¾¤ä¸­èŠ‚ç‚¹æ€»æ•°(Instances)å¯¹åº”çš„Quorumæ•°é‡ï¼Œç”¨Instanceså‡å»Quoromå°±æ˜¯é›†ç¾¤ä¸­å®¹é”™èŠ‚ç‚¹ï¼ˆå…è®¸å‡ºæ•…éšœçš„èŠ‚ç‚¹ï¼‰çš„æ•°é‡ã€‚ æ‰€ä»¥åœ¨é›†ç¾¤ä¸­æ¨èçš„æœ€å°‘èŠ‚ç‚¹æ•°é‡æ˜¯3ä¸ªï¼Œå› ä¸º1å’Œ2ä¸ªèŠ‚ç‚¹çš„å®¹é”™èŠ‚ç‚¹æ•°éƒ½æ˜¯0ï¼Œä¸€æ—¦æœ‰ä¸€ä¸ªèŠ‚ç‚¹å®•æ‰æ•´ä¸ªé›†ç¾¤å°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚ 123456789Instances Quorum Fault Toleran1 1/2+1=1 1-1=02 2/2+1=2 2-2=03 3/2+1=2 3-2=14 3 15 3 26 4 27 4 3 å¦‚ä¸Šæ‰€ç¤ºï¼šå½“å†³å®šé›†ç¾¤ä¸­èŠ‚ç‚¹çš„æ•°é‡æ—¶ï¼Œå¼ºçƒˆæ¨èå¥‡æ•°æ•°é‡çš„èŠ‚ç‚¹ã€‚ ä¾‹å¦‚ï¼š6ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤å®ƒçš„å®¹é”™èƒ½åŠ›å¹¶æ²¡æœ‰æ¯”5ä¸ªèŠ‚ç‚¹çš„å¥½ï¼Œä»–ä»¬çš„å®¹é”™èŠ‚ç‚¹æ•°ä¸€æ ·ï¼Œä¸€æ—¦å®¹é”™èŠ‚ç‚¹è¶…è¿‡2åï¼Œç”±äºQuorumèŠ‚ç‚¹æ•°å°äº4æ•´ä¸ªé›†ç¾¤ä¹Ÿå˜ä¸ºä¸å¯ç”¨çš„çŠ¶æ€äº†ã€‚","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"etcd","slug":"etcd","permalink":"https://pengfeidai.github.io/tags/etcd/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://pengfeidai.github.io/tags/åˆ†å¸ƒå¼/"}]},{"title":"åˆè¯†etcd","slug":"åˆè¯† etcd","date":"2020-05-10T14:52:28.000Z","updated":"2020-05-25T17:07:41.000Z","comments":true,"path":"2020/05/10/åˆè¯† etcd/","link":"","permalink":"https://pengfeidai.github.io/2020/05/10/åˆè¯† etcd/","excerpt":"","text":"ç®€ä»‹etcd æ˜¯ä¸€ä¸ª golang ç¼–å†™çš„åˆ†å¸ƒå¼ã€é«˜å¯ç”¨çš„ä¸€è‡´æ€§é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºæä¾›å¯é çš„åˆ†å¸ƒå¼é”®å€¼(key-value)å­˜å‚¨ã€é…ç½®å…±äº«å’ŒæœåŠ¡å‘ç°ç­‰åŠŸèƒ½ã€‚etcdå¯ä»¥ç”¨äºå­˜å‚¨å…³é”®æ•°æ®å’Œå®ç°åˆ†å¸ƒå¼è°ƒåº¦ï¼Œåœ¨ç°ä»£åŒ–çš„é›†ç¾¤è¿è¡Œä¸­èƒ½å¤Ÿèµ·åˆ°å…³é”®æ€§çš„ä½œç”¨ã€‚ etcdåŸºäº raftåè®®ï¼Œé€šè¿‡å¤åˆ¶æ—¥å¿—æ–‡ä»¶çš„æ–¹å¼æ¥ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚åœ¨etcdä¹‹å‰ï¼Œå¸¸ç”¨çš„æ˜¯åŸºäºpaxosåè®®çš„zookeeperã€‚ å•æœºå®‰è£…etcdetcdåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬æ¨èé›†ç¾¤æ–¹å¼éƒ¨ç½²ã€‚åœ¨è¿™é‡Œï¼Œä¸»è¦è®²è®²å•èŠ‚ç‚¹å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨ã€‚ CentOS 1yum install -y etcd å¯åŠ¨1234567891011121314151617181920212223242526# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨$ systemctl enable etcd# å¯åŠ¨etcd$ systemctl start etcd# æŸ¥çœ‹etcdè¿è¡ŒçŠ¶æ€$ systemctl status etcdâ— etcd.service - Etcd Server Loaded: loaded (/usr/lib/systemd/system/etcd.service; disabled; vendor preset: disabled) Active: active (running) since Sun 2020-05-24 23:08:57 CST; 7s ago Main PID: 20272 (etcd) Tasks: 8 Memory: 10.0M CGroup: /system.slice/etcd.service â””â”€20272 /usr/bin/etcd --name=default --data-dir=/var/lib/etcd/default.etcd --listen-client-urls=http://localhost:2379May 24 23:08:57 VM_0_3_centos etcd[20272]: 8e9e05c52164694d received MsgVoteResp from 8e9e05c52164694d at term 2May 24 23:08:57 VM_0_3_centos etcd[20272]: 8e9e05c52164694d became leader at term 2May 24 23:08:57 VM_0_3_centos etcd[20272]: raft.node: 8e9e05c52164694d elected leader 8e9e05c52164694d at term 2May 24 23:08:57 VM_0_3_centos etcd[20272]: setting up the initial cluster version to 3.3May 24 23:08:57 VM_0_3_centos etcd[20272]: published &#123;Name:default ClientURLs:[http://localhost:2379]&#125; to cluster cdf818194e3a8c32May 24 23:08:57 VM_0_3_centos etcd[20272]: ready to serve client requestsMay 24 23:08:57 VM_0_3_centos etcd[20272]: serving insecure client requests on 127.0.0.1:2379, this is strongly discouraged!May 24 23:08:57 VM_0_3_centos systemd[1]: Started Etcd Server.May 24 23:08:57 VM_0_3_centos etcd[20272]: set the initial cluster version to 3.3May 24 23:08:57 VM_0_3_centos etcd[20272]: enabled capabilities for version 3.3 systemdé…ç½®ä» systemctl status etcd å‘½ä»¤çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œetcdçš„ systemdé…ç½®æ–‡ä»¶ä½äº /usr/lib/systemd/system/etcd.serviceï¼Œè¯¥é…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718[Unit]Description=Etcd ServerAfter=network.targetAfter=network-online.targetWants=network-online.target[Service]Type=notifyWorkingDirectory=/var/lib/etcd/EnvironmentFile=-/etc/etcd/etcd.confUser=etcd# set GOMAXPROCS to number of processorsExecStart=/bin/bash -c \"GOMAXPROCS=$(nproc) /usr/bin/etcd --name=\\\"$&#123;ETCD_NAME&#125;\\\" --data-dir=\\\"$&#123;ETCD_DATA_DIR&#125;\\\" --listen-client-urls=\\\"$&#123;ETCD_LISTEN_CLIENT_URLS&#125;\\\"\"Restart=on-failureLimitNOFILE=65536[Install]WantedBy=multi-user.target ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œetcdçš„é…ç½®æ–‡ä»¶ï¼š EnvironmentFile=-/etc/etcd/etcd.confã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹æŸäº›é…ç½®é¡¹ï¼Œå¯ä»¥ç¼–è¾‘è¯¥æ–‡ä»¶ã€‚ è¿œç¨‹è®¿é—®etcdå®‰è£…å®Œæˆåï¼Œé»˜è®¤åªèƒ½æœ¬æœºè®¿é—®ï¼Œå¦‚æœæƒ³è¦å…¶ä»–ä¸»æœºè®¿é—®ï¼Œè¿˜éœ€è¦ä¿®æ”¹ /etc/etcd/etcd.conf ä¸­çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæœ¬å®ä¾‹å®‰è£…etcdçš„æœºå™¨IPæ˜¯ 127.0.0.1ï¼ˆä¸‹é¢æœåŠ¡å™¨ipç”¨127.0.0.1æ›¿ä»£ï¼Œè‡ªå·±æ ¹æ®å®é™…æ›´æ”¹ï¼‰ï¼Œåœ¨è‡ªå·±çš„æœºå™¨è¿œç¨‹è®¿é—®æœåŠ¡å™¨ä¸Šå®‰è£…çš„etcdçš„2379ç«¯å£ï¼Œç»“æœè®¿é—®è¢«æ‹’ç»ï¼š 1234$ telnet 127.0.0.1 2379Trying 127.0.0.1...telnet: connect to address 127.0.0.1: Connection refusedtelnet: Unable to connect to remote host ä¿®æ”¹ /etc/etcd/etcd.conf é…ç½®ï¼š æ³¨æ„ï¼šæ­¤å¤„ 127.0.0.1 ä½¿ç”¨å†…ç½‘ip 1ETCD_LISTEN_CLIENT_URLS=\"http://127.0.0.1:2379,http://localhost:2379\" é‡å¯etcd1$ systemctl restart etcd etcdctl å¸¸ç”¨å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬1234etcdctl -vetcdctl version: 3.3.11API version: 2 å¯ä»¥çœ‹åˆ°é»˜è®¤ API version: 2ï¼Œç”±äºetcdctlçš„ç‰ˆæœ¬2å’Œç‰ˆæœ¬3å¹¶ä¸å…¼å®¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è®¾ç½®ã€‚ 123456# è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç‰ˆæœ¬3ã€‚export ETCDCTL_API=3etcdctl versionetcdctl version: 3.3.11API version: 3.3 COMMANDS1234567891011121314151617181920212223242526272829303132333435363738394041424344454647get Gets the key or a range of keysput Puts the given key into the storedel Removes the specified key or range ofkeys [key, range_end)txn Txn processes all the requests in onetransactioncompaction Compacts the event history in etcdalarm disarm Disarms all alarmsalarm list Lists all alarmsdefrag Defragments the storage of the etcdmembers with given endpointsendpoint health Checks the healthiness ofendpoints specified in `--endpoints` flagendpoint status Prints out the status ofendpoints specified in `--endpoints` flagendpoint hashkv Prints the KV history hash foreach endpoint in --endpointsmove-leader Transfers leadership to another etcdcluster member.watch Watches events stream on keys orprefixesversion Prints the version of etcdctllease grant Creates leaseslease revoke Revokes leaseslease timetolive Get lease informationlease list List all active leaseslease keep-alive Keeps leases alive (renew)member add Adds a member into the clustermember remove Removes a member from the clustermember update Updates a member in the clustermember list Lists all members in the clustersnapshot save Stores an etcd node backendsnapshot to a given filesnapshot restore Restores an etcd member snapshotto an etcd directorysnapshot status Gets backend snapshot statusof a given filemake-mirror Makes a mirror at the destinationetcd clustermigrate Migrates keys in a v2 store to amvcc storelock Acquires a named lockelect Observes and participates in leaderelectionauth enable Enables authenticationauth disable Disables authenticationuser add Adds a new useruser delete Deletes a useruser get Gets detailed information of a useruser list Lists all usersuser passwd Changes password of useruser grant-role Grants a role to a useruser revoke-role Revokes a role from a userrole add Adds a new rolerole delete Deletes a rolerole get Gets detailed information of a rolerole list Lists all rolesrole grant-permission Grants a key to a rolerole revoke-permission Revokes a key from a rolecheck perf Check the performance of the etcdclusterhelp Help about any command æŸ¥çœ‹é›†ç¾¤çŠ¶æ€å’ŒèŠ‚ç‚¹1etcdctl member list æ’å…¥æ•°æ®å¯ä»¥æŠŠkeyç†è§£æˆç›®å½• 12345678etcdctl put /hello/key1 \"world1\"OKetcdctl put /hello/key2 \"world2\"OKetcdctl put /hello/key3 \"world3\"OK æ ¹æ®keyæŸ¥è¯¢1234etcdctl get /hello/key1/hello/key1world1 åˆ é™¤ä¸€æ¡æ•°æ®123etcdctl del /hello/key31 æ‰¹é‡è·å–ç›®å½•ä¸‹çš„å†…å®¹12345678910111213141516171819# è·å–key valueetcdctl get /hello/ --prefix# è¿”å›å€¼/hello/key1world1/hello/key2world2#åªè·å–keyetcdctl get /hello/ --prefix --keys-only# è¿”å›å€¼/hello/key1/hello/key2# åªè·å–valueetcdctl get /hello/ --prefix --print-value-only# è¿”å›å€¼world1world2 watchç›‘å¬key1etcdctl watch /hello/key1 ç§Ÿçº¦ï¼ˆå¯ä»¥ç†è§£æˆå®šæ—¶å™¨ï¼ŒæŠŠkeyç»‘å®šä¸Šä¹‹åï¼Œåˆ°æ—¶é—´äº†keyå°±è¢«åˆ é™¤äº†ï¼‰123456789101112131415etcdctl lease grant 60# è¿”å›å€¼lease 694d72477c721546 granted with TTL(60s)# åˆ›å»ºä¸€æ¡æ•°æ®å¹¶ç»‘å®šåˆ°ä¸Šé¢ç§Ÿçº¦ä¸Šetcdctl put --lease=694d72477c721546 /hello/key3 \"world3\"# é©¬ä¸Šè·å–æ•°æ®etcdctl get /hello/key3 # å¯ä»¥åˆ é™¤ç§Ÿçº¦ï¼ˆå¯¹åº”çš„keyä¹Ÿä¼šè¢«ç›´æ¥åˆ é™¤ï¼‰etcdctl lease revoke 694d72477c721546# ç»­ç§Ÿï¼ˆ60sï¼‰etcdctl lease keep-alive 694d72477c721546 snapshotä¿å­˜å¤‡ä»½å½“å‰é›†ç¾¤etcdçš„ä¿¡æ¯ï¼Œç”¨äºæ–°çš„etcdé›†ç¾¤ 12345etcdctl snapshot save snapshot.db# è¿”å›Snapshot saved at snapshot.dblssnapshot.db è®¿é—®æ§åˆ¶ç›¸å…³æ·»åŠ ç”¨æˆ·12345# rootç”¨æˆ·etcdctl user add root# érootç”¨æˆ·etcdctl user add mochu æ·»åŠ role1etcdctl role add admin å°†ç”¨æˆ·åŠ å…¥è§’è‰²ä¸­1etcdctl user grant-role mochu admin æœ¬æ–‡åªä»‹ç»ç®€å•çš„æŒ‡ä»¤ï¼Œä»…ä¾›å­¦ä¹ ä½¿ç”¨ï¼Œæ›´å¤šè¯¦ç»†å‘½ä»¤ï¼Œè¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚","categories":[],"tags":[{"name":"Golang","slug":"Golang","permalink":"https://pengfeidai.github.io/tags/Golang/"},{"name":"etcd","slug":"etcd","permalink":"https://pengfeidai.github.io/tags/etcd/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://pengfeidai.github.io/tags/åˆ†å¸ƒå¼/"}]},{"title":"æ–°æœºå™¨nginxå®‰è£…æœºå™¨ä½¿ç”¨","slug":"æ–°æœºå™¨nginxå®‰è£…åŠå…¶ä½¿ç”¨","date":"2020-05-05T14:52:28.000Z","updated":"2020-05-25T17:07:29.000Z","comments":true,"path":"2020/05/05/æ–°æœºå™¨nginxå®‰è£…åŠå…¶ä½¿ç”¨/","link":"","permalink":"https://pengfeidai.github.io/2020/05/05/æ–°æœºå™¨nginxå®‰è£…åŠå…¶ä½¿ç”¨/","excerpt":"","text":"1. å®‰è£…ä¾èµ–1234567891011#gccå®‰è£…ï¼Œnginxæºç ç¼–è¯‘éœ€è¦yum install gcc-c++#PCRE pcre-devel å®‰è£…ï¼Œnginx çš„ http æ¨¡å—ä½¿ç”¨ pcre æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼yum install -y pcre pcre-devel#zlibå®‰è£…ï¼Œnginx ä½¿ç”¨zlibå¯¹httpåŒ…çš„å†…å®¹è¿›è¡Œgzipyum install -y zlib zlib-devel#OpenSSL å®‰è£…ï¼Œå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œnginx ä¸ä»…æ”¯æŒ http åè®®ï¼Œè¿˜æ”¯æŒ httpsï¼ˆå³åœ¨sslåè®®ä¸Šä¼ è¾“httpï¼‰yum install -y openssl openssl-devel 2. ä½¿ç”¨wgetå‘½ä»¤ä¸‹è½½ï¼ˆæ¨èï¼‰12# ç‰ˆæœ¬è‡ªè¡Œé€‰æ‹©ç¨³å®šç‰ˆå³å¯wget -c https://nginx.org/download/nginx-1.16.1.tar.gz 3. å®‰è£…123456789101112131415161718192021222324252627282930313233# è§£å‹åˆ°æŒ‡å®šç›®å½•tar -zxvf nginx-1.16.1.tar.gz -C /opt/bin# è¿›å…¥ç›®å½•cd /opt/bin/nginx-1.16.1#ä½¿ç”¨é»˜è®¤é…ç½®./configure#ç¼–è¯‘å®‰è£…makemake install# æŸ¥æ‰¾å®‰è£…è·¯å¾„ï¼Œé»˜è®¤éƒ½æ˜¯è¿™ä¸ªè·¯å¾„[root@VM_0_3_centos nginx-1.16.1]# whereis nginxnginx: /usr/local/nginx# å¯åŠ¨ã€åœæ­¢nginxcd /usr/local/nginx/sbin/./nginx #å¯åŠ¨./nginx -s stop #åœæ­¢ï¼Œç›´æ¥æŸ¥æ‰¾nginxè¿›ç¨‹idå†ä½¿ç”¨killå‘½ä»¤å¼ºåˆ¶æ€æ‰è¿›ç¨‹./nginx -s quit #é€€å‡ºåœæ­¢ï¼Œç­‰å¾…nginxè¿›ç¨‹å¤„ç†å®Œä»»åŠ¡å†è¿›è¡Œåœæ­¢./nginx -s reload #é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹nginx.confåä½¿ç”¨è¯¥å‘½ä»¤ï¼Œæ–°é…ç½®å³å¯ç”Ÿæ•ˆ#é‡å¯nginxï¼Œå»ºè®®å…ˆåœæ­¢ï¼Œå†å¯åŠ¨./nginx -s stop./nginx#æŸ¥çœ‹nginxè¿›ç¨‹[root@VM_0_12_centos ~]# ps aux|grep nginxroot 21888 0.0 0.0 20556 616 ? Ss 21:24 0:00 nginx: master process ./nginxnobody 21889 0.0 0.0 23092 1636 ? S 21:24 0:00 nginx: worker processroot 25687 0.0 0.0 112712 960 pts/0 R+ 21:52 0:00 grep --color=auto nginx 4. è®¾ç½®å¼€æœºè‡ªå¯åŠ¨123456789# ç¬¬ä¸€æ­¥vi /etc/rc.local# å¢åŠ ä¸€è¡Œ/usr/local/nginx/sbin/nginx#è®¾ç½®æ‰§è¡Œæƒé™cd /etcchmod 755 rc.local æ­¤æ—¶æµè§ˆå™¨è¾“å…¥æœåŠ¡å™¨ipå³å¯è®¿é—® nginx é¡µé¢ã€‚ 5. é…ç½®åŸŸåæ˜ å°„nginx é…ç½®æ–‡ä»¶éƒ½åœ¨ /usr/local/nginx/conf/ ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åç§°æ˜¯ nginx.confã€‚ 12345# è¿›å…¥nginxé…ç½®æ–‡ä»¶ç›®å½•cd /usr/local/nginx/conf# ä¿®æ”¹é…ç½®æ–‡ä»¶vi nginx.conf åŸŸåé…ç½®ï¼š åªéœ€è¦ä¿®æ”¹ server_name å’Œ location é‡Œé¢çš„å†…å®¹å³å¯ã€‚ 1234567listen 80;# åŸŸåserver_name www.example.com;# è®¿é—®åœ°å€çš„è®¾ç½®location / &#123;proxy_pass http://localhost:9000; &#125; ä¿®æ”¹å®Œæˆåï¼Œé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼š 12cd /usr/local/nginx/sbin/./nginx -s reload 6. é™æ€èµ„æºè®¿é—®ï¼ˆå›¾ç‰‡ä¸ºä¾‹ï¼‰ åˆ›å»ºä¸€ä¸ªå­˜å‚¨imagesçš„ç›®å½• 1mkdir -p /opt/nginx/www/images ç¼–è¾‘é…ç½® 1234567891011121314# ä¿®æ”¹ç”¨æˆ·æƒé™user root;...server &#123; listen 8000; server_name localhost; location ~ .*\\.(gif|jpg|jpeg|png)$ &#123; root /opt/nginx/www/images/; autoindex on; # æ‰“å¼€æµè§ˆåŠŸèƒ½ &#125;&#125; é‡å¯nginxæœåŠ¡ 1systemctl restart nginx æˆ– nginx -s reload åœ¨æµè§ˆå™¨è®¿é—®æµ‹è¯•","categories":[],"tags":[{"name":"nginx","slug":"nginx","permalink":"https://pengfeidai.github.io/tags/nginx/"}]},{"title":"javascriptæ•°ç»„æ–¹æ³•æ€»ç»“","slug":"array","date":"2017-09-20T14:02:52.000Z","updated":"2017-09-30T15:18:30.000Z","comments":true,"path":"2017/09/20/array/","link":"","permalink":"https://pengfeidai.github.io/2017/09/20/array/","excerpt":"","text":"æ•°ç»„åˆ›å»ºç¬¬ä¸€ç§ï¼Œä½¿ç”¨ Array æ„é€ å‡½æ•°ï¼š123var arr1 = new Array(); //åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„var arr2 = new Array(10); // åˆ›å»ºä¸€ä¸ªåŒ…å«10é¡¹çš„æ•°ç»„var arr3 = new Array(\"a\", \"b\",\"c\"); // åˆ›å»ºä¸€ä¸ªåŒ…å«3ä¸ªå­—ç¬¦ä¸²çš„æ•°ç»„ ç¬¬äºŒç§ï¼Œä½¿ç”¨æ•°ç»„å­—é¢é‡è¡¨ç¤ºæ³•ï¼š12var arr1 = []; //åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„var arr2 = [\"a\", \"b\", \"c\"]; // åˆ›å»ºä¸€ä¸ªåŒ…å«3ä¸ªå­—ç¬¦ä¸²çš„æ•°ç»„ åœ¨è¯»å–å’Œè®¾ç½®æ•°ç»„çš„å€¼æ—¶ï¼Œè¦ä½¿ç”¨æ–¹æ‹¬å·å¹¶æä¾›ç›¸åº”å€¼çš„åŸºäº 0 çš„æ•°å­—ç´¢å¼•ï¼š1234var arr = [\"a\", \"b\", \"c\"];console.log(arr[0]); // aarr[2] = \"d\"; // å°†ä¸‹æ ‡ä¸º2çš„ c ä¿®æ”¹ä¸º darr[3] = \"e\"; // å¢åŠ ç¬¬å››é¡¹ä¸ºe JavaScriptä¸­æ•°ç»„çš„lengthå±æ€§æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œçœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼š123var arr = [\"a\", \"b\", \"c\"];arr[arr.length] = \"d\"; // åœ¨æ•°ç»„å°¾éƒ¨æ·»åŠ ä¸€é¡¹\"d\"arr.length = arr.length-1; //å°†æœ€åä¸€é¡¹åˆ é™¤ å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯ä¸æ˜¯æ•°ç»„å¯¹è±¡1234567var arr = [];// ES5ä¹‹å‰arr instanceof Array;// ES5æ–°å¢arr.isArray();typeof arr; // object æ•°ç»„æ–¹æ³•join()join()ï¼šå°†æ•°ç»„çš„å…ƒç´ ç»„èµ·ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥separatorä¸ºåˆ†éš”ç¬¦ï¼Œçœç•¥çš„è¯åˆ™ç”¨é»˜è®¤ç”¨é€—å·ä¸ºåˆ†éš”ç¬¦ï¼Œè¯¥æ–¹æ³•åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šå³åˆ†éš”ç¬¦ã€‚1234var arr = [\"a\", \"b\", \"c\"];console.log(arr.join()); // a, b, cconsole.log(arr.join(\"-\")); // a-b-cconsole.log(arr); // [a, b, c]ï¼ˆåŸæ•°ç»„ä¸å˜ï¼‰ åº”ç”¨ï¼šé€šè¿‡join()æ–¹æ³•å¯ä»¥å®ç°é‡å¤å­—ç¬¦ä¸²ã€‚1234function repeatString(str, n) &#123;return new Array(n + 1).join(str);&#125;console.log(repeatString(\"a\", 3)); // aaa push()å’Œpop()push()ï¼šå¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„å‚æ•°ï¼ŒæŠŠå®ƒä»¬é€ä¸ªæ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¹¶è¿”å›ä¿®æ”¹åæ•°ç»„çš„é•¿åº¦ã€‚pop()ï¼šæ•°ç»„æœ«å°¾ç§»é™¤æœ€åä¸€é¡¹ï¼Œå‡å°‘æ•°ç»„çš„ length å€¼ï¼Œç„¶åè¿”å›ç§»é™¤çš„é¡¹ã€‚1234567var arr = [\"a\", \"b\", \"c\"];var count = arr.push(\"d\", \"e\");console.log(count); // 5console.log(arr); // [\"a\", \"b\", \"c\", \"d\", \"e\"]var item = arr.pop();console.log(item); // econsole.log(arr); // [\"a\", \"b\", \"c\", \"d\"] shift() å’Œ unshift()shift()ï¼šåˆ é™¤åŸæ•°ç»„ç¬¬ä¸€é¡¹ï¼Œå¹¶è¿”å›åˆ é™¤å…ƒç´ çš„å€¼ï¼›å¦‚æœæ•°ç»„ä¸ºç©ºåˆ™è¿”å›undefined ã€‚unshift()ï¼šå°†å‚æ•°æ·»åŠ åˆ°åŸæ•°ç»„å¼€å¤´ï¼Œå¹¶è¿”å›æ•°ç»„çš„é•¿åº¦ ã€‚1234567var arr = [\"c\", \"d\", \"e\"];var count = arr.unshift(\"a\",\"b\");console.log(count); // 5console.log(arr); // [\"a\", \"b\", \"c\", \"d\", \"e\"]var item = arr.shift();console.log(item); // aconsole.log(arr); // [\"b\", \"c\", \"d\", \"e\"] sort()ï¼ˆåŸæ•°ç»„æ”¹å˜ï¼‰sort()ï¼šæŒ‰å‡åºæ’åˆ—æ•°ç»„é¡¹â€”â€”å³æœ€å°çš„å€¼ä½äºæœ€å‰é¢ï¼Œæœ€å¤§çš„å€¼æ’åœ¨æœ€åé¢ã€‚ åœ¨æ’åºæ—¶ï¼Œsort()æ–¹æ³•ä¼šè°ƒç”¨æ¯ä¸ªæ•°ç»„é¡¹çš„ toString()è½¬å‹æ–¹æ³•ï¼Œç„¶åæ¯”è¾ƒå¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œä»¥ç¡®å®šå¦‚ä½•æ’åºã€‚å³ä½¿æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯æ•°å€¼ï¼Œ sort()æ–¹æ³•æ¯”è¾ƒçš„ä¹Ÿæ˜¯å­—ç¬¦ä¸²ã€‚123456var arr1 = [\"a\", \"d\", \"c\", \"b\"];console.log(arr1.sort()); // [\"a\", \"b\", \"c\", \"d\"]console.log(arr1); // [\"a\", \"b\", \"c\", \"d\"]var arr2 = [15, 22, 46, 3];console.log(arr2.sort()); // [15, 22, 3, 46]console.log(arr2); // [15, 22, 3, 46] è§£å†³æ–¹æ³•ï¼šsort()æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ¯”è¾ƒå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥ä½äºç¬¬äºŒä¸ªä¹‹å‰åˆ™è¿”å›ä¸€ä¸ªè´Ÿæ•°ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°ç›¸ç­‰åˆ™è¿”å› 0ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥ä½äºç¬¬äºŒä¸ªä¹‹ååˆ™è¿”å›ä¸€ä¸ªæ­£æ•°ã€‚12345678910111213function compare(value1, value2) &#123; if (value1 &lt; value2) &#123; return -1; &#125; else if (value1 &gt; value2) &#123; return 1; &#125; else &#123; return 0; &#125;&#125;arr2 = [15, 22, 46, 3];console.log(arr2.sort(compare)); // [3, 15, 22, 46] å¦‚æœéœ€è¦é€šè¿‡æ¯”è¾ƒå‡½æ•°äº§ç”Ÿé™åºæ’åºçš„ç»“æœï¼Œåªè¦äº¤æ¢æ¯”è¾ƒå‡½æ•°è¿”å›çš„å€¼å³å¯ã€‚12345678910111213function compare(value1, value2) &#123; if (value1 &lt; value2) &#123; return 1; &#125; else if (value1 &gt; value2) &#123; return -1; &#125; else &#123; return 0; &#125;&#125;arr2 = [15, 22, 46, 3];console.log(arr2.sort(compare)); // [46, 22, 15, 3] reverse()ï¼ˆåŸæ•°ç»„æ”¹å˜ï¼‰reverse()ï¼šåè½¬æ•°ç»„é¡¹çš„é¡ºåºã€‚123var arr = [15, 22, 46, 3];console.log(arr.reverse()); // [3, 46, 22, 15]console.log(arr); // [3, 46, 22, 15] concat()concat()ï¼šå°†å‚æ•°æ·»åŠ åˆ°åŸæ•°ç»„ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå…ˆåˆ›å»ºå½“å‰æ•°ç»„ä¸€ä¸ªå‰¯æœ¬ï¼Œç„¶åå°†æ¥æ”¶åˆ°çš„å‚æ•°æ·»åŠ åˆ°è¿™ä¸ªå‰¯æœ¬çš„æœ«å°¾ï¼Œæœ€åè¿”å›æ–°æ„å»ºçš„æ•°ç»„ã€‚åœ¨æ²¡æœ‰ç»™ concat()æ–¹æ³•ä¼ é€’å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå®ƒåªæ˜¯å¤åˆ¶å½“å‰æ•°ç»„å¹¶è¿”å›å‰¯æœ¬ã€‚ ä¼ å…¥çš„ä¸æ˜¯æ•°ç»„ï¼Œåˆ™ç›´æ¥æŠŠå‚æ•°æ·»åŠ åˆ°æ•°ç»„åé¢ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯æ•°ç»„ï¼Œåˆ™å°†æ•°ç»„ä¸­çš„å„ä¸ªé¡¹æ·»åŠ åˆ°æ•°ç»„ä¸­ã€‚1234var arr = [1, 3, 5, 7];var arr1 = arr.concat(9, [11, 13]);console.log(arr1); // [1, 3, 5, 7, 9, 11, 13]console.log(arr); // [1, 3, 5, 7] è‹¥ä¼ å…¥çš„æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚123var arr2 = arr.concat([9, [11, 13]]);console.log(arr2); // [1, 3, 5, 7, 9, Array[2]]console.log(arr2[5]); // [11, 13] slice()slice()ï¼šè¿”å›ä»åŸæ•°ç»„ä¸­æŒ‡å®šå¼€å§‹ä¸‹æ ‡åˆ°ç»“æŸä¸‹æ ‡ä¹‹é—´çš„é¡¹ç»„æˆçš„æ–°æ•°ç»„ã€‚å¯ä»¥æ¥å—ä¸€æˆ–ä¸¤ä¸ªå‚æ•°ï¼Œå³è¦è¿”å›é¡¹çš„èµ·å§‹å’Œç»“æŸä½ç½®ã€‚åœ¨åªæœ‰ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œslice()æ–¹æ³•è¿”å›ä»è¯¥å‚æ•°æŒ‡å®šä½ç½®å¼€å§‹åˆ°å½“å‰æ•°ç»„æœ«å°¾çš„æ‰€æœ‰é¡¹ã€‚å¦‚æœæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè¯¥æ–¹æ³•è¿”å›èµ·å§‹å’Œç»“æŸä½ç½®ä¹‹é—´çš„é¡¹â€”â€”ä½†ä¸åŒ…æ‹¬ç»“æŸä½ç½®çš„é¡¹ã€‚12345678910var arr = [1, 3, 5, 7, 9, 11];var arr1 = arr.slice(1);var arr2 = arr.slice(1, 4);var arr3 = arr.slice(1, -2);var arr4 = arr.slice(-4, -1);console.log(arr); // [1, 3, 5, 7, 9, 11]console.log(arr1); // [3, 5, 7, 9, 11]console.log(arr2); // [3, 5, 7]console.log(arr3); // [3, 5, 7]console.log(arr4); // [5, 7, 9] arr1åªè®¾ç½®äº†ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯èµ·å§‹ä¸‹æ ‡ä¸º1ï¼Œæ‰€ä»¥è¿”å›çš„æ•°ç»„ä¸ºä¸‹æ ‡1ï¼ˆåŒ…æ‹¬ä¸‹æ ‡1ï¼‰å¼€å§‹åˆ°æ•°ç»„æœ€åã€‚arr2è®¾ç½®äº†ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›èµ·å§‹ä¸‹æ ‡ï¼ˆåŒ…æ‹¬1ï¼‰å¼€å§‹åˆ°ç»ˆæ­¢ä¸‹æ ‡ï¼ˆä¸åŒ…æ‹¬4ï¼‰çš„å­æ•°ç»„ã€‚arr3è®¾ç½®äº†ä¸¤ä¸ªå‚æ•°ï¼Œç»ˆæ­¢ä¸‹æ ‡ä¸ºè´Ÿæ•°ï¼Œå½“å‡ºç°è´Ÿæ•°æ—¶ï¼Œå°†è´Ÿæ•°åŠ ä¸Šæ•°ç»„é•¿åº¦çš„å€¼ï¼ˆ6ï¼‰æ¥æ›¿æ¢è¯¥ä½ç½®çš„æ•°ï¼Œå› æ­¤å°±æ˜¯ä»1å¼€å§‹åˆ°4ï¼ˆä¸åŒ…æ‹¬ï¼‰çš„å­æ•°ç»„ã€‚arr4ä¸­ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥éƒ½åŠ ä¸Šæ•°ç»„é•¿åº¦6è½¬æ¢æˆæ­£æ•°ï¼Œå› æ­¤ç›¸å½“äºslice(2, 5)ã€‚ splice()splice()ï¼šå¯ä»¥å®ç°åˆ é™¤ã€æ’å…¥å’Œæ›¿æ¢ã€‚ åˆ é™¤ï¼šå¯ä»¥åˆ é™¤ä»»æ„æ•°é‡çš„é¡¹ï¼Œåªéœ€æŒ‡å®š 2 ä¸ªå‚æ•°ï¼šè¦åˆ é™¤çš„ç¬¬ä¸€é¡¹çš„ä½ç½®å’Œè¦åˆ é™¤çš„é¡¹æ•°ã€‚ä¾‹å¦‚ï¼Œsplice(0,2)ä¼šåˆ é™¤æ•°ç»„ä¸­çš„å‰ä¸¤é¡¹ã€‚ æ’å…¥ï¼šå¯ä»¥å‘æŒ‡å®šä½ç½®æ’å…¥ä»»æ„æ•°é‡çš„é¡¹ï¼Œåªéœ€æä¾› 3 ä¸ªå‚æ•°ï¼šèµ·å§‹ä½ç½®ã€ 0ï¼ˆè¦åˆ é™¤çš„é¡¹æ•°ï¼‰å’Œè¦æ’å…¥çš„é¡¹ã€‚ä¾‹å¦‚ï¼Œsplice(2,0,4,6)ä¼šä»å½“å‰æ•°ç»„çš„ä½ç½® 2 å¼€å§‹æ’å…¥4å’Œ6ã€‚ æ›¿æ¢ï¼šå¯ä»¥å‘æŒ‡å®šä½ç½®æ’å…¥ä»»æ„æ•°é‡çš„é¡¹ï¼Œä¸”åŒæ—¶åˆ é™¤ä»»æ„æ•°é‡çš„é¡¹ï¼Œåªéœ€æŒ‡å®š 3 ä¸ªå‚æ•°ï¼šèµ·å§‹ä½ç½®ã€è¦åˆ é™¤çš„é¡¹æ•°å’Œè¦æ’å…¥çš„ä»»æ„æ•°é‡çš„é¡¹ã€‚æ’å…¥çš„é¡¹æ•°ä¸å¿…ä¸åˆ é™¤çš„é¡¹æ•°ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼Œsplice (2,1,4,6)ä¼šåˆ é™¤å½“å‰æ•°ç»„ä½ç½® 2 çš„é¡¹ï¼Œç„¶åå†ä»ä½ç½® 2 å¼€å§‹æ’å…¥4å’Œ6ã€‚ splice()æ–¹æ³•å§‹ç»ˆéƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„ä¸­åŒ…å«ä»åŸå§‹æ•°ç»„ä¸­åˆ é™¤çš„é¡¹ï¼Œå¦‚æœæ²¡æœ‰åˆ é™¤ä»»ä½•é¡¹ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚12345678910var arr = [1, 3, 5, 7, 9, 11];var arr1 = arr.splice(0, 2);console.log(arr); //[5, 7, 9, 11]console.log(arr1); //[1, 3]var arr2 = arr.splice(2, 0, 4, 6);console.log(arr); // [5, 7, 4, 6, 9, 11]console.log(arrR2); // []var arr3 = arr.splice(1, 1, 2, 4);console.log(arr); // [5, 2, 4, 4, 6, 9, 11]console.log(arrR3); // [7] indexOf()å’Œ lastIndexOf()indexOf()ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¦æŸ¥æ‰¾çš„é¡¹å’Œï¼ˆå¯é€‰çš„ï¼‰è¡¨ç¤ºæŸ¥æ‰¾èµ·ç‚¹ä½ç½®çš„ç´¢å¼•ã€‚å…¶ä¸­ï¼Œ ä»æ•°ç»„çš„å¼€å¤´ï¼ˆä½ç½® 0ï¼‰å¼€å§‹å‘åæŸ¥æ‰¾ã€‚lastIndexOf()ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¦æŸ¥æ‰¾çš„é¡¹å’Œï¼ˆå¯é€‰çš„ï¼‰è¡¨ç¤ºæŸ¥æ‰¾èµ·ç‚¹ä½ç½®çš„ç´¢å¼•ã€‚å…¶ä¸­ï¼Œ ä»æ•°ç»„çš„æœ«å°¾å¼€å§‹å‘å‰æŸ¥æ‰¾ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½è¿”å›è¦æŸ¥æ‰¾çš„é¡¹åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œæˆ–è€…åœ¨æ²¡æ‰¾åˆ°çš„æƒ…å†µä¸‹è¿”å›-1ã€‚åœ¨æ¯”è¾ƒç¬¬ä¸€ä¸ªå‚æ•°ä¸æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹æ—¶ï¼Œä¼šä½¿ç”¨å…¨ç­‰æ“ä½œç¬¦ã€‚123456var arr = [1, 3, 5, 7, 7, 5, 3, 1];console.log(arr.indexOf(5)); // 2console.log(arr.lastIndexOf(5)); // 5console.log(arr.indexOf(5,2)); // 2console.log(arr.lastIndexOf(5, 4)); // 2console.log(arr.indexOf(\"5\")); // -1 forEach()forEach()ï¼šå¯¹æ•°ç»„è¿›è¡Œéå†å¾ªç¯ï¼Œå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚å‚æ•°éƒ½æ˜¯functionç±»å‹ï¼Œé»˜è®¤æœ‰ä¼ å‚ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼šå€¼ï¼Œç´¢å¼•ã€‚1234567var arr = [1, 2, 3];arr.forEach(function(item, index)&#123;console.log(index, item);&#125;);// 0, 1// 1, 2// 2, 3 map()map()ï¼šæŒ‡â€œæ˜ å°„â€ï¼Œå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›æ¯æ¬¡å‡½æ•°è°ƒç”¨çš„ç»“æœç»„æˆçš„æ•°ç»„ã€‚ä¸‹é¢ä»£ç åˆ©ç”¨mapæ–¹æ³•å®ç°æ•°ç»„ä¸­æ¯ä¸ªæ•°æ±‚å¹³æ–¹ã€‚12345var arr = [1, 2, 3, 4];var arr2 = arr.map(function(item)&#123;return item*item;&#125;);console.log(arr2); // [1, 4, 9, 16] filter()filter()ï¼šâ€œè¿‡æ»¤â€åŠŸèƒ½ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›æ»¡è¶³è¿‡æ»¤æ¡ä»¶ç»„æˆçš„æ•°ç»„ã€‚12345var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];var arr2 = arr.filter(function(x, index) &#123;return index % 3 === 0 || x &gt;= 8;&#125;);console.log(arr2); //[1, 4, 7, 8, 9, 10] every()every()ï¼šåˆ¤æ–­æ•°ç»„ä¸­æ¯ä¸€é¡¹éƒ½æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œåªæœ‰æ‰€æœ‰é¡¹éƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ‰ä¼šè¿”å›trueã€‚123456789var arr = [1, 2, 3, 4, 5];var arr2 = arr.every(function(x) &#123; return x &lt; 10;&#125;);console.log(arr2); // truevar arr3 = arr.every(function(x) &#123; return x &lt; 3;&#125;);console.log(arr3); // false some()some()ï¼šåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„é¡¹ï¼Œåªè¦æœ‰ä¸€é¡¹æ»¡è¶³æ¡ä»¶ï¼Œå°±ä¼šè¿”å›trueã€‚123456789var arr = [1, 2, 3, 4, 5];var arr2 = arr.some(function(x) &#123; return x &lt; 3;&#125;);console.log(arr2); // truevar arr3 = arr.some(function(x) &#123; return x &lt; 1;&#125;);console.log(arr3); // false reduce()å’Œ reduceRight()è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šå®ç°è¿­ä»£æ•°ç»„çš„æ‰€æœ‰é¡¹ï¼Œç„¶åæ„å»ºä¸€ä¸ªæœ€ç»ˆè¿”å›çš„å€¼ã€‚reduce()æ–¹æ³•ä»æ•°ç»„çš„ç¬¬ä¸€é¡¹å¼€å§‹ï¼Œé€ä¸ªéå†åˆ°æœ€åã€‚reduceRight()åˆ™ä»æ•°ç»„çš„æœ€åä¸€é¡¹å¼€å§‹ï¼Œå‘å‰éå†åˆ°ç¬¬ä¸€é¡¹ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªåœ¨æ¯ä¸€é¡¹ä¸Šè°ƒç”¨çš„å‡½æ•°å’Œï¼ˆå¯é€‰çš„ï¼‰ä½œä¸ºå½’å¹¶åŸºç¡€çš„åˆå§‹å€¼ã€‚ä¼ ç»™ reduce()å’Œ reduceRight()çš„å‡½æ•°æ¥æ”¶ 4 ä¸ªå‚æ•°ï¼šå‰ä¸€ä¸ªå€¼ã€å½“å‰å€¼ã€é¡¹çš„ç´¢å¼•å’Œæ•°ç»„å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°è¿”å›çš„ä»»ä½•å€¼éƒ½ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è‡ªåŠ¨ä¼ ç»™ä¸‹ä¸€é¡¹ã€‚ç¬¬ä¸€æ¬¡è¿­ä»£å‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬äºŒé¡¹ä¸Šï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æ•°ç»„çš„ç¬¬äºŒé¡¹ã€‚ä¸‹é¢ä»£ç ç”¨reduce()å®ç°æ•°ç»„æ±‚å’Œï¼Œæ•°ç»„ä¸€å¼€å§‹åŠ äº†ä¸€ä¸ªåˆå§‹å€¼10ã€‚12345var values = [1, 2, 3, 4, 5];var sum = values.reduceRight(function(prev, cur, index, array)&#123; return prev + cur;&#125;, 10);console.log(sum); //25","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://pengfeidai.github.io/tags/Javascript/"}]},{"title":"MongoDBå­¦ä¹ ç¬”è®°","slug":"MongoDB","date":"2017-09-10T13:58:21.000Z","updated":"2017-09-27T09:36:54.000Z","comments":true,"path":"2017/09/10/MongoDB/","link":"","permalink":"https://pengfeidai.github.io/2017/09/10/MongoDB/","excerpt":"","text":"ç®€ä»‹ä»€ä¹ˆæ˜¯NoSQL?NoSQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“ã€‚ æ²¡æœ‰è¡Œã€åˆ—çš„æ¦‚å¿µã€‚ç”¨ JSON æ¥å­˜å‚¨æ•°æ®ã€‚é›†åˆå°±ç›¸å½“äº SQL æ•°æ®åº“ä¸­çš„â€œè¡¨â€ï¼Œæ–‡æ¡£å°±ç›¸å½“äºâ€œè¡Œâ€ã€‚ é€‚ç”¨äºï¼š æ•°æ®æ¨¡å‹æ¯”è¾ƒç®€å•ï¼› éœ€è¦çµæ´»æ€§æ›´å¼ºçš„ITç³»ç»Ÿï¼› å¯¹æ•°æ®åº“æ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼› ä¸éœ€è¦é«˜åº¦çš„æ•°æ®ä¸€è‡´æ€§ï¼› å¯¹äºç»™å®škeyï¼Œæ¯”è¾ƒå®¹æ˜“æ˜ å°„å¤æ‚å€¼çš„ç¯å¢ƒã€‚ ä»€ä¹ˆæ˜¯MongoDB?å®˜ç½‘ï¼šhttps://www.mongodb.com æ‰‹å†Œï¼šhttps://docs.mongodb.org/manual MongoDB æ˜¯ç”±C++è¯­è¨€ç¼–å†™çš„ï¼Œæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„å¼€æºæ•°æ®åº“ç³»ç»Ÿï¼Œæ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚ MongoDBå®‰è£…åŠè¿è¡Œä¸‹è½½æœ€æ–°çš„stableç‰ˆï¼šhttps://www.mongodb.com/download-center#community å®‰è£…å¥½ä¹‹åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®‰è£…çš„æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ï¼šC:\\Program Files\\MongoDB\\Server\\3.0\\binï¼Œå°†å…¶åŠ å…¥åˆ°ç³»ç»Ÿçš„pathç¯å¢ƒå˜é‡ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½åœ¨ç³»ç»Ÿçš„ä»»ä½•ç›˜ç¬¦ï¼Œä½¿ç”¨mongoå‘½ä»¤äº†ã€‚ 123mongo ä½¿ç”¨æ•°æ®åº“mongod å¼€æœºmongoimport å¯¼å…¥æ•°æ® å¯åŠ¨mongodæœåŠ¡ image â€“dbpathå°±æ˜¯é€‰æ‹©æ•°æ®åº“æ–‡æ¡£æ‰€åœ¨çš„æ–‡ä»¶å¤¹ã€‚ ç®¡ç†æ•°æ®åº“ï¼ˆæ–°å¼€ä¸€ä¸ªcmdï¼‰ image é‚£ä¹ˆï¼Œè¿è¡Œç¯å¢ƒå°±æ˜¯mongoè¯­æ³•äº†ã€‚ MongoDBå¸¸ç”¨æ“ä½œæŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“1show dbs ä½¿ç”¨æ•°æ®åº“ã€åˆ›å»ºæ•°æ®åº“1use test useä¸€ä¸ªä¸å­˜åœ¨çš„ï¼Œå°±æ˜¯æ–°å»ºã€‚ æŸ¥çœ‹å½“å‰æ‰€åœ¨æ•°æ®åº“1db æ’å…¥æ•°æ®æ•°æ®åº“ä¸­ä¸èƒ½ç›´æ¥æ’å…¥æ•°æ®ï¼Œåªèƒ½å¾€é›†åˆ(collections)ä¸­æ’å…¥æ•°æ®ã€‚ä¸éœ€è¦åˆ›å»ºé›†åˆï¼Œåªéœ€è¦å†™ç‚¹è¯­æ³•ï¼š 1db.student.insert(&#123;&quot;name&quot;:&quot;Davis&quot;,&quot;age&quot;:&quot;22&quot;,&quot;sex&quot;:&quot;ç”·&quot;&#125;) db.student ç³»ç»Ÿå‘ç°studentæ˜¯ä¸€ä¸ªé™Œç”Ÿçš„é›†åˆåå­—ï¼Œæ‰€ä»¥å°±è‡ªåŠ¨åˆ›å»ºäº†é›†åˆã€‚ åˆ é™¤æ•°æ®åº“åˆ é™¤å½“å‰æ•°æ®åº“1db.dropDatabase(); æ•°æ®åº“ä½¿ç”¨æ’å…¥æ•°æ®æ’å…¥æ•°æ®ï¼Œéšç€æ•°æ®çš„æ’å…¥ï¼Œæ•°æ®åº“åˆ›å»ºæˆåŠŸäº†ï¼Œé›†åˆä¹Ÿåˆ›å»ºæˆåŠŸäº†ã€‚ 1db.student.insert(&#123;&quot;name&quot;:&quot;Davis&quot;,&quot;age&quot;:&quot;22&quot;,&quot;sex&quot;:&quot;ç”·&quot;&#125;) æˆ‘ä»¬ä¸å¯èƒ½ä¸€æ¡ä¸€æ¡çš„insertã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨sublimeåœ¨å¤–éƒ¨å†™å¥½æ•°æ®åº“çš„å½¢å¼ï¼Œç„¶åå¯¼å…¥æ•°æ®åº“ï¼š å¯¼å…¥json1mongoimport --db test --collection student --drop --file data.json å¯¼å…¥jsonæ•°ç»„1mongoimport --db test --collection student --drop --file data.json --jsonArray -db test æƒ³å¾€å“ªä¸ªæ•°æ®åº“é‡Œé¢å¯¼å…¥--collection student æƒ³å¾€å“ªä¸ªé›†åˆä¸­å¯¼å…¥--drop æŠŠå·²å­˜åœ¨æ•°æ®æ¸…ç©º--file data.json å“ªä¸ªæ–‡ä»¶ è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ç”¨sublimeåˆ›å»ºä¸€ä¸ªjsonæ–‡ä»¶ï¼Œç„¶åç”¨mongoimportå‘½ä»¤å¯¼å…¥ã€‚ æŸ¥æ‰¾æ•°æ® æŸ¥æ‰¾æ•°æ®ï¼Œç”¨findã€‚findä¸­æ²¡æœ‰å‚æ•°ï¼Œé‚£ä¹ˆå°†åˆ—å‡ºè¿™ä¸ªé›†åˆçš„æ‰€æœ‰æ–‡æ¡£ï¼š 1db.student.find() ç²¾ç¡®åŒ¹é… 1db.student.find(&#123;&quot;age&quot;:22&#125;) å¤šä¸ªæ¡ä»¶ 1db.student.find(&#123;&quot;age&quot;:12, &quot;sex&quot;:&quot;ç”·&quot;&#125;) å¤§äºæ¡ä»¶ 1db.student.find(&#123;&quot;age&quot;:&#123;$gt:20&#125;&#125;) æˆ–è€…ï¼ˆå¯»æ‰¾æ‰€æœ‰å¹´é¾„æ˜¯20å²ï¼Œæˆ–è€…22å²çš„å­¦ç”Ÿï¼‰ 1db.student.find(&#123;$or:[&#123;&quot;age&quot;:20&#125;,&#123;&quot;age&quot;:22&#125;]&#125;); æŸ¥æ‰¾å®Œæ¯•ä¹‹åï¼Œæ‰“ç‚¹è°ƒç”¨sortï¼Œè¡¨ç¤ºå‡ï¼ˆ1ï¼‰é™ï¼ˆ-1ï¼‰æ’åº 1db.student.find().sort(&#123;&quot;age&quot;:1, &quot;score.English&quot;:1&#125;) æŸ¥çœ‹å½“å‰Mongodbè¿è¡ŒçŠ¶æ€ 1db.student.stats(); åˆ†é¡µæŸ¥è¯¢ é€šè¿‡ sike() ä¸ limit() æ–¹æ³• å‡å¦‚ï¼Œç¬¬ä¸€é¡µæ˜¯page=0ã€‚æ¯é¡µ10æ¡ï¼Œæ‰€ä»¥å½“å‰é¡µçš„æŸ¥è¯¢è¯­å¥1db.student.find(&#123;&#125;).limit(10).skip(page*10) limit()è¡¨ç¤ºè¯»å–çš„æ¡æ•°ï¼Œsike()è¡¨ç¤ºç•¥è¿‡çš„æ¡æ•°ã€‚ ä¿®æ”¹æ•°æ® ä¿®æ”¹é‡Œé¢è¿˜æœ‰æŸ¥è¯¢æ¡ä»¶ æŸ¥æ‰¾åå­—å«åšDavisçš„ï¼ŒæŠŠå¹´é¾„æ›´æ”¹ä¸º20å²ï¼š1db.student.update(&#123;&quot;name&quot;:&quot;Davis&quot;&#125;,&#123;$set:&#123;&quot;age&quot;:20&#125;&#125;) æ›´æ”¹æ‰€æœ‰åŒ¹é…é¡¹ç›® 1db.student.update(&#123;&quot;sex&quot;:&quot;ç”·&quot;&#125;,&#123;$set:&#123;&quot;age&quot;:20&#125;&#125;,&#123;multi: true&#125;); å®Œæ•´æ›¿æ¢ï¼Œä¸å‡ºç°$setå…³é”®å­—äº† 1db.student.update(&#123;&quot;name&quot;:&quot;Davis&quot;&#125;,&#123;&quot;name&quot;:&quot;dpf&quot;,&quot;age&quot;:20&#125;); åˆ é™¤æ•°æ® åˆ é™¤é›†åˆä¸­é«˜æ•°æˆç»©ä¸º 60 çš„å­¦ç”Ÿ 1db.student.remove(&#123;&apos;score.English&apos;:60&#125;); åˆ é™¤ç¬¬ä¸€æ¡æ‰¾åˆ°çš„è®°å½•å¯ä»¥è®¾ç½® justOne ä¸º 1 1db.student.remove(&#123;&apos;score.English&apos;:60&#125;,1); MongooseMongooseï¼Œæ˜¯ä¸€ä¸ªå°†JavaScriptå¯¹è±¡ä¸æ•°æ®åº“äº§ç”Ÿå…³ç³»çš„ä¸€ä¸ªæ¡†æ¶ï¼Œobject related modelã€‚æ‰€æœ‰çš„æ“ä½œéƒ½ä¸æ˜¯å¯¹æ•°æ®åº“è¿›è¡Œçš„ã€‚è€Œæ˜¯å¯¹ç±»ã€å®ä¾‹è¿›è¡Œçš„ï¼Œå¯¹è±¡äº§ç”Ÿäº†ï¼ŒåŒæ—¶ä¹ŸæŒä¹…åŒ–äº†ã€‚ å®˜ç½‘ï¼šhttp://mongoosejs.com/ æ•°æ®åº“è¿æ¥1234567var mongoose = require('mongoose');//åˆ›å»ºæ•°æ®åº“è¿æ¥var db = mongoose.createConnection('mongodb://127.0.0.1:27017/test');//ç›‘å¬openäº‹ä»¶db.once('open', function (callback) &#123; console.log(\"æ•°æ®åº“æˆåŠŸè¿æ¥\");&#125;); å®šä¹‰æ¨¡å‹ image åˆ›é€ schema â†’ å®šä¹‰ä¸€äº›schemaçš„é™æ€æ–¹æ³• â†’ åˆ›é€ æ¨¡å‹ åˆ›é€ schema1new mongoose.schema(&#123;&#125;); åˆ›é€ æ¨¡å‹1db.model(â€œStudentâ€,schemaåå­—); 1234567891011121314151617//åˆ›å»ºäº†ä¸€ä¸ªschemaç»“æ„ã€‚var studentSchema = new mongoose.Schema(&#123; name : &#123;type : String&#125;, age : &#123;type : Number&#125;, sex : &#123;type : String&#125;&#125;);//åˆ›å»ºé™æ€æ–¹æ³•studentSchema.statics.zhaoren = function(name, callback) &#123; this.model('Student').find(&#123;name: name&#125;, callback); //this.model('Student')æŒ‡çš„æ˜¯å½“å‰è¿™ä¸ªç±»&#125;;//åˆ›å»ºä¿®æ”¹çš„é™æ€æ–¹æ³•studentSchema.statics.xiugai = function(conditions,update,options,callback)&#123; this.model(\"Student\").update(conditions, update, options, callback);&#125;//åˆ›å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œå°±æ˜¯å­¦ç”Ÿæ¨¡å‹ï¼Œå°±æ˜¯å­¦ç”Ÿç±»ã€‚//ç±»æ˜¯åŸºäºschemaåˆ›å»ºçš„ã€‚var studentModel = db.model('Student', studentSchema); MongoVUEè¿æ¥MongoDBä¸æ˜¾ç¤ºæ•°æ®é—®é¢˜ mongoDB3.2ç‰ˆæœ¬ä¹‹åé»˜è®¤å¼€å¯çš„å­˜å‚¨å¼•æ“æ˜¯ wiredTigerï¼Œä½¿ç”¨è¿™ç§å­˜å‚¨å¼•æ“å­˜å‚¨çš„æ•°æ®åªèƒ½åœ¨å‘½ä»¤è¡Œä¸­çœ‹åˆ°ï¼Œåœ¨ mongoVUE ä¸­çœ‹ä¸åˆ°ã€‚ æ‰€ä»¥ï¼Œéœ€è¦æ¢æˆ mmapv1 æ“ä½œå¼•æ“ï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨ mongoVUE ä¸­çœ‹åˆ° Collections ä¸‹çš„å†…å®¹1mongod --storageEngine mmapv1 --dbpath D:\\mongo(è·¯å¾„) é€‰æ‹© mmapv1å­˜å‚¨å¼•æ“åï¼Œns åç¼€æ–‡ä»¶å°±æ˜¯æ•°æ®åº“","categories":[],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://pengfeidai.github.io/tags/Node-js/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://pengfeidai.github.io/tags/MongoDB/"},{"name":"mongoose","slug":"mongoose","permalink":"https://pengfeidai.github.io/tags/mongoose/"}]},{"title":"JavaScriptæœ€å…¨è®¾è®¡æ¨¡å¼è¯¦è§£","slug":"JavaScriptè®¾è®¡æ¨¡å¼","date":"2017-08-10T07:29:04.000Z","updated":"2020-05-22T12:14:57.000Z","comments":true,"path":"2017/08/10/JavaScriptè®¾è®¡æ¨¡å¼/","link":"","permalink":"https://pengfeidai.github.io/2017/08/10/JavaScriptè®¾è®¡æ¨¡å¼/","excerpt":"","text":"ç®€ä»‹è®©ç³»ç»Ÿä»£ç å¯é‡ç”¨ã€å¯æ‰©å±•ã€å¯è§£è€¦ã€æ›´å®¹æ˜“è¢«äººç†è§£ä¸”ä¿è¯ä»£ç å¯é æ€§ã€‚è®¾è®¡æ¨¡å¼ä½¿ä»£ç çœŸæ­£å·¥ç¨‹åŒ–ã€‚ image è®¾è®¡åŸåˆ™ï¼š å¼€é—­åŸåˆ™ï¼š å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ é‡Œæ°è½¬æ¢åŸåˆ™ï¼š å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œå•ç‹¬å®Œå…¨å¯ä»¥è¿è¡Œ ä¾èµ–å€’è½¬åŸåˆ™ï¼š å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æœ‰åº•å±‚ç±»å‹ï¼Œç›´æ¥å¼•ç”¨åº•å±‚ç±»å‹ æ¥å£éš”ç¦»åŸåˆ™ï¼š æ¯ä¸€ä¸ªæ¥å£åº”è¯¥æ˜¯ä¸€ç§è§’è‰² åˆæˆ/èšåˆå¤ç”¨åŸåˆ™ï¼š æ–°çš„å¯¹è±¡åº”ä½¿ç”¨ä¸€äº›å·²æœ‰çš„å¯¹è±¡ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ† è¿ªç±³ç‰¹åŸåˆ™ï¼š ä¸€ä¸ªå¯¹è±¡åº”å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ å•ä¾‹æ¨¡å¼æ¦‚å¿µä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå®ç°æ–¹æ³•æ˜¯å…ˆåˆ¤æ–­å®ä¾‹å­˜åœ¨ä¸å¦ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºäº†å†è¿”å›ï¼Œç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚ åœ¨ JavaScript ä¸­ï¼Œå•ä¾‹ä½œä¸ºä¸€ä¸ªå‘½åç©ºé—´æä¾›è€…ï¼Œä»å…¨å±€å‘½åç©ºé—´é‡Œæä¾›ä¸€ä¸ªå”¯ä¸€çš„è®¿é—®ç‚¹æ¥è®¿é—®è¯¥å¯¹è±¡ã€‚ 123456789101112131415161718192021222324var Singleton = (function () &#123; var instantiated; function init() &#123; /*è¿™é‡Œå®šä¹‰å•ä¾‹ä»£ç */ return &#123; publicMethod: function () &#123; console.log('hello world'); &#125;, publicProperty: 'test' &#125;; &#125; return &#123; getInstance: function () &#123; if (!instantiated) &#123; //ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹ instantiated = init(); //ä½¿ç”¨initæ–¹æ³•ï¼Œæ˜¯ä½¿publicMethodå’ŒpublicPropertyåªåœ¨è¦ä½¿ç”¨çš„æ—¶å€™æ‰åˆå§‹åŒ–; &#125; return instantiated; &#125; &#125;;&#125;)();/*è°ƒç”¨å…¬æœ‰çš„æ–¹æ³•æ¥è·å–å®ä¾‹:*/Singleton.getInstance().publicMethod(); // hello world ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š æ¨¡å—é—´é€šä¿¡ ç³»ç»Ÿä¸­æŸä¸ªç±»çš„å¯¹è±¡åªèƒ½å­˜åœ¨ä¸€ä¸ª ä¿æŠ¤è‡ªå·±çš„å±æ€§å’Œæ–¹æ³• æ³¨æ„äº‹é¡¹ï¼š æ³¨æ„thisçš„ä½¿ç”¨ é—­åŒ…å®¹æ˜“é€ æˆå†…å­˜æ³„éœ²ï¼Œä¸éœ€è¦çš„è¦èµ¶å¿«æ¸…é™¤ æ³¨æ„newçš„æˆæœ¬ã€‚ï¼ˆç»§æ‰¿ï¼‰ å®ä¾‹åœ¨ç½‘é¡µä¸Šå®ç°ä¸€ä¸ªç™»é™†å¼¹æ¡†ï¼Œæ— è®ºæˆ‘ä»¬ç‚¹å‡»å¤šå°‘æ¬¡ç™»é™†æŒ‰é’®ï¼Œç•Œé¢ä¸Šå§‹ç»ˆåªä¼šæ˜¾ç¤ºä¸€ä¸ªç™»é™†å¼¹æ¡†ï¼Œæ— æ³•å†åˆ›å»ºç¬¬äºŒä¸ªã€‚ æºç ä¸‹è½½ &nbsp;&nbsp;&nbsp; demoæ¼”ç¤º ï¼ˆ1ï¼‰è·å–DOMå¯¹è±¡123var $ = function(id) &#123; return typeof id === 'string' ? document.getElementById(id) : id;&#125;; ä¸ºäº†ä¾¿äºä¹‹åå…³äºDOMçš„ä¸€äº›æ“ä½œï¼Œæˆ‘ä»¬è¿™é‡Œåˆ©ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åŸç†å°†è·å–ç›®æ ‡ id çš„å…ƒç´ å¯¹è±¡æ–¹æ³•å°è£…äº†ä¸€ä¸‹ï¼Œç›´æ¥åˆ©ç”¨ $(id) å°±å¯ä»¥è·å–ã€‚ ï¼ˆ2ï¼‰å¼¹æ¡†æ„é€ å‡½æ•°12345var Modal = function(id, html) &#123; this.html = html; this.id = id; this.open = false;&#125;; è¿™é‡Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ª Modal ä½œä¸ºå¼¹æ¡†çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”å†å…¶å†…éƒ¨å®šä¹‰äº†å…¬æœ‰å±æ€§ htmlã€id å’Œ openã€‚html ç”¨æ¥å®šä¹‰å¼¹æ¡†å†…éƒ¨çš„å†…å®¹ï¼Œid ç”¨æ¥ç»™å¼¹æ¡†å®šä¹‰ id åç§°ï¼Œopen ç”¨äºåˆ¤æ–­å¼¹æ¡†æ˜¯å¦æ‰“å¼€ã€‚ ï¼ˆ3ï¼‰openæ–¹æ³•123456789101112131415Modal.prototype.create = function() &#123; if (!this.open) &#123; var modal = document.createElement('div'); modal.innerHTML = this.html; modal.id = this.id; document.body.appendChild(modal); setTimeout(function() &#123; modal.classList.add('show'); &#125;, 0); this.open = true; &#125;&#125;; åœ¨ Modal çš„åŸå‹é“¾ä¸Šå®šä¹‰äº† create æ–¹æ³•ï¼Œæ–¹æ³•å†…éƒ¨æˆ‘ä»¬åˆ›å»ºå¹¶å‘ DOM ä¸­æ’å…¥å¼¹æ¡†ï¼ŒåŒæ—¶ç»™å¼¹æ¡†åŠ ä¸Šä¸€ä¸ª class ä¸º â€œshowâ€ çš„åŠ¨ç”»æ•ˆæœã€‚ ï¼ˆ4ï¼‰closeæ–¹æ³•123456789101112Modal.prototype.delete = function() &#123; if (this.open) &#123; var modal = $(this.id); modal.classList.add('hide'); setTimeout(function() &#123; document.body.removeChild(modal); &#125;, 200); this.open = false; &#125;&#125;; å®šä¹‰äº† open æ–¹æ³•åæˆ‘ä»¬è¿™é‡Œå®šä¹‰å…³é—­å¼¹æ¡†çš„æ–¹æ³•ï¼Œåœ¨å…¶å†…éƒ¨ç»™å¼¹æ¡†å¯¹è±¡æ·»åŠ  hide ç±»åŠ¨ç”»æ•ˆæœï¼Œæœ€ååœ¨é¡µé¢ä¸Šç§»é™¤å¼¹æ¡†å¯¹è±¡ã€‚ ï¼ˆ5ï¼‰åˆ›å»ºå®ä¾‹123456var createIntance = (function() &#123; var instance; return function() &#123; return instance || (instance = new Modal('modal', 'è¿™æ˜¯ä¸€ä¸ªå¼¹æ¡†')) &#125;&#125;)(); è¿™æ˜¯å®ç°å•ä¾‹æ¨¡å¼çš„é‡è¦éƒ¨åˆ†: ä½¿ç”¨é—­åŒ…å°è£…äº† instance ç§æœ‰å˜é‡å¹¶è¿”å›ä¸€ä¸ªå‡½æ•° åˆ©ç”¨ || è¯­æ³•åˆ¤æ–­å¦‚æœ instance ä¸å­˜åœ¨åˆ™æ‰§è¡Œåè€…çš„å®ä¾‹åŒ– Modal æ–¹æ³•ï¼Œå­˜åœ¨åˆ™ç›´æ¥è¿”å› instanceï¼Œç¡®ä¿äº†åªå­˜åœ¨ä¸€ä¸ªå¼¹æ¡†å®ä¾‹ ï¼ˆ6ï¼‰æŒ‰é’®æ“ä½œ12345678910var operate = &#123; setModal: null, open: function() &#123; this.setModal = createIntance(); this.setModal.create(); &#125;, delete: function() &#123; this.setModal ? this.setModal.delete() : ''; &#125;&#125;; è¿™é‡Œæˆ‘ä»¬å°†æŒ‰é’®æ“ä½œæ”¾åœ¨ operate å¯¹è±¡é‡Œï¼Œä½¿å¾—æ‰“å¼€å’Œå…³é—­æ“ä½œå¯ä»¥é€šè¿‡thisè·å–å®ä¾‹setModalã€‚ ï¼ˆ7ï¼‰ç»‘å®šäº‹ä»¶1234567$('open').onclick = function() &#123; operate.open();&#125;;$('delete').onclick = function() &#123; operate.delete();&#125;; æœ€åæˆ‘ä»¬å°†æ‰“å¼€å’Œåˆ é™¤æ–¹æ³•ç»‘å®šåˆ°ä¸¤ä¸ªæŒ‰é’®ä¸Šå»ï¼Œè‡³æ­¤æˆ‘ä»¬ç”¨å•ä¾‹æ¨¡å¼å®ç°çš„å¼¹æ¡†demoå°±å®ç°äº†ã€‚ æ„é€ å‡½æ•°æ¨¡å¼æ¦‚å¿µ æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡â€”â€”ä¸ä»…å£°æ˜äº†ä½¿ç”¨è¿‡çš„å¯¹è±¡ï¼Œæ„é€ å‡½æ•°è¿˜å¯ä»¥æ¥å—å‚æ•°ä»¥ä¾¿ç¬¬ä¸€æ¬¡åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è®¾ç½®å¯¹è±¡çš„æˆå‘˜å€¼ã€‚ä½ å¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œç„¶ååœ¨é‡Œé¢å£°æ˜è‡ªå®šä¹‰ç±»å‹å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ã€‚ ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š ç”¨äºåˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡ ç¬¬ä¸€æ¬¡å£°æ˜çš„æ—¶å€™ç»™å¯¹è±¡èµ‹å€¼ è‡ªå·±å£°æ˜æ„é€ å‡½æ•°ï¼Œèµ‹äºˆå±æ€§å’Œæ–¹æ³• æ³¨æ„äº‹é¡¹ï¼š å£°æ˜å‡½æ•°çš„æ—¶å€™å¤„ç†ä¸šåŠ¡é€»è¾‘ åŒºåˆ†å’Œå•ä¾‹çš„åŒºåˆ«ï¼Œé…åˆå•ä¾‹å®ç°åˆå§‹åŒ– æ„é€ å‡½æ•°å¤§å†™å­—æ¯å¼€å¤´ æ³¨æ„ new çš„æˆæœ¬ ï¼ˆç»§æ‰¿ï¼‰ å®ä¾‹å¼ºåˆ¶ä½¿ç”¨new123456789101112131415161718function Person(name, age, job) &#123; if (!(this instanceof Person)) &#123; return new Person(name, age, job); &#125; this.name = name; this.age = age; this.job = job; this.sayName = function() &#123; return this.name + 'is' + this.age + 'years old'; &#125;&#125;var person1 = new Person(\"Davis\", 22, \"student\");var person2 = Person(\"Faker\", 21, \"player\");console.log(person1.sayName()); // Davis is 22 years oldconsole.log(person2.sayName()); // Faker is 21 years old å»ºé€ è€…æ¨¡å¼æ¦‚å¿µ å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚å¦‚æœæˆ‘ä»¬ç”¨äº†å»ºé€ è€…æ¨¡å¼ï¼Œé‚£ä¹ˆç”¨æˆ·å°±éœ€è¦æŒ‡å®šéœ€è¦å»ºé€ çš„ç±»å‹å°±å¯ä»¥å¾—åˆ°å®ƒä»¬ï¼Œè€Œå…·ä½“å»ºé€ çš„è¿‡ç¨‹å’Œç»†èŠ‚å°±ä¸éœ€è¦çŸ¥é“äº†ã€‚å»ºé€ è€…æ¨¡å¼å®é™…å°±æ˜¯ä¸€ä¸ªæŒ‡æŒ¥è€…ï¼Œä¸€ä¸ªå»ºé€ è€…ï¼Œä¸€ä¸ªä½¿ç”¨æŒ‡æŒ¥è€…è°ƒç”¨å…·ä½“å»ºé€ è€…å·¥ä½œå¾—å‡ºç»“æœçš„å®¢æˆ·ã€‚ä¸»è¦ç”¨äºâ€œåˆ†æ­¥éª¤æ„å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡â€ã€‚ ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š åˆ†æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ è§£è€¦å°è£…è¿‡ç¨‹å’Œå…·ä½“åˆ›å»ºç»„ä»¶ æ— éœ€å…³å¿ƒç»„ä»¶å¦‚ä½•ç»„è£… æ³¨æ„äº‹é¡¹ï¼š ä¸€å®šè¦ä¸€ä¸ªç¨³å®šçš„ç®—æ³•è¿›è¡Œæ”¯æŒï¼ˆâ€œåˆ†æ­¥éª¤â€æ˜¯ä¸€ä¸ªç¨³å®šçš„ç®—æ³•ï¼‰ åŠ å·¥å·¥è‰ºæ˜¯æš´éœ²çš„ å®ä¾‹ä¸€ä¸ªåœŸè±ªéœ€è¦å»ºä¸€ä¸ªåˆ«å¢…ï¼Œç„¶åç›´æ¥æ‰¾åŒ…å·¥å¤´ï¼ŒåŒ…å·¥å¤´å†æ‰¾å·¥äººæŠŠåˆ«å¢…å»ºå¥½ã€‚è¿™é‡ŒåœŸè±ªä¸ç”¨ç›´æ¥ä¸€ä¸ªä¸€ä¸ªå·¥äººçš„å»æ‰¾ã€‚åªéœ€åŒ…å·¥å¤´çŸ¥é“åœŸè±ªéœ€æ±‚ï¼Œç„¶åå»æ‰¾å·¥äººï¼Œå·¥äººå¹²æ´»ï¼ŒåœŸè±ªä¹Ÿä¸éœ€è¦çŸ¥é“æˆ¿å­å…·ä½“æ€ä¹ˆå»ºï¼Œæœ€åèƒ½æ‹¿åˆ°æˆ¿å°±å¯ä»¥äº†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344//1.äº§å‡ºä¸œè¥¿æ˜¯æˆ¿å­//2.åŒ…å·¥å¤´è°ƒç”¨å·¥äººè¿›è¡Œå¼€å·¥è€Œä¸”ä»–è¦å¾ˆæ¸…æ¥šå·¥äººä»¬å…·ä½“çš„æŸä¸€ä¸ªå¤§é¡¹//3.å·¥äººæ˜¯ç›–æˆ¿å­çš„ å·¥äººå¯ä»¥å»ºå¨æˆ¿ã€å§å®¤ã€å»ºå®¢å…//4.åŒ…å·¥å¤´åªæ˜¯ä¸€ä¸ªæ¥å£è€Œå·² ä»–ä¸å¹²æ´» ä»–åªå¯¹å¤–è¯´æˆ‘èƒ½å»ºæˆ¿å­function House() &#123; this.kitchen = \"\"; this.bedroom = \"\"; this.livingroom = \"\";&#125;function Contractor() &#123; this.construct = function(worker) &#123; worker.construct_kitchen(); worker.construct_bedroom(); worker.construct_livingroom(); &#125;&#125;function Worker() &#123; this.construct_kitchen =function() &#123; console.log(\"å¨æˆ¿å»ºå¥½äº†\"); &#125; this.construct_bedroom = function() &#123; console.log(\"å§å®¤å»ºå¥½äº†\"); &#125; this.construct_livingroom = function() &#123; console.log(\"å®¢å…å»ºå¥½äº†\"); &#125; this.submit = function() &#123; var _house = new House(); _house.kitchen = \"finished\"; _house.bedroom = \"finished\"; _house.livingroom = \"finished\"; return _house; &#125;&#125;;var worker = new Worker();var contractor = new Contractor();contractor.construct(worker);// ä¸»äººè¦æˆ¿å­var myhouse = worker.submit();console.log(myhouse); å·¥å‚æ¨¡å¼æ¦‚å¿µå·¥å‚æ¨¡å¼å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ç”±å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚è¯¥æ¨¡å¼ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°äº†å­ç±»ã€‚è€Œå­ç±»å¯ä»¥é‡å†™æ¥å£æ–¹æ³•ä»¥ä¾¿åˆ›å»ºçš„æ—¶å€™æŒ‡å®šè‡ªå·±çš„å¯¹è±¡ç±»å‹ï¼ˆæŠ½è±¡å·¥å‚ï¼‰ã€‚ ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š å¯¹è±¡æ„å»ºååˆ†å¤æ‚ éœ€è¦ä¾èµ–å…·ä½“çš„ç¯å¢ƒåˆ›å»ºä¸åŒçš„å®ä¾‹ å¤„ç†å¤§é‡å…·æœ‰ç›¸åŒå±æ€§çš„å°å¯¹è±¡ æ³¨æ„äº‹é¡¹ï¼š 1ã€ä¸èƒ½æ»¥ç”¨å·¥å‚ï¼Œæœ‰æ—¶å€™ä»…ä»…æ˜¯ç»™ä»£ç å¢åŠ å¤æ‚åº¦ å®ä¾‹ç®€å•å·¥å‚æ¨¡å¼12345678910111213141516var XMLHttpFactory = function() &#123;&#125;;XMLHttpFactory.createXMLHttp = function() &#123; var XMLHttp = null; // XMLHttpFactory.createXMLHttp()è¿™ä¸ªæ–¹æ³•æ ¹æ®å½“å‰ç¯å¢ƒçš„å…·ä½“æƒ…å†µè¿”å›ä¸€ä¸ªXHRå¯¹è±¡ if (window.XMLHttpRequest) &#123; XMLHttp = new XMLHttpRequest(); &#125; else if (window.ActiveXObject) &#123; XMLHttp = new ActiveXObject(\"Microsoft.XMLHTTP\") &#125; return XMLHttp;&#125;;var AjaxHander = function() &#123; var XMLHttp = XMLHttpFactory.createXMLHttp(); /*...å…·ä½“æ“ä½œ... */&#125; æŠ½è±¡å·¥å‚æ¨¡å¼12345678910111213141516171819202122232425262728var XMLHttpFactory = function() &#123;&#125;;XMLHttpFactory.prototype = &#123;// å¦‚æœçœŸçš„è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå®ƒä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½ç”¨æ¥æ´¾ç”Ÿå­ç±» createFactory:function() &#123; throw new Error(\"This is an abstract class\"); &#125;&#125;var XHRHandler = function() &#123; XMLHttpFactory.call(this);&#125;;XHRHandler.prototype = new XMLHttpFactory();XHRHandler.prototype.constructor = XHRHandler; // é‡æ–°å®šä¹‰ createFactory æ–¹æ³•XHRHandler.prototype.createFactory = function() &#123; var XMLHttp = null; if (window.XMLHttpRequest) &#123; XMLHttp = new XMLHttpRequest(); &#125; else if (window.ActiveXObject) &#123; XMLHttp = new ActiveXObject(\"Microsoft.XMLHTTP\") &#125; return XMLHttp;&#125;var AjaxHander = function() &#123; var XMLHttp = XMLHttpFactory.createXMLHttp(); /*...å…·ä½“æ“ä½œ... */&#125; æŠ½è±¡å·¥å‚åªç•™ä¸€ä¸ªæ¥å£ï¼Œä¸åšå…·ä½“çš„äº‹ï¼Œè®©åˆ«çš„å­ç±»æ¥ç»§æ‰¿æˆ‘è¿™ä¸ªç±»ï¼Œç„¶ååšå®ƒè‡ªå·±çš„äº‹ã€‚ ä»£ç†æ¨¡å¼æ¦‚å¿µä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ï¼Œä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†æ¨¡å¼ä½¿å¾—ä»£ç†å¯¹è±¡æ§åˆ¶å…·ä½“å¯¹è±¡çš„å¼•ç”¨ã€‚ä»£ç†å‡ ä¹å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼šæ–‡ä»¶ï¼Œèµ„æºï¼Œå†…å­˜ä¸­çš„å¯¹è±¡ï¼Œæˆ–è€…æ˜¯ä¸€äº›éš¾ä»¥å¤åˆ¶çš„ä¸œè¥¿ã€‚ ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š è¿œç¨‹ä»£ç†ï¼ˆä¸€ä¸ªå¯¹è±¡å°†ä¸åŒç©ºé—´çš„å¯¹è±¡è¿›è¡Œå±€éƒ¨ä»£ç†ï¼‰ è™šæ‹Ÿä»£ç†ï¼ˆæ ¹æ®éœ€è¦åˆ›å»ºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå¦‚å›¾ç‰‡é¢„åŠ è½½ï¼‰ å®‰å…¨ä»£ç†ï¼ˆæ§åˆ¶çœŸå®å¯¹è±¡çš„è®¿é—®æƒé™ï¼‰ æ™ºèƒ½æŒ‡å¼•ï¼ˆè°ƒç”¨å¯¹è±¡ä»£ç†å¤„ç†å¦å¤–ä¸€äº›äº‹æƒ…ï¼Œå¦‚åƒåœ¾å›æ”¶æœºåˆ¶ï¼‰ æ³¨æ„äº‹é¡¹ï¼š ä¸èƒ½æ»¥ç”¨ä»£ç†ï¼Œæœ‰æ—¶å€™ä»…ä»…æ˜¯ç»™ä»£ç å¢åŠ å¤æ‚åº¦ å®ä¾‹12345678910111213141516171819202122// ä»£ç†æ¨¡å¼éœ€è¦ä¸‰æ–¹// 1.ä¹°å®¶function buyer() &#123; this.name = \"Davis\";&#125;// 2.ä¸­ä»‹function agent() &#123;&#125;agent.prototype.sell = function() &#123; new seller(new buyer()).sell(\"50ä¸‡\")&#125;// 3.å–å®¶ æ”¶é’±function seller(buyer) &#123; this.buyer_name = buyer.name; this.sell = function(money) &#123; console.log(\"æ”¶åˆ°äº†æ¥è‡ª\" + this.buyer_name + money + \"äººæ°‘å¸\"); // æ”¶åˆ°äº†æ¥è‡ªDavis50ä¸‡äººæ°‘å¸ &#125;&#125;(new agent).sell(); è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡é¢„åŠ è½½12345678910111213141516171819202122232425262728293031// å›¾ç‰‡åŠ è½½å‡½æ•°var myImage = (function() &#123; var imgNode = document.createElement(\"img\"); document.body.appendChild(imgNode); return &#123; // æä¾›ä¸€ä¸ªå¯¹å¤–çš„setSrcæ¥å£ï¼Œå¤–ç•Œè°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå¯ä»¥ç»™è¯¥imgæ ‡ç­¾è®¾ç½®srcå±æ€§ setSrc: function(src) &#123; imgNode.src = src; &#125; &#125;&#125;)();// å¼•å…¥ä»£ç†å¯¹è±¡var proxyImage = (function() &#123; var img = new Image; img.onload = function() &#123; // å›¾ç‰‡åŠ è½½å®Œæˆï¼Œæ­£å¼åŠ è½½å›¾ç‰‡ myImage.setSrc(this.src); &#125;; return &#123; setSrc: function(src) &#123; // å›¾ç‰‡æœªè¢«è½½å…¥æ—¶ï¼ŒåŠ è½½ä¸€å¼ æç¤ºå›¾ç‰‡ myImage.setSrc(\"file://c:/loading.png\"); img.src = src; &#125; &#125;&#125;)();// è°ƒç”¨ä»£ç†å¯¹è±¡åŠ è½½å›¾ç‰‡proxyImage.setSrc(\"http://images/water.jpg\"); å‘½ä»¤æ¨¡å¼æ¦‚å¿µå°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œåˆ†ç¦»å‘½ä»¤æ¥å—è€…å’Œå‘èµ·è€…ä¹‹é—´çš„è€¦åˆã€‚å‘½ä»¤æ‰§è¡Œä¹‹å‰åœ¨æ‰§è¡Œå¯¹è±¡ä¸­ä¼ å…¥æ¥å—è€…ï¼Œä¸»è¦ç›®çš„ç›¸äº’ä¹‹é—´çš„è§£è€¦ã€‚ç®€å•è€Œè¨€åˆ†ä¸ºä¸‰ä¸ªå¯¹è±¡ï¼š å‘èµ·è€…ï¼šå‘å‡ºè°ƒç”¨å‘½ä»¤å³å¯ï¼Œå…·ä½“å¦‚ä½•æ‰§è¡Œï¼Œè°æ‰§è¡Œå¹¶ä¸éœ€è¦æ¸…æ¥šã€‚ æ¥å—è€…ï¼šæœ‰å¯¹åº”çš„æ¥å£å¤„ç†ä¸åŒçš„å‘½ä»¤ï¼Œè‡³äºå‘½ä»¤æ˜¯ä»€ä¹ˆï¼Œè°å‘å‡ºçš„ï¼Œä¸ç”¨å…³å¿ƒã€‚ å‘½ä»¤å¯¹è±¡ï¼šä¸Šé¢è®²å‘èµ·è€…å’Œæ¥å—è€…åˆ†å¼€äº†ï¼ŒäºŒè€…ä¹‹é—´éœ€è¦ä¸ªè¿æ¥æ¡¥æ¢ã€‚è¿™å°±æ˜¯å‘½ä»¤å¯¹è±¡ã€‚å‘½ä»¤å¯¹è±¡æ¥å—å‘é€è€…çš„è°ƒç”¨ï¼Œç„¶åè°ƒç”¨æ¥å—è€…çš„ç›¸åº”æ¥å£ã€‚ ä½œç”¨å’Œæ³¨æ„äº‹é¡¹æ¨¡å¼ä½œç”¨ï¼š å°†å‡½æ•°çš„å°è£…ã€è¯·æ±‚ã€è°ƒç”¨ç»“åˆä¸ºä¸€ä½“ è°ƒç”¨å…·ä½“çš„å‡½æ•°è§£è€¦å‘½ä»¤å¯¹è±¡ä¸æ¥æ”¶å¯¹è±¡ æé«˜ç¨‹åºæ¨¡å—åŒ–çš„çµæ´»æ€§ æ³¨æ„äº‹é¡¹ï¼š ä¸éœ€è¦å€Ÿå£ä¸€è‡´ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°å³å¯ï¼Œä»¥å…é€ æˆæµªè´¹ å®ä¾‹åœºæ™¯å¦‚ä¸‹ï¼šæœ‰ä¸ªæŒ‰é’®buttonï¼Œç‚¹å‡»ä¹‹åï¼Œè°ƒç”¨menuå¯¹è±¡çš„refreshæ–¹æ³•ï¼Œè¾“å‡ºâ€œåˆ·æ–°â€çš„å†…å®¹ã€‚ 12345678910111213141516171819202122232425262728// å‘é€è€…var setCommond = function(button, fn) &#123; button.onClick = function() &#123; fn() &#125;&#125;;// æ‰§è¡Œå‘½ä»¤è€…var menu = &#123; reFresh: function() &#123; console.log(\"åˆ·æ–°\"); &#125;, add: function() &#123; console.log(\"å¢åŠ \"); &#125;, delete: function() &#123; console.log(\"åˆ é™¤\"); &#125;&#125;;// å‘½ä»¤å¯¹è±¡var commondObj = function(reciver) &#123; return function() &#123; reciver.reFresh(); &#125;&#125;;var commondObj1 = commondObj(menu);setCommond(btn1, commondObj1); å‘é€è€…(setCommond)ï¼šä¸å…³å¿ƒç»™å“ªä¸ªbuttonï¼Œä»¥åŠç»‘å®šä»€ä¹ˆäº‹ä»¶ï¼Œåªè¦é€šè¿‡å‚æ•°ä¼ å…¥å°±å¥½ã€‚ å‘½ä»¤å¯¹è±¡(commondObj):åªéœ€è¦æ¥æ”¶åˆ°æ¥å—è€…çš„å‚æ•°ï¼Œå½“å‘é€è€…å‘å‡ºå‘½ä»¤æ—¶ï¼Œæ‰§è¡Œå°±å¥½ã€‚ æ¥å—è€…(menu):ä¸ç”¨å…³å¿ƒåœ¨å“ªé‡Œè¢«è°ƒç”¨è¢«è°è°ƒç”¨ï¼Œåªéœ€è¦æŒ‰éœ€æ‰§è¡Œå°±å¥½äº†ã€‚ ç­–ç•¥æ¨¡å¼æ¦‚å¿µå®šä¹‰ä¸€ç³»åˆ—æ–¹æ³•ï¼Œå°è£…èµ·æ¥ä½¿ä»–ä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ä¹Ÿå°±æ˜¯å°†ç­–ç•¥å°è£…åœ¨ç­–ç•¥ç±»ä¸­ï¼Œå½“å‘èµ·è¯·æ±‚æ—¶ç®¡ç†ç±»å°†è¯·æ±‚å§”æ‰˜ç»™å¯¹åº”ç­–ç•¥ç±»ã€‚ å‘èµ·è€…ï¼šå‘å‡ºè°ƒç”¨å‘½ä»¤å³å¯ï¼Œå…·ä½“å¦‚ä½•æ‰§è¡Œï¼Œè°æ‰§è¡Œå¹¶ä¸éœ€è¦æ¸…æ¥šã€‚ æ¥å—è€…ï¼šæœ‰å¯¹åº”çš„æ¥å£å¤„ç†ä¸åŒçš„å‘½ä»¤ï¼Œè‡³äºå‘½ä»¤æ˜¯ä»€ä¹ˆï¼Œè°å‘å‡ºçš„ï¼Œä¸ç”¨å…³å¿ƒã€‚ å‘½ä»¤å¯¹è±¡ï¼šä¸Šé¢è®²å‘èµ·è€…å’Œæ¥å—è€…åˆ†å¼€äº†ï¼ŒäºŒè€…ä¹‹é—´éœ€è¦ä¸ªè¿æ¥æ¡¥æ¢ã€‚è¿™å°±æ˜¯å‘½ä»¤å¯¹è±¡ã€‚å‘½ä»¤å¯¹è±¡æ¥å—å‘é€è€…çš„è°ƒç”¨ï¼Œç„¶åè°ƒç”¨æ¥å—è€…çš„ç›¸åº”æ¥å£ã€‚ ä½œç”¨æ¨¡å¼ä½œç”¨ï¼š ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆï¼Œå§”æ‰˜ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œæœ‰æ•ˆçš„é¿å…å¾ˆå¤šifæ¡ä»¶è¯­å¥ã€‚ ç­–ç•¥æ¨¡å¼æä¾›äº†å¼€æ”¾-å°é—­åŸåˆ™ï¼Œä½¿ä»£ç æ›´å®¹æ˜“ç†è§£å’Œæ‰©å±•ã€‚ ç­–ç•¥æ¨¡å¼ä¸­çš„ä»£ç å¯ä»¥å¤ç”¨ã€‚ å®ä¾‹å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šéœ€è¦æ ¹æ®formè¡¨å•å…ƒç´ çš„ä¸åŒç±»å‹ï¼Œå½“ç‚¹å‡»çš„æ—¶å€™è¾“å‡ºå¯¹åº”çš„è¡¨å•å…ƒç´ ç±»å‹ã€‚ 123456789101112131415161718192021222324252627 /** * é’ˆå¯¹ä¸åŒæƒ…å†µçš„ç­–ç•¥ç®—æ³•å°è£…åœ¨ç­–ç•¥ç±»fucsä¸­ï¼Œ * ä»è°ƒç”¨äº‹ä»¶ä¸­å»é™¤ç¹ççš„ifæˆ–è€…switché€»è¾‘åˆ¤æ–­ã€‚è¾¾åˆ°è§£è€¦çš„ç›®çš„ * åŠ å…¥åé¢å†å¢åŠ â€˜selectâ€™çš„é€‰é¡¹å¢åŠ å¯¹åº”çš„æ–¹æ³•å³å¯ */ var funcs = &#123; text: function() &#123; console.log('this is text') &#125;, radio: function() &#123; console.log('this is radio') &#125;, checkbox: function() &#123; console.log('this is checkbox') &#125;, default: function() &#123; console.log('this is default') &#125; &#125; var renderDom = function(type) &#123; /** * åªéœ€è¦æ ¹æ®ä¸åŒçš„å…¥å‚ï¼Œè‡ªè¡ŒåŒ¹é…ç­–ç•¥ç±»ä¸­çš„æ¥å£å³å¯ã€‚ */ return (funcs[type] || funcs['default'])() &#125;renderDom('checkbox') ç­–ç•¥å¯¹è±¡å°±æ˜¯funcså¯¹è±¡ï¼Œé‡Œé¢çš„ä¸åŒå±æ€§æ¥å£å¯¹åº”çš„æ–¹æ³•å°±æ˜¯ç­–ç•¥ã€‚ä¸é€»è¾‘åˆ¤æ–­åˆ†ç¦»å¼€ï¼Œå¦‚æœæœ‰ä¸åŒçš„æƒ…å†µçš„å‡ºç°ï¼Œå¯¹åº”çš„å¢åŠ å±æ€§æ¥å£å³å¯ã€‚ renderDomæ–¹æ³•å°±æ˜¯å¯¹åº”çš„ç®¡ç†ç±»ï¼Œåªéœ€è¦æ ¹æ®ä¸åŒçš„typeï¼Œå»è°ƒç”¨funcsä¸åŒçš„æ–¹æ³•å°±okäº†ã€‚å¦‚æœtypeæ²¡æœ‰å¯¹åº”çš„æ¥å£ï¼Œé‚£å°±è°ƒç”¨é»˜è®¤çš„defaultå¯¹åº”æ¥å£ã€‚ è°ƒç”¨äº‹ä»¶ï¼Œå°±ä¿æŒä¸å˜ã€‚å°†tyoeç±»å‹ä¼ è¿‡å»å°±å¥½äº†ã€‚ èŒè´£é“¾æ¨¡å¼æ¦‚å¿µèŒè´£é“¾ç”±å¤šä¸ªä¸åŒçš„å¯¹è±¡ç»„æˆï¼Œå‘é€è€…æ˜¯å‘é€è¯·æ±‚çš„å¯¹è±¡ï¼Œè€Œæ¥æ”¶è€…åˆ™æ˜¯é“¾ä¸­é‚£äº›æ¥æ”¶è¯·æ±‚å¹¶ä¸”å¯¹å…¶è¿›è¡Œå¤„ç†æˆ–ä¼ é€’çš„å¯¹è±¡ã€‚è¯·æ±‚æœ¬èº«æœ‰æ—¶å€™ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå°è£…äº†å’Œæ“ä½œæœ‰å…³çš„æ‰€æœ‰æ•°æ®ï¼ŒåŸºæœ¬å®ç°æµç¨‹å¦‚ä¸‹ï¼š å‘é€è€…çŸ¥é“é“¾ä¸­çš„ç¬¬ä¸€ä¸ªæ¥æ”¶è€…ï¼Œå®ƒå‘è¿™ä¸ªæ¥æ”¶è€…å‘é€è¯¥è¯·æ±‚ã€‚ æ¯ä¸€ä¸ªæ¥æ”¶è€…éƒ½å¯¹è¯·æ±‚è¿›è¡Œåˆ†æï¼Œç„¶åè¦ä¹ˆå¤„ç†å®ƒï¼Œè¦ä¹ˆå®ƒå¾€ä¸‹ä¼ é€’ã€‚ æ¯ä¸€ä¸ªæ¥æ”¶è€…çŸ¥é“å…¶ä»–çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œå³å®ƒåœ¨é“¾ä¸­çš„ä¸‹å®¶(successor)ã€‚ å¦‚æœæ²¡æœ‰ä»»ä½•æ¥æ”¶è€…å¤„ç†è¯·æ±‚ï¼Œé‚£ä¹ˆè¯·æ±‚ä¼šä»é“¾ä¸­ç¦»å¼€ã€‚ å®ä¾‹ç°æœ‰Aã€Bã€Cã€Då››ä¸ªç”Ÿäº§çº¿ï¼Œç”Ÿäº§æ€»é‡ä¸º2100ï¼Œæ¯ä¸ªç”Ÿäº§çº¿çš„ç”Ÿäº§é‡æœªçŸ¥ä¸”åœ¨0~2100(åŒ…æ‹¬0å’Œ2100ï¼Œä¿è¯æ€»é‡ä¸º2100å³å¯)ï¼Œç”Ÿäº§å®Œæ¯•åï¼Œåˆ†6æ¬¡è¿›è¡Œè¿è¾“ï¼Œè§„å®šæ¯å°è½¦è¾†åªèƒ½è¿350ï¼Œä¸”è£…æ»¡åæ‰èƒ½å¤Ÿå‡ºå‘ï¼Œè£…è½¦é¡ºåºä¸ºABCD,å³ä¸Šä¸€ä¸ªç”Ÿäº§çº¿ç”Ÿäº§çš„ä¸œè¥¿è£…å®Œåæ‰èƒ½å¤Ÿè£…ä¸‹ä¸€ä¸ªç”Ÿäº§çº¿çš„ä¸œè¥¿ï¼Œè¦æ±‚æ ¹æ®æ¯æ¡ç”Ÿäº§çº¿çš„ç”Ÿäº§é‡ï¼Œç»™å‡ºæ¯å°è½¦è¾†çš„æ‰˜è¿å®‰æ’ã€‚ ä¾‹å¦‚ï¼š Aï¼š100 ï¼Œ Bï¼š1400 ï¼ŒCï¼š500 ï¼Œ Dï¼š100æ‰˜è¿å®‰æ’ï¼šç¬¬ä¸€è¾†è½¦ï¼š Aï¼š100 ï¼Œ Bï¼š250ç¬¬äºŒè¾†è½¦ï¼š Aï¼š0 ï¼Œ Bï¼š350ç¬¬ä¸‰è¾†è½¦ï¼š Aï¼š0 ï¼Œ Bï¼š350ç¬¬å››è¾†è½¦ï¼š Aï¼š0 ï¼Œ Bï¼š350ç¬¬äº”è¾†è½¦ï¼š Aï¼š0 ï¼Œ Bï¼š100 ï¼ŒCï¼š250ç¬¬å…­è¾†è½¦ï¼š Aï¼š0 ï¼Œ Bï¼š0 ï¼Œ Cï¼š250 ï¼ŒDï¼š100 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960class WearHouse&#123; constructor(volume,wearHouse)&#123; this.volume=volume; this.wearHouse=wearHouse; this.outString=[]; &#125; next(take)&#123; if(this.wearHouse!=undefined) &#123; this.wearHouse.takeOut(take).forEach((subT) =&gt; &#123; this.outString.push(subT) &#125;) &#125; &#125; takeOut(num)&#123; if(num&gt;this.volume)&#123; num-=this.volume; var temp=this.volume; this.volume=0; this.outString.push(this.print(0,temp)); this.next(num); &#125;else&#123; this.volume-=num; this.outString.push(this.print(this.volume,num)); &#125; var temOut=this.outString; this.outString=[]; return temOut; &#125; print(volumn,takeNum)&#123;&#125; &#125; class WearHouseA extends WearHouse&#123; print(volumn,takeNum)&#123; return ['A',takeNum]; &#125; &#125; class WearHouseB extends WearHouse&#123; print(volumn,takeNum)&#123; return ['B',takeNum]; &#125; &#125; class WearHouseC extends WearHouse&#123; print(volumn,takeNum)&#123; return ['C',takeNum]; &#125; &#125; class WearHouseD extends WearHouse&#123; print(volumn,takeNum)&#123; return ['D',takeNum]; &#125; &#125; var D=new WearHouseD(100,undefined); var C=new WearHouseC(500,D); var B=new WearHouseB(1400,C); var A=new WearHouseA(100,B); var strSet=[]; for(var a=0;a&lt;6;a++)&#123; strSet.push(...A.takeOut(350)); &#125; console.log(strSet); ç»“æŸè¯­ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„æ˜¯ä¸ºäº†æé«˜æˆ‘ä»¬è§£å†³é—®é¢˜çš„æ•ˆç‡ï¼Œä¸åŒçš„è®¾è®¡æ¨¡å¼ä¹Ÿæ˜¯é’ˆå¯¹ä¸åŒç¯å¢ƒçš„ç‰¹å®šæ–¹æ¡ˆï¼Œä¸ä»…ä»…æ˜¯å•ç‹¬çš„æŸä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯å¤šä¸ªæ¨¡å¼å…±å­˜çš„ã€‚åˆ‡å‹¿ä¸ºäº†ä½¿ç”¨è®¾è®¡æ¨¡å¼è€Œå¼ºè¡Œå¼•å…¥ï¼Œå¢åŠ ä»£ç å¤æ‚åº¦ã€‚ å­¦ä¹ èµ„æºï¼šé“¾æ¥ï¼šhttp://pan.baidu.com/s/1i5BYiGH å¯†ç ï¼š3s4v","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://pengfeidai.github.io/tags/Javascript/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://pengfeidai.github.io/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"cubic-bezier(è´å¡å°”æ›²çº¿)","slug":"cubic-bezier","date":"2017-08-05T08:58:46.000Z","updated":"2020-05-22T12:14:57.000Z","comments":true,"path":"2017/08/05/cubic-bezier/","link":"","permalink":"https://pengfeidai.github.io/2017/08/05/cubic-bezier/","excerpt":"","text":"ç®€ä»‹cubic-bezier åˆç§°ä¸‰æ¬¡è´å¡å°”ï¼Œä¸»è¦æ˜¯ä¸º animation ç”Ÿæˆé€Ÿåº¦æ›²çº¿çš„å‡½æ•°, CSS3 åŠ¨ç”»é€Ÿåº¦çš„æ§åˆ¶é€šè¿‡ä¸‰æ¬¡è´å¡å°”æ›²çº¿å‡½æ•°å®ç°ï¼Œå®šä¹‰è§„åˆ™ä¸ºï¼š cubic-bezier (x1, y1, x2, y2)ã€‚ cubic-bezierï¼šhttp://cubic-bezier.com/ css3ä¸­å¸¸ç”¨çš„å‡ ä¸ªåŠ¨ç”»æ•ˆæœï¼š 12345ease: cubic-bezier(0.25, 0.1, 0.25, 1.0) // å¼€å§‹å’Œç»“æŸæ…¢ï¼Œä¸­é—´å¿«linear: cubic-bezier(0.0, 0.0, 1.0, 1.0) // åŒ€é€Ÿease-in: cubic-bezier(0.42, 0, 1.0, 1.0) // å¼€å§‹æ…¢ease-out: cubic-bezier(0, 0, 0.58, 1.0) // ç»“é€Ÿæ…¢ease-in-out: cubic-bezier(0.42, 0, 0.58, 1.0) // ä¸easeç±»ä¼¼ï¼Œä½†æ¯”easeå¹…åº¦å¤§ åŸºæœ¬åŸç†è´å¡å°”æ›²çº¿é€šè¿‡æ§åˆ¶æ›²çº¿ä¸Šçš„å››ä¸ªç‚¹ï¼ˆèµ·å§‹ç‚¹ã€ç»ˆæ­¢ç‚¹ä»¥åŠä¸¤ä¸ªç›¸äº’åˆ†ç¦»çš„ä¸­é—´ç‚¹ï¼‰æ¥åˆ›é€ ã€ç¼–è¾‘å›¾å½¢ï¼Œç»˜åˆ¶å‡ºä¸€æ¡å…‰æ»‘æ›²çº¿å¹¶ä»¥æ›²çº¿çš„çŠ¶æ€æ¥åæ˜ åŠ¨ç”»è¿‡ç¨‹ä¸­é€Ÿåº¦çš„å˜åŒ–ã€‚ image ä»ä¸Šå›¾æˆ‘ä»¬çŸ¥é“çš„æ˜¯ cubic-bezier çš„å–å€¼èŒƒå›´: Aï¼šé»˜è®¤å€¼ (0, 0) Bï¼šåŠ¨æ€å–å€¼ (x1, y1) Cï¼šåŠ¨æ€å–å€¼ (x2, y2) Dï¼šé»˜è®¤å€¼ (1, 1) å…¶ä¸­ X è½´çš„å–å€¼èŒƒå›´æ˜¯ [0, 1]ï¼Œå½“å–å€¼è¶…å‡ºèŒƒå›´æ—¶ cubic-bezier å°†å¤±æ•ˆï¼›Y è½´çš„å–å€¼æ²¡æœ‰è§„å®šï¼Œå½“ç„¶ä¹Ÿæ¯‹é¡»è¶…è¿‡ [0, 1] è¿‡å¤§ã€‚ æˆ‘ä»¬éœ€è¦å…³æ³¨çš„æ˜¯ B å’Œ C ä¸¤ç‚¹çš„å–å€¼ï¼Œè¿™ä¸¤ç‚¹å°±æ˜¯æ‰€è¦åŠ¨æ€æ“æ§çš„ä¸¤ä¸ªç‚¹äº†,å¯¹åº”cubic-bezier (x1,y1,x2,y2)ä¸­çš„å››ä¸ªå‚æ•°ã€‚ å®ä¾‹æ¼”ç¤ºä¸‹é¢ç”¨ä¸€ä¸ªç®€å•çš„å®ä¾‹æ¥çœ‹çœ‹æ•ˆæœï¼šdemoæ¼”ç¤º html éƒ¨åˆ†12&lt;div class=\"normal\"&gt;&lt;/div&gt;&lt;div class=\"custom\"&gt;&lt;/div&gt; css123456789101112131415161718192021222324252627282930313233.normal &#123; margin-bottom: 10px; width: 50px; height: 50px; background-color: #ff0000; border-radius: 50%; -webkit-transition: all 2s; -moz-transition: all 2s; -o-transition: all 2s; transition: all 2s;&#125;.normal:hover &#123; -webkit-transform: translateX(150px); -moz-transform: translateX(150px); -o-transform: translateX(150px); transform: translateX(150px);&#125;.custom &#123; width: 50px; height: 50px; border-radius: 50%; background-color: blue; -webkit-transition: all 2s cubic-bezier(.94,-0.25,.32,1.31); -moz-transition: all 2s cubic-bezier(.94,-0.25,.32,1.31); -o-transition: all 2s cubic-bezier(.94,-0.25,.32,1.31); transition: all 2s cubic-bezier(.94,-0.25,.32,1.31);&#125;.custom:hover &#123; -webkit-transform: translateX(300px); -moz-transform: translateX(300px); -o-transform: translateX(300px); transform: translateX(300px);&#125; çº¢è‰²å°çƒé‡‡ç”¨é»˜è®¤çš„é€Ÿåº¦æ›²çº¿æ˜¯ easeï¼Œè“è‰²å°çƒé‡‡ç”¨è‡ªå®šä¹‰cubic-bezier(.94,-0.25,.32,1.31),å‘ˆç°è“„åŠ›åŠ é€Ÿæ•ˆæœã€‚ transitionï¼ˆè¿‡æ¸¡ï¼‰transitionå±æ€§ transition-property: è¿‡æ¸¡å±æ€§(é»˜è®¤å€¼ä¸ºall) transition-duration: è¿‡æ¸¡æŒç»­æ—¶é—´(é»˜è®¤å€¼ä¸º0s) transiton-timing-function: è¿‡æ¸¡å‡½æ•°(é»˜è®¤å€¼ä¸ºeaseå‡½æ•°) transition-delay: è¿‡æ¸¡å»¶è¿Ÿæ—¶é—´(é»˜è®¤å€¼ä¸º0s) è¯­æ³•1transition: property duration timing-function delay; animationï¼ˆåŠ¨ç”»ï¼‰animationå±æ€§ç»“åˆ@ keyframesä½¿ç”¨ï¼Œanimationä¸­çš„animation-nameéœ€è¦è®¾ç½®æˆ@ keyframesçš„nameä¸€è‡´ã€‚ä¾‹å¦‚ï¼š 12345678910111213141516171819202122232425262728293031&lt;style&gt;.box &#123; height: 100px; width: 100px; border: 15px solid black; animation: changebox 10s ease-in-out 3 alternate paused;&#125;.box:hover &#123; animation-play-state: running;&#125;@keyframes changebox &#123; 10% &#123; background: red; &#125; 50% &#123; width: 80px; &#125; 70% &#123; border: 15px solid yellow; &#125; 100% &#123; width: 180px; height: 180px; &#125;&#125;&lt;/style&gt;&lt;body&gt; &lt;div class=\"box\"&gt;&lt;/div&gt;&lt;/body&gt; animationå±æ€§ animation-name: æŒ‡å®šè¦ç»‘å®šåˆ°é€‰æ‹©å™¨çš„å…³é”®å¸§çš„åç§° animation-duration: åŠ¨ç”»æŒ‡å®šéœ€è¦å¤šå°‘ç§’æˆ–æ¯«ç§’å®Œæˆ animation-timing-function: è®¾ç½®åŠ¨ç”»å°†å¦‚ä½•å®Œæˆä¸€ä¸ªå‘¨æœŸ animation-delay: è®¾ç½®åŠ¨ç”»åœ¨å¯åŠ¨å‰çš„å»¶è¿Ÿé—´éš” animation-iteration-count: å®šä¹‰åŠ¨ç”»çš„æ’­æ”¾æ¬¡æ•° animation-direction: æŒ‡å®šæ˜¯å¦åº”è¯¥è½®æµåå‘æ’­æ”¾åŠ¨ç”» animation-fill-mode:è§„å®šå½“åŠ¨ç”»ä¸æ’­æ”¾æ—¶ï¼ˆå½“åŠ¨ç”»å®Œæˆæ—¶ï¼Œæˆ–å½“åŠ¨ç”»æœ‰ä¸€ä¸ªå»¶è¿Ÿæœªå¼€å§‹æ’­æ”¾æ—¶ï¼‰ï¼Œè¦åº”ç”¨åˆ°å…ƒç´ çš„æ ·å¼ animation-play-state: æŒ‡å®šåŠ¨ç”»æ˜¯å¦æ­£åœ¨è¿è¡Œæˆ–å·²æš‚åœã€‚è¯­æ³• 1animation: name duration timing-function delay iteration-count direction fill-mode play-state; transformï¼ˆå˜å½¢ï¼‰transform åˆ†ä¸º2D å’Œ 3Dï¼Œå…¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§å˜æ¢ï¼štranslateä½ç§»ï¼Œscaleç¼©æ”¾ï¼Œrotateæ—‹è½¬ï¼Œskewæ‰­æ›²ç­‰ã€‚ 2Då˜å½¢ï¼š translateä½ç§»123transform: translate(50px, 100px);transform: translateX(50px); // xæ–¹å‘ç§»åŠ¨50pxtransform: translateY(100px); scaleç¼©æ”¾123transform: scale(2, .5);transform: scaleX(2); // xæ–¹å‘å¢åŠ ä¸€å€transform: scaleY(.5); // yæ–¹å‘ç¼©å°ä¸€å€ rotateæ—‹è½¬ï¼šrotateï¼ˆæ­£æ•°è¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬ï¼Œè´Ÿæ•°è¡¨ç¤ºé€†æ—¶é’ˆæ—‹è½¬ï¼‰1transform: rotate(30deg); skewæ‰­æ›²123transform: skew(30deg, 30deg);transform: skewX(30deg);transform: skewY(30deg); 3Då˜å½¢ï¼š translateä½ç§»ï¼š translate(x, y, z); scaleç¼©æ”¾ï¼š scale(x, y, z); rotateæ—‹è½¬ï¼šrotate3d(x, y, z, angle) (angle:è¡¨ç¤º3Dèˆå°ä¸Šæ—‹è½¬çš„è§’åº¦)","categories":[],"tags":[{"name":"CSS3","slug":"CSS3","permalink":"https://pengfeidai.github.io/tags/CSS3/"}]},{"title":"æ·±å…¥ç†è§£Javascripté¢å‘å¯¹è±¡","slug":"JSé¢å‘å¯¹è±¡ç¼–ç¨‹","date":"2017-07-28T06:52:56.000Z","updated":"2017-08-21T02:54:00.000Z","comments":true,"path":"2017/07/28/JSé¢å‘å¯¹è±¡ç¼–ç¨‹/","link":"","permalink":"https://pengfeidai.github.io/2017/07/28/JSé¢å‘å¯¹è±¡ç¼–ç¨‹/","excerpt":"","text":"ç®€ä»‹JavaScript æ˜¯ä¸€é—¨åŸºäºå¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨ JavaScript ä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼ŒåŒ…æ‹¬å‡½æ•°ï¼Œä¹Ÿæ˜¯è¢«å½“æˆç¬¬ä¸€ç­‰çš„å¯¹è±¡å¯¹å¾…ï¼Œè¿™æ­£æ˜¯ JavaScript æå…¶å¯Œæœ‰è¡¨ç°åŠ›çš„åŸå› ã€‚ ç†è§£å¯¹è±¡ECMA-262 å…³äºå¯¹è±¡çš„å®šä¹‰æ˜¯ï¼šâ€œæ— åºå±æ€§çš„é›†åˆï¼Œå…¶å±æ€§å¯ä»¥åŒ…å«åŸºæœ¬å€¼ã€å¯¹è±¡æˆ–è€…å‡½æ•°ã€‚â€ ä¸¥æ ¼è¯´ï¼Œå¯¹è±¡æ˜¯ä¸€ç»„æ²¡æœ‰ç‰¹å®šé¡ºåºçš„å€¼ã€‚å¯¹è±¡çš„æ¯ä¸ªå±æ€§æˆ–æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œè€Œæ¯ä¸ªåå­—éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚ æ—©æœŸï¼Œåˆ›å»ºå¯¹è±¡å°±æ˜¯åˆ›å»ºä¸€ä¸ª Objectçš„å®ä¾‹ï¼Œå¹¶ä¸ºå®ƒæ·»åŠ å±æ€§( nameã€age )å’Œæ–¹æ³•( sayName() )ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š 123456var person = new Object();person.name = \"Davis\";person.age = 22;person.sayName = function () &#123; alert(this.name);&#125; ç°åœ¨ï¼Œå¯¹è±¡å­—é¢é‡æˆä¸ºåˆ›å»ºå¯¹è±¡çš„é¦–é€‰æ¨¡å¼ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š 12345678var person = &#123; name = \"Davis\", age: 22, sayName: function () &#123; alert(this.name); &#125;&#125;; è¿™ä¸¤ä¸ªä¾‹å­ä¸­ person å¯¹è±¡äº‹ä¸€æ ·çš„ï¼Œæœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™äº›å±æ€§åœ¨åˆ›å»ºæ—¶éƒ½æœ‰ä¸€äº›ç‰¹å¾å€¼(characteristic),JavaScript é€šè¿‡è¿™äº›ç‰¹å¾å€¼æ¥å®šä¹‰ä»–ä»¬çš„è¡Œä¸ºã€‚ å±æ€§ç±»å‹ECMAScript ä¸­æœ‰ä¸¤ç§å±æ€§ï¼šæ•°æ®å±æ€§å’Œè®¿é—®å™¨å±æ€§ã€‚ æ•°æ®å±æ€§æ•°æ®å±æ€§åŒ…å«ä¸€ä¸ªæ•°æ®å€¼çš„ä½ç½®ï¼Œåœ¨è¿™ä¸ªä½ç½®å¯ä»¥è¯»å–å’Œå†™å…¥å€¼ï¼Œå…·æœ‰å¦‚ä¸‹4ä¸ªç‰¹æ€§ï¼š [[Configurable]]: è¡¨ç¤ºèƒ½å¦é€šè¿‡deleteåˆ é™¤å±æ€§ä»è€Œé‡æ–°å®šä¹‰å±æ€§ï¼Œèƒ½å¦ä¿®æ”¹å±æ€§çš„ç‰¹æ€§ï¼Œèƒ½å¦æŠŠå±æ€§ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ã€‚ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œé»˜è®¤ä¸º trueã€‚[[Enumerable]]: è¡¨ç¤ºèƒ½å¦é€šè¿‡for-inå¾ªç¯è¿”å›å±æ€§ã€‚ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œé»˜è®¤ä¸ºtrueã€‚[[Writable]]: è¡¨ç¤ºèƒ½å¦ä¿®æ”¹å±æ€§çš„å€¼ã€‚ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œé»˜è®¤ä¸ºtrueã€‚[[Value]]: åŒ…å«è¿™ä¸ªå±æ€§çš„æ•°æ®å€¼ï¼›è¯»å–å±æ€§å€¼çš„æ—¶å€™ï¼Œä»è¿™ä¸ªä½ç½®è¯»å–ï¼›å†™å…¥å±æ€§å€¼çš„æ—¶å€™ï¼ŒæŠŠå€¼ä¿å­˜åœ¨è¿™é‡Œã€‚è¿™ä¸ªç‰¹æ€§é»˜è®¤ä¸ºundefined è¦ä¿®æ”¹æ•°æ®å±æ€§é»˜è®¤çš„ç‰¹æ€§ï¼Œå¿…é¡»ä½¿ç”¨ECMAScript5ä¸­çš„Object.defineProperty()æ–¹æ³•ï¼›æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡ã€å±æ€§çš„åå­—ã€æè¿°ç¬¦å¯¹è±¡ï¼›å…¶ä¸­ï¼Œæ•°æ®å±æ€§æè¿°ç¬¦å¯¹è±¡çš„å±æ€§å¿…é¡»æ˜¯ï¼šconfigurableã€enumerableã€writableå’Œvalueã€‚12345678var person = &#123;&#125;;Object.defineProperty(person, &quot;name&quot;, &#123; writable: false, value: &quot;Davis&quot;&#125;);alert(person.name); //&quot;Davis&quot;person.name = &quot;XX&quot;;alert(person.name); //&quot;Davis&quot; è®¿é—®å™¨å±æ€§è®¿é—®å™¨å±æ€§åŒ…å«ä¸€å¯¹ getter å’Œ setter å‡½æ•°ã€‚åœ¨è¯»å–è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨ getter å‡½æ•°ï¼Œè´Ÿè´£è¿”å›æœ‰æ•ˆçš„å€¼ï¼›åœ¨å†™å…¥æ—¶ï¼Œä¼šè°ƒç”¨ setter å‡½æ•°å¹¶ä¼ å…¥æ–°å€¼,è´Ÿè´£å†³å®šå¦‚ä½•å¤„ç†æ•°æ®ã€‚å…·æœ‰å¦‚ä¸‹4ä¸ªç‰¹æ€§ï¼š [[Configurable]]: è¡¨ç¤ºèƒ½å¦é€šè¿‡deleteåˆ é™¤å±æ€§ä»è€Œé‡æ–°å®šä¹‰å±æ€§ï¼Œèƒ½å¦ä¿®æ”¹å±æ€§çš„ç‰¹æ€§ï¼Œèƒ½å¦æŠŠå±æ€§ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ã€‚ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œé»˜è®¤ä¸º trueã€‚[[Enumerable]]: è¡¨ç¤ºèƒ½å¦é€šè¿‡for-inå¾ªç¯è¿”å›å±æ€§ã€‚ç›´æ¥åœ¨å¯¹è±¡ä¸Šå®šä¹‰çš„å±æ€§ï¼Œé»˜è®¤ä¸ºtrueã€‚[[Get]]: åœ¨è¯»å–å±æ€§æ—¶è°ƒç”¨çš„å‡½æ•°ï¼›é»˜è®¤å€¼ä¸ºundefinedã€‚åœ¨è¯»å–è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨getteæ–¹æ³•ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£è¿”å›æœ‰æ•ˆçš„å€¼ã€‚[[Set]]: åœ¨å†™å…¥å±æ€§æ—¶è°ƒç”¨çš„å‡½æ•°ï¼›é»˜è®¤å€¼ä¸ºundefinedã€‚åœ¨å†™å…¥è®¿é—®å™¨å±æ€§æ—¶ï¼Œä¼šè°ƒç”¨setteræ–¹æ³•å¹¶ä¼ å…¥æ–°å€¼ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£å†³å®šå¦‚ä½•å¤„ç†æ•°æ®ã€‚ è®¿é—®å™¨å±æ€§ä¸èƒ½ç›´æ¥å®šä¹‰ï¼Œå¿…é¡»ä½¿ç”¨Object.defineProperty()æ–¹æ³•æ¥å®šä¹‰ã€‚123456789101112131415161718var book = &#123; _year: 2016, edition: 5&#125;;Object.defineProperty(book, \"year\", &#123; get: function () &#123; return this._year; &#125;, set: function (newVal) &#123; if (newVal &gt; 2016) &#123; this._year = newVal; this.edition += newVal - 2016; &#125; &#125;&#125;);book.year = 2017;alert(book.edition); // 6 å®šä¹‰å¤šä¸ªå±æ€§Object.defineProperties()æ–¹æ³•ï¼Œé€šè¿‡æè¿°ç¬¦ä¸€æ¬¡æ€§å®šä¹‰å¤šä¸ªå±æ€§ï¼› æ¥æ”¶ä¸¤ä¸ªå¯¹è±¡å‚æ•°ï¼šç¬¬ä¸€ä¸ªå¯¹è±¡æ˜¯è¦æ·»åŠ æˆ–ä¿®æ”¹å…¶å±æ€§çš„å¯¹è±¡ï¼›ç¬¬äºŒä¸ªå¯¹è±¡çš„å±æ€§ä¸ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­è¦æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§ä¸€ä¸€å¯¹åº”ã€‚1234567891011121314151617181920212223var book = &#123;&#125;;Object.defineProperties(book, &#123; _year: &#123; writable: true, value: 2016 &#125;, edition: &#123; writable: true, value: 5 &#125;, year: &#123; get: function () &#123; return this._year; &#125;, set: function (newVal) &#123; if (newVal &gt; 2016) &#123; this._year = newVal; this.edition += newVal - 2016; &#125; &#125; &#125;&#125;); ä»¥ä¸Šä»£ç åœ¨ book å¯¹è±¡ä¸Šå®šä¹‰äº†ä¸¤ä¸ªæ•°æ®å±æ€§( _year å’Œ edition )å’Œä¸€ä¸ªè®¿é—®å™¨å±æ€§( year )ã€‚ è¯»å–å±æ€§çš„ç‰¹æ€§Object.getOwnPropertyDescriptor()æ–¹æ³•ï¼Œå¯ä»¥å–å¾—ç»™å®šå±æ€§çš„æè¿°ç¬¦ï¼› æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šå±æ€§æ‰€åœ¨çš„å¯¹è±¡ï¼Œè¦è¯»å–å…¶æè¿°ç¬¦çš„å±æ€§åç§°ã€‚ è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼›å¦‚æœæ˜¯æ•°æ®å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡çš„å±æ€§æœ‰configurableã€enumerableã€writableã€valueï¼›å¦‚æœæ˜¯è®¿é—®å™¨å±æ€§ï¼Œè¿™ä¸ªå¯¹è±¡çš„å±æ€§æœ‰configurableã€enumerableã€getã€setã€‚12345678910111213141516171819202122232425262728293031var book = &#123;&#125;;Object.defineProperties(book, &#123; _year: &#123; value: 2016 &#125;, edition: &#123; value: 5 &#125;, year: &#123; get: function () &#123; return this._year; &#125;, set: function (newVal) &#123; if (newVal &gt; 2016) &#123; this._year = newVal; this.edition += newVal - 2016; &#125; &#125; &#125;&#125;);var d = Object.getOwnPropertyDescriptor(book, \"_year\");alert(d.value); // 2016alert(d.configurable); // falsealert(type d.get); // \"undefined\"var d = Object.getOwnPropertyDescriptor(book, \"year\");alert(d.value); // undefinedalert(d.enumerable); // falsealert(type d.get); // \"function\" å¯¹äºæ•°æ®å±æ€§_year, value ç­‰äºæœ€åˆçš„å€¼ï¼Œconfigurable æ˜¯falseï¼Œè€Œ get ç­‰äº undefinedã€‚ å¯¹äºè®¿é—®å±æ€§ yearï¼Œvalue ç­‰äº undefinedï¼Œenumerable æ˜¯ falseï¼Œè€Œ get æ˜¯æŒ‡å‘ getterå‡½æ•°çš„æŒ‡é’ˆã€‚","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://pengfeidai.github.io/tags/Javascript/"},{"name":"oop","slug":"oop","permalink":"https://pengfeidai.github.io/tags/oop/"}]},{"title":"Vueå®ç°è½®æ’­å›¾ç»„ä»¶","slug":"Vue-Carousel","date":"2017-07-22T13:37:50.000Z","updated":"2020-05-22T12:14:57.000Z","comments":true,"path":"2017/07/22/Vue-Carousel/","link":"","permalink":"https://pengfeidai.github.io/2017/07/22/Vue-Carousel/","excerpt":"","text":"ç®€ä»‹æœ€è¿‘åœ¨å­¦ä¹  Vueï¼Œçœ‹åˆ°å¤§å¤šæ•°é¡¹ç›®é¦–é¡µéƒ½æœ‰è½®æ’­æ•ˆæœï¼Œç„¶åè‡ªå·±ä¹Ÿæ˜¯åšäº†ä¸€ä¸ªè½®æ’­å›¾ï¼Œå¸Œæœ›åˆ†äº«ç»™å¤§å®¶ã€‚ ä¸»è¦æŠ€æœ¯ v-if: æ¡ä»¶æ¸²æŸ“ v-forï¼šåˆ—è¡¨æ¸²æŸ“ v-bindï¼šå±æ€§ç»‘å®š transition: è¿‡æ¸¡æ•ˆæœ ç»„ä»¶äº¤äº’: çˆ¶ç»„ä»¶é€šè¿‡ props å°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶ ä¸»è¦æ€è·¯è½®æ’­å›¾ä¸­ï¼Œå®ƒæ˜¾ç¤ºçš„é‚£å¼ å›¾ç‰‡åœ¨æµè§ˆå™¨ä¸­å¯ä»¥çœ‹åˆ°æœ‰domå…ƒç´ ã€‚éšè—çš„æ˜¯æ²¡æœ‰domå…ƒç´ çš„ã€‚æ‰€ä»¥å¦‚æœæ˜¾ç¤ºä¸€å¼ å›¾ç‰‡ï¼Œå®é™…ä¸Šï¼Œè½®æ’­åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ æ˜¯å­˜åœ¨çš„ï¼Œå…¶ä»–çš„éƒ½è¢«åˆ æ‰äº†ã€‚æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œå°±å¾ˆç®€å•äº†ã€‚æƒ³è¦è½®æ’­ï¼Œè®¾ç½®ï¼šenterï¼šå³è¾¹â†’enter-toï¼šæ­£å¸¸ä½ç½®ï¼Œå¹¶ä¸”è¿‡æ¸¡å®Œæˆâ†’leaveï¼šæ­£å¸¸ä½ç½®â†’leave-toï¼šå·¦è¾¹ï¼Œå¹¶ä¸”è¿‡æ¸¡å®Œæˆã€‚ åœ¨çº¿é¢„è§ˆğŸ‘‰http://https://pengfeidai.github.io/Carousel/ æºä»£ç é¡¹ç›®æºç ï¼šğŸ‘‰https://github.com/pengfeidai/Carousel","categories":[],"tags":[{"name":"Vue","slug":"Vue","permalink":"https://pengfeidai.github.io/tags/Vue/"},{"name":"Carousel","slug":"Carousel","permalink":"https://pengfeidai.github.io/tags/Carousel/"}]},{"title":"ES6ç¼–ç é£æ ¼","slug":"ES6ç¼–ç é£æ ¼","date":"2017-07-20T14:18:06.000Z","updated":"2017-09-26T02:35:16.000Z","comments":true,"path":"2017/07/20/ES6ç¼–ç é£æ ¼/","link":"","permalink":"https://pengfeidai.github.io/2017/07/20/ES6ç¼–ç é£æ ¼/","excerpt":"","text":"å—çº§ä½œç”¨åŸŸlet å–ä»£ varES6 æå‡ºäº†ä¸¤ä¸ªæ–°çš„å£°æ˜å˜é‡çš„å‘½ä»¤ï¼šletå’Œconstã€‚å…¶ä¸­ï¼Œletå®Œå…¨å¯ä»¥å–ä»£varï¼Œå› ä¸ºä¸¤è€…è¯­ä¹‰ç›¸åŒï¼Œè€Œä¸”letæ²¡æœ‰å‰¯ä½œç”¨ã€‚123456789&apos;use strict&apos;;if (true) &#123; let x = &apos;hello&apos;;&#125;for (let i = 0; i &lt; 10; i++) &#123; console.log(i);&#125; ä¸Šé¢ä»£ç å¦‚æœç”¨varæ›¿ä»£letï¼Œå®é™…ä¸Šå°±å£°æ˜äº†ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æœ¬æ„ã€‚å˜é‡åº”è¯¥åªåœ¨å…¶å£°æ˜çš„ä»£ç å—å†…æœ‰æ•ˆï¼Œvarå‘½ä»¤åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚ varå‘½ä»¤å­˜åœ¨å˜é‡æå‡æ•ˆç”¨ï¼Œletå‘½ä»¤æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚123456&apos;use strict&apos;;if(true) &#123; console.log(x); // ReferenceError let x = &apos;hello&apos;;&#125; ä¸Šé¢ä»£ç å¦‚æœä½¿ç”¨varæ›¿ä»£letï¼Œconsole.logé‚£ä¸€è¡Œå°±ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ä¼šè¾“å‡ºundefinedï¼Œå› ä¸ºå˜é‡å£°æ˜æå‡åˆ°ä»£ç å—çš„å¤´éƒ¨ã€‚è¿™è¿åäº†å˜é‡å…ˆå£°æ˜åä½¿ç”¨çš„åŸåˆ™ã€‚æ‰€ä»¥ï¼Œå»ºè®®ä¸å†ä½¿ç”¨varå‘½ä»¤ï¼Œè€Œæ˜¯ä½¿ç”¨letå‘½ä»¤å–ä»£ã€‚ å…¨å±€å¸¸é‡å’Œçº¿ç¨‹å®‰å…¨åœ¨letå’Œconstä¹‹é—´ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨constï¼Œå°¤å…¶æ˜¯åœ¨å…¨å±€ç¯å¢ƒï¼Œä¸åº”è¯¥è®¾ç½®å˜é‡ï¼Œåªåº”è®¾ç½®å¸¸é‡ã€‚ constä¼˜äºletæœ‰å‡ ä¸ªåŸå› ã€‚ä¸€ä¸ªæ˜¯constå¯ä»¥æé†’é˜…è¯»ç¨‹åºçš„äººï¼Œè¿™ä¸ªå˜é‡ä¸åº”è¯¥æ”¹å˜ï¼›å¦ä¸€ä¸ªæ˜¯constæ¯”è¾ƒç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œè¿ç®—ä¸æ”¹å˜å€¼ï¼Œåªæ˜¯æ–°å»ºå€¼ï¼Œè€Œä¸”è¿™æ ·ä¹Ÿæœ‰åˆ©äºå°†æ¥çš„åˆ†å¸ƒå¼è¿ç®—ï¼›æœ€åä¸€ä¸ªåŸå› æ˜¯ JavaScript ç¼–è¯‘å™¨ä¼šå¯¹constè¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥å¤šä½¿ç”¨constï¼Œæœ‰åˆ©äºæä¾›ç¨‹åºçš„è¿è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è¯´letå’Œconstçš„æœ¬è´¨åŒºåˆ«ï¼Œå…¶å®æ˜¯ç¼–è¯‘å™¨å†…éƒ¨çš„å¤„ç†ä¸åŒã€‚12345678910// badvar a = 1, b = 2, c = 3;// goodconst a = 1;const b = 2;const c = 3;// bestconst [a, b, c] = [1, 2, 3]; constå£°æ˜å¸¸é‡è¿˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€æ˜¯é˜…è¯»ä»£ç çš„äººç«‹åˆ»ä¼šæ„è¯†åˆ°ä¸åº”è¯¥ä¿®æ”¹è¿™ä¸ªå€¼ï¼ŒäºŒæ˜¯é˜²æ­¢äº†æ— æ„é—´ä¿®æ”¹å˜é‡å€¼æ‰€å¯¼è‡´çš„é”™è¯¯ã€‚ æ‰€æœ‰çš„å‡½æ•°éƒ½åº”è¯¥è®¾ç½®ä¸ºå¸¸é‡ã€‚ é•¿è¿œæ¥çœ‹ï¼ŒJavaScriptå¯èƒ½ä¼šæœ‰å¤šçº¿ç¨‹çš„å®ç°ï¼ˆæ¯”å¦‚Intelçš„River Trailé‚£ä¸€ç±»çš„é¡¹ç›®ï¼‰ï¼Œè¿™æ—¶letè¡¨ç¤ºçš„å˜é‡ï¼Œåªåº”å‡ºç°åœ¨å•çº¿ç¨‹è¿è¡Œçš„ä»£ç ä¸­ï¼Œä¸èƒ½æ˜¯å¤šçº¿ç¨‹å…±äº«çš„ï¼Œè¿™æ ·æœ‰åˆ©äºä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ å­—ç¬¦ä¸²é™æ€å­—ç¬¦ä¸²ä¸€å¾‹ä½¿ç”¨å•å¼•å·æˆ–åå¼•å·ï¼Œä¸ä½¿ç”¨åŒå¼•å·ã€‚åŠ¨æ€å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ã€‚1234567891011// badconst a = &quot;foobar&quot;;const b = &apos;foo&apos; + a + &apos;bar&apos;;// acceptableconst c = `foobar`;// goodconst a = &apos;foobar&apos;;const b = `foo$&#123;a&#125;bar`;const c = &apos;foobar&apos;; è§£æ„èµ‹å€¼ä½¿ç”¨æ•°ç»„æˆå‘˜å¯¹å˜é‡èµ‹å€¼æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚12345678const arr = [1, 2, 3, 4];// badconst first = arr[0];const second = arr[1];// goodconst [first, second] = arr; å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚1234567891011121314// badfunction getFullName(user) &#123; const firstName = user.firstName; const lastName = user.lastName;&#125;// goodfunction getFullName(obj) &#123; const &#123; firstName, lastName &#125; = obj;&#125;// bestfunction getFullName(&#123; firstName, lastName &#125;) &#123;&#125; å¦‚æœå‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¼˜å…ˆä½¿ç”¨å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚è¿™æ ·ä¾¿äºä»¥åæ·»åŠ è¿”å›å€¼ï¼Œä»¥åŠæ›´æ”¹è¿”å›å€¼çš„é¡ºåº1234567891011// badfunction processInput(input) &#123; return [left, right, top, bottom];&#125;// goodfunction processInput(input) &#123; return &#123; left, right, top, bottom &#125;;&#125;const &#123; left, right &#125; = processInput(input); å¯¹è±¡å•è¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä¸ä»¥é€—å·ç»“å°¾ã€‚å¤šè¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä»¥é€—å·ç»“å°¾ã€‚12345678910111213// badconst a = &#123; k1: v1, k2: v2, &#125;;const b = &#123; k1: v1, k2: v2&#125;;// goodconst a = &#123; k1: v1, k2: v2 &#125;;const b = &#123; k1: v1, k2: v2,&#125;; å¯¹è±¡å°½é‡é™æ€åŒ–ï¼Œä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å¾—éšæ„æ·»åŠ æ–°çš„å±æ€§ã€‚å¦‚æœæ·»åŠ å±æ€§ä¸å¯é¿å…ï¼Œè¦ä½¿ç”¨Object.assignæ–¹æ³•ã€‚1234567891011// badconst a = &#123;&#125;;a.x = 3;// if reshape unavoidableconst a = &#123;&#125;;Object.assign(a, &#123; x: 3 &#125;);// goodconst a = &#123; x: null &#125;;a.x = 3; å¦‚æœå¯¹è±¡çš„å±æ€§åæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨åˆ›é€ å¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨å±æ€§è¡¨è¾¾å¼å®šä¹‰ã€‚12345678910111213// badconst obj = &#123; id: 5, name: &apos;San Francisco&apos;,&#125;;obj[getKey(&apos;enabled&apos;)] = true;// goodconst obj = &#123; id: 5, name: &apos;San Francisco&apos;, [getKey(&apos;enabled&apos;)]: true,&#125;; ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡objçš„æœ€åä¸€ä¸ªå±æ€§åï¼Œéœ€è¦è®¡ç®—å¾—åˆ°ã€‚è¿™æ—¶æœ€å¥½é‡‡ç”¨å±æ€§è¡¨è¾¾å¼ï¼Œåœ¨æ–°å»ºobjçš„æ—¶å€™ï¼Œå°†è¯¥å±æ€§ä¸å…¶ä»–å±æ€§å®šä¹‰åœ¨ä¸€èµ·ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰å±æ€§å°±åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰äº†ã€‚ å¦å¤–ï¼Œå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°½é‡é‡‡ç”¨ç®€æ´è¡¨è¾¾æ³•ï¼Œè¿™æ ·æ˜“äºæè¿°å’Œä¹¦å†™ã€‚1234567891011121314151617181920212223var ref = &apos;some value&apos;;// badconst atom = &#123; ref: ref, value: 1, addValue: function (value) &#123; return atom.value + value; &#125;,&#125;;// goodconst atom = &#123; ref, value: 1, addValue(value) &#123; return atom.value + value; &#125;,&#125;; æ•°ç»„ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰æ‹·è´æ•°ç»„ 1234567891011// badconst len = items.length;const itemsCopy = [];let i;for (i = 0; i &lt; len; i++) &#123; itemsCopy[i] = items[i];&#125;// goodconst itemsCopy = [...items]; ä½¿ç”¨Array.fromæ–¹æ³•ï¼Œå°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºæ•°ç»„ã€‚12const foo = document.querySelectorAll(&apos;.foo&apos;);const nodes = Array.from(foo); å‡½æ•°ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥å†™æˆç®­å¤´å‡½æ•°çš„å½¢å¼ã€‚123(() =&gt; &#123; console.log(&apos;Welcome to the Internet.&apos;);&#125;)(); é‚£äº›éœ€è¦ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åœºåˆï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ã€‚å› ä¸ºè¿™æ ·æ›´ç®€æ´ï¼Œè€Œä¸”ç»‘å®šäº†thisã€‚123456789101112// bad[1, 2, 3].map(function (x) &#123; return x * x;&#125;);// good[1, 2, 3].map((x) =&gt; &#123; return x * x;&#125;);// best[1, 2, 3].map(x =&gt; x * x); ç®­å¤´å‡½æ•°å–ä»£Function.prototype.bindï¼Œä¸åº”å†ç”¨self/_this/thatç»‘å®š thisã€‚1234567891011// badconst self = this;const boundMethod = function(...params) &#123; return method.apply(self, params);&#125;// acceptableconst boundMethod = method.bind(this);// bestconst boundMethod = (...params) =&gt; method.apply(this, params); ç®€å•çš„ã€å•è¡Œçš„ã€ä¸ä¼šå¤ç”¨çš„å‡½æ•°ï¼Œå»ºè®®é‡‡ç”¨ç®­å¤´å‡½æ•°ã€‚å¦‚æœå‡½æ•°ä½“è¾ƒä¸ºå¤æ‚ï¼Œè¡Œæ•°è¾ƒå¤šï¼Œè¿˜æ˜¯åº”è¯¥é‡‡ç”¨ä¼ ç»Ÿçš„å‡½æ•°å†™æ³•ã€‚ æ‰€æœ‰é…ç½®é¡¹éƒ½åº”è¯¥é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¾åœ¨æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¸ƒå°”å€¼ä¸å¯ä»¥ç›´æ¥ä½œä¸ºå‚æ•°ã€‚1234567// badfunction divide(a, b, option = false ) &#123;&#125;// goodfunction divide(a, b, &#123; option = false &#125; = &#123;&#125;) &#123;&#125; ä¸è¦åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨argumentså˜é‡ï¼Œä½¿ç”¨restè¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ä»£æ›¿ã€‚å› ä¸ºrestè¿ç®—ç¬¦æ˜¾å¼è¡¨æ˜ä½ æƒ³è¦è·å–å‚æ•°ï¼Œè€Œä¸”argumentsæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œè€Œrestè¿ç®—ç¬¦å¯ä»¥æä¾›ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ã€‚12345678910// badfunction concatenateAll() &#123; const args = Array.prototype.slice.call(arguments); return args.join(&apos;&apos;);&#125;// goodfunction concatenateAll(...args) &#123; return args.join(&apos;&apos;);&#125; ä½¿ç”¨é»˜è®¤å€¼è¯­æ³•è®¾ç½®å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚123456789// badfunction handleThings(opts) &#123; opts = opts || &#123;&#125;;&#125;// goodfunction handleThings(opts = &#123;&#125;) &#123; // ...&#125; Mapç»“æ„æ³¨æ„åŒºåˆ†Objectå’ŒMapï¼Œåªæœ‰æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„å®ä½“å¯¹è±¡æ—¶ï¼Œæ‰ä½¿ç”¨Objectã€‚å¦‚æœåªæ˜¯éœ€è¦key: valueçš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨Mapç»“æ„ã€‚å› ä¸ºMapæœ‰å†…å»ºçš„éå†æœºåˆ¶ã€‚12345678910111213let map = new Map(arr);for (let key of map.keys()) &#123; console.log(key);&#125;for (let value of map.values()) &#123; console.log(value);&#125;for (let item of map.entries()) &#123; console.log(item[0], item[1]);&#125; Classæ€»æ˜¯ç”¨Classï¼Œå–ä»£éœ€è¦prototypeçš„æ“ä½œã€‚å› ä¸ºClassçš„å†™æ³•æ›´ç®€æ´ï¼Œæ›´æ˜“äºç†è§£ã€‚123456789101112131415161718192021// badfunction Queue(contents = []) &#123; this._queue = [...contents];&#125;Queue.prototype.pop = function() &#123; const value = this._queue[0]; this._queue.splice(0, 1); return value;&#125;// goodclass Queue &#123; constructor(contents = []) &#123; this._queue = [...contents]; &#125; pop() &#123; const value = this._queue[0]; this._queue.splice(0, 1); return value; &#125;&#125; ä½¿ç”¨extendså®ç°ç»§æ‰¿ï¼Œå› ä¸ºè¿™æ ·æ›´ç®€å•ï¼Œä¸ä¼šæœ‰ç ´åinstanceofè¿ç®—çš„å±é™©ã€‚12345678910111213141516// badconst inherits = require(&apos;inherits&apos;);function PeekableQueue(contents) &#123; Queue.apply(this, contents);&#125;inherits(PeekableQueue, Queue);PeekableQueue.prototype.peek = function() &#123; return this._queue[0];&#125;// goodclass PeekableQueue extends Queue &#123; peek() &#123; return this._queue[0]; &#125;&#125; æ¨¡å—é¦–å…ˆï¼ŒModuleè¯­æ³•æ˜¯JavaScriptæ¨¡å—çš„æ ‡å‡†å†™æ³•ï¼ŒåšæŒä½¿ç”¨è¿™ç§å†™æ³•ã€‚ä½¿ç”¨importå–ä»£requireã€‚1234567// badconst moduleA = require(&apos;moduleA&apos;);const func1 = moduleA.func1;const func2 = moduleA.func2;// goodimport &#123; func1, func2 &#125; from &apos;moduleA&apos;; ä½¿ç”¨exportå–ä»£module.exportsã€‚123456789101112131415161718192021// commonJSçš„å†™æ³•var React = require(&apos;react&apos;);var Breadcrumbs = React.createClass(&#123; render() &#123; return &lt;nav /&gt;; &#125;&#125;);module.exports = Breadcrumbs;// ES6çš„å†™æ³•import React from &apos;react&apos;;class Breadcrumbs extends React.Component &#123; render() &#123; return &lt;nav /&gt;; &#125;&#125;;export default Breadcrumbs; å¦‚æœæ¨¡å—åªæœ‰ä¸€ä¸ªè¾“å‡ºå€¼ï¼Œå°±ä½¿ç”¨export defaultï¼Œå¦‚æœæ¨¡å—æœ‰å¤šä¸ªè¾“å‡ºå€¼ï¼Œå°±ä¸ä½¿ç”¨export defaultï¼Œexport defaultä¸æ™®é€šçš„exportä¸è¦åŒæ—¶ä½¿ç”¨ã€‚ ä¸è¦åœ¨æ¨¡å—è¾“å…¥ä¸­ä½¿ç”¨é€šé…ç¬¦ã€‚å› ä¸ºè¿™æ ·å¯ä»¥ç¡®ä¿ä½ çš„æ¨¡å—ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼ˆexport defaultï¼‰ã€‚12345// badimport * as myObject &apos;./importModule&apos;;// goodimport myObject from &apos;./importModule&apos;; å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åçš„é¦–å­—æ¯åº”è¯¥å°å†™ã€‚1234function makeStyleGuide() &#123;&#125;export default makeStyleGuide; å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡åçš„é¦–å­—æ¯åº”è¯¥å¤§å†™ã€‚123456const StyleGuide = &#123; es6: &#123; &#125;&#125;;export default StyleGuide; ESLintçš„ä½¿ç”¨ESLintæ˜¯ä¸€ä¸ªè¯­æ³•è§„åˆ™å’Œä»£ç é£æ ¼çš„æ£€æŸ¥å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥ä¿è¯å†™å‡ºè¯­æ³•æ­£ç¡®ã€é£æ ¼ç»Ÿä¸€çš„ä»£ç ã€‚ é¦–å…ˆï¼Œå®‰è£…ESLintã€‚1$ npm i -g eslint ç„¶åï¼Œå®‰è£…Airbnbè¯­æ³•è§„åˆ™ã€‚1$ npm i -g eslint-config-airbnb æœ€åï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª.eslintrcæ–‡ä»¶ï¼Œé…ç½®ESLintã€‚123&#123; &quot;extends&quot;: &quot;eslint-config-airbnb&quot;&#125; ç°åœ¨å°±å¯ä»¥æ£€æŸ¥ï¼Œå½“å‰é¡¹ç›®çš„ä»£ç æ˜¯å¦ç¬¦åˆé¢„è®¾çš„è§„åˆ™ã€‚ index.jsæ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ã€‚12345678var unusued = &apos;I have no purpose!&apos;;function greet() &#123; var message = &apos;Hello, World!&apos;; alert(message);&#125;greet(); ä½¿ç”¨ESLintæ£€æŸ¥è¿™ä¸ªæ–‡ä»¶ã€‚1234567$ eslint index.jsindex.js 1:5 error unusued is defined but never used no-unused-vars 4:5 error Expected indentation of 2 characters but found 4 indent 5:5 error Expected indentation of 2 characters but found 4 indentâœ– 3 problems (3 errors, 0 warnings) ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒåŸæ–‡ä»¶æœ‰ä¸‰ä¸ªé”™è¯¯ï¼Œä¸€ä¸ªæ˜¯å®šä¹‰äº†å˜é‡ï¼Œå´æ²¡æœ‰ä½¿ç”¨ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯è¡Œé¦–ç¼©è¿›ä¸º4ä¸ªç©ºæ ¼ï¼Œè€Œä¸æ˜¯è§„å®šçš„2ä¸ªç©ºæ ¼ã€‚ è§£å†³æµè§ˆå™¨å…¼å®¹ES6ç‰¹æ€§ä½¿ç”¨ babel è½¬æ¢å·¥å…·ï¼š https://babeljs.io/","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://pengfeidai.github.io/tags/Javascript/"},{"name":"ES6","slug":"ES6","permalink":"https://pengfeidai.github.io/tags/ES6/"}]},{"title":"ES6ï¼Œä½ çœŸçš„çŸ¥é“å—","slug":"æµ…è°ˆES6æ ¸å¿ƒå†…å®¹","date":"2017-07-16T14:33:25.000Z","updated":"2020-05-25T17:08:27.000Z","comments":true,"path":"2017/07/16/æµ…è°ˆES6æ ¸å¿ƒå†…å®¹/","link":"","permalink":"https://pengfeidai.github.io/2017/07/16/æµ…è°ˆES6æ ¸å¿ƒå†…å®¹/","excerpt":"","text":"ES6ç®€ä»‹ECMAScript6ï¼ˆç®€ç§°ES6ï¼‰æ˜¯ JavaScript è¯­è¨€çš„ä¸‹ä¸€ä»£æ ‡å‡†ã€‚åœ¨2015å¹´6æœˆæ­£å¼å‘å¸ƒï¼Œæ‰€ä»¥åˆç§°ES2015ã€‚ç”±äºç›®å‰å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½èƒ½å…¼å®¹ ES6 å…¨éƒ¨ç‰¹æ€§ï¼Œä½†æ˜¯ ES6 åœ¨å®é™…é¡¹ç›®ä¸­çš„å¹¿æ³›ä½¿ç”¨å·²æˆä¸ºä¸€ç§è¶‹åŠ¿ã€‚æ‰€ä»¥ä½œä¸ºä¸€ä¸ªå‰ç«¯å¼€å‘è€…ï¼ŒES6 çš„è¯­æ³•æ˜¯æˆ‘ä»¬å¿…é¡»æŒæ¡çš„ã€‚ åœ¨è®²è§£ ES6 è¯­æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹Babelã€‚ BabelBabelæ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ES6è½¬ç å™¨ï¼Œå¯ä»¥å°†ES6ä»£ç è½¬ä¸ºES5ä»£ç ï¼Œä»è€Œåœ¨ç°æœ‰ç¯å¢ƒæ‰§è¡Œã€‚å¯åœ¨Babelå®˜ç½‘ (http://babeljs.io/) æŸ¥çœ‹ï¼š image ä½¿ç”¨Gulp å’Œ Babel å°† ES6 ä»£ç è½¬æ¢æˆ ES5 ä»£ç å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š å®‰è£…ä¾èµ– å®‰è£…å…¨å±€ Gulp 1npm install -g gulp å®‰è£…é¡¹ç›®ä¸­ä½¿ç”¨çš„ Gulp 1npm install --save-dev gulp å®‰è£… Gulp ä¸Š Babel çš„æ’ä»¶ 1npm install --save-dev gulp-babel å®‰è£… Babel ä¸Šå°† ES6 è½¬æ¢æˆ ES5 çš„æ’ä»¶ 1npm install --save-dev babel-preset-es2015 Gulp é…ç½® gulpfile.js çš„å†…å®¹ 12345678var gulp = require(\"gulp\");var babel = require(\"gulp-babel\");gulp.task(\"default\", function () &#123; return gulp.src(\"src/**/*.js\") // ES6 æºç å­˜æ”¾çš„è·¯å¾„ .pipe(babel()) .pipe(gulp.dest(\"dist\")); //è½¬æ¢æˆ ES5 å­˜æ”¾çš„è·¯å¾„&#125;); å¦‚æœè¦ç”Ÿæˆ Soucemapï¼Œ åˆ™ç”¨ gulp-sourcemaps 12345678910111213var gulp = require(\"gulp\");var sourcemaps = require(\"gulp-sourcemaps\");var babel = require(\"gulp-babel\");var concat = require(\"gulp-concat\");gulp.task(\"default\", function () &#123; return gulp.src(\"src/**/*.js\") .pipe(sourcemaps.init()) .pipe(babel()) .pipe(concat(\"all.js\")) .pipe(sourcemaps.write(\".\")) .pipe(gulp.dest(\"dist\"));&#125;); Babel é…ç½®åœ¨é¡¹ç›®æ ¹è·¯å¾„åˆ›å»ºæ–‡ä»¶ .babelrcã€‚å†…å®¹ä¸ºï¼š123&#123; &quot;presets&quot;: [&quot;es2015&quot;]&#125; æ‰§è¡Œè½¬æ¢å‘½ä»¤è¡Œä¸­æ‰§è¡Œ1gulp ES6å¸¸ç”¨ç‰¹æ€§let, const, class, extends, super, arrow functions, template string, destructuring, default, rest arguments è¿™äº›æ˜¯ES6æœ€å¸¸ç”¨çš„å‡ ä¸ªè¯­æ³•ï¼ŒåŸºæœ¬ä¸Šå­¦ä¼šå®ƒä»¬ï¼Œå°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸çš„ä½¿ç”¨ï¼ä¸‹é¢å°±ç”¨ç”¨æœ€é€šä¿—æ˜“æ‡‚çš„è¯­è¨€å’Œä¾‹å­æ¥è®²è§£å®ƒä»¬ã€‚ let ä¸ constè¿™ä¸¤ä¸ªçš„ç”¨é€”ä¸varç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥å£°æ˜å˜é‡çš„ï¼Œä½†åœ¨å®é™…è¿ç”¨ä¸­éƒ½æœ‰å„è‡ªçš„ç‰¹æ®Šç”¨é€”ã€‚ ES5åªæœ‰å…¨å±€ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸå’Œevalä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„åœºæ™¯ã€‚ ç¬¬ä¸€ç§ï¼Œå˜é‡æå‡ï¼šå°±æ˜¯varå…³é”®å­—å£°æ˜å˜é‡ã€‚æ— è®ºå£°æ˜åœ¨ä½•å¤„ï¼Œéƒ½ä¼šè¢«è§†ä¸ºå£°æ˜åœ¨å‡½æ•°çš„æœ€é¡¶éƒ¨ï¼›ä¸åœ¨å‡½æ•°å†…å³åœ¨å…¨å±€ä½œç”¨åŸŸçš„æœ€é¡¶éƒ¨ã€‚è¿™æ ·å°±ä¼šå¼•èµ·ä¸€äº›è¯¯è§£ã€‚1234567console.log(a); // undefinedvar a = 3;// ç­‰ä»·äºvar a;console.log(a);a = 3; è€Œ let å°±ä¸ä¼šè¢«å˜é‡æå‡12console.log(a); // a is not definedlet a = 3; ç¬¬äºŒç§åœºæ™¯å°±æ˜¯å†…å±‚å˜é‡è¦†ç›–å¤–å±‚å˜é‡ã€‚ä¾‹å¦‚ï¼š123456789var name = 'Faker'while (true) &#123; var name = 'Davis' console.log(name) //Davis break&#125;console.log(name) //Davis è€Œletåˆ™å®é™…ä¸Šä¸ºJavaScriptæ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚ç”¨å®ƒæ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨letå‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚123456789let name = 'Faker'while (true) &#123; let name = 'Davis' console.log(name) //Davis break&#125;console.log(name) //Faker ç¬¬ä¸‰ç§åœºæ™¯å°±æ˜¯ç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡ï¼Œä¾‹å¦‚ï¼š1234567var a = [];for (var i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 10 ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ i æ˜¯ var å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ–°çš„ i å€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åè¾“å‡ºçš„æ˜¯æœ€åä¸€è½®çš„içš„å€¼ã€‚è€Œä½¿ç”¨ let åˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚1234567var a = [];for (let i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 6 constä¹Ÿç”¨æ¥å£°æ˜å˜é‡ï¼Œä½†æ˜¯å£°æ˜çš„æ˜¯å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚123const PI = 3.1415926;PI = 8;console.log(PI); // invalid assignment to const `PI' å½“æˆ‘ä»¬å°è¯•å»æ”¹å˜ç”¨constå£°æ˜çš„å¸¸é‡æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šæŠ¥é”™ã€‚constæœ‰ä¸€ä¸ªå¾ˆå¥½çš„åº”ç”¨åœºæ™¯ï¼Œå°±æ˜¯å½“æˆ‘ä»¬å¼•ç”¨ç¬¬ä¸‰æ–¹åº“çš„æ—¶å£°æ˜çš„å˜é‡ï¼Œç”¨constæ¥å£°æ˜å¯ä»¥é¿å…æœªæ¥ä¸å°å¿ƒé‡å‘½åè€Œå¯¼è‡´å‡ºç°bugï¼š1const monent = require('moment') Set å’Œ Map æ•°æ®ç»“æ„ä¸ Array å¢ã€åˆ ã€æ”¹ã€æŸ¥å¯¹æ¯”12345678910111213141516171819202122232425262728293031let map = new Map();let set = new Set();let array = [];// å¢map.set('t', 1);set.add( &#123; t : 1 &#125; );array.push( &#123; t:1 &#125; );console.info( map, set, array ); // Map &#123; 't' =&gt; 1 &#125; Set &#123; &#123; t: 1 &#125; &#125; [ &#123; t: 1 &#125; ]// æŸ¥let map_exist = map.has( 't' );let set_exist = set.has( &#123;t:1&#125; );let array_exist = array.find(item =&gt; item.t)console.info(map_exist, set_exist, array_exist); //true false &#123; t: 1 &#125;// æ”¹map.set('t', 2);set.forEach(item =&gt; item.t ? item.t = 2:'');array.forEach(item =&gt; item.t ? item.t = 2:'');console.info(map, set, array); // Map &#123; 't' =&gt; 2 &#125; Set &#123; &#123; t: 2 &#125; &#125; [ &#123; t: 2 &#125; ]// åˆ map.delete('t');set.forEach(item =&gt; item.t ? set.delete(item):'');let index = array.findIndex(item =&gt; item.t);array.splice(index,1);console.info(map, set, array); // Map &#123;&#125; Set &#123;&#125; [] classã€extendsã€superES5ä¸­åŸå‹ã€æ„é€ å‡½æ•°ï¼Œç»§æ‰¿é—®é¢˜ä¸€ç›´å›°æ‰°æˆ‘ä»¬ã€‚ES6å¼•å…¥äº†Classï¼ˆç±»ï¼‰çš„æ¦‚å¿µã€‚æ–°çš„classå†™æ³•è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•ï¼Œä¹Ÿæ›´åŠ é€šä¿—æ˜“æ‡‚ã€‚123456789101112131415161718192021222324class Human &#123; constructor(name) &#123; this.name = name; &#125; sleep() &#123; console.log(this.name + \" is sleeping\"); &#125;&#125;let man = new Human(\"Davis\");man.sleep(); //Davis is sleepingclass Boy extends Human &#123; constructor(name, age) &#123; super() this.name = name; this.age = age; &#125; info()&#123; console.log(this.name + 'is ' + this.age + 'years old'); &#125;&#125;let son = new Boy('Faker','8');son.sleep(); // Faker is sleepingson.info(); // Faker is 8 years old ä¸Šé¢ä»£ç é¦–å…ˆç”¨classå®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªconstructoræ–¹æ³•ï¼Œè¿™å°±æ˜¯æ„é€ æ–¹æ³•ï¼Œè€Œthiså…³é”®å­—åˆ™ä»£è¡¨å®ä¾‹å¯¹è±¡ã€‚ç®€å•åœ°è¯´ï¼Œconstructorå†…å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§æ˜¯å®ä¾‹å¯¹è±¡è‡ªå·±çš„ï¼Œè€Œconstructorå¤–å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§åˆ™æ˜¯æ‰€æœ‰å®ä¾‹å¯¹è±¡å¯ä»¥å…±äº«çš„ã€‚ Classä¹‹é—´å¯ä»¥é€šè¿‡extendså…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè¿™æ¯”ES5çš„é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªBoyç±»ï¼Œè¯¥ç±»é€šè¿‡extendså…³é”®å­—ï¼Œç»§æ‰¿äº†Humanç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ superå…³é”®å­—ï¼Œå®ƒæŒ‡ä»£çˆ¶ç±»çš„å®ä¾‹ï¼ˆå³çˆ¶ç±»çš„thiså¯¹è±¡ï¼‰ã€‚å­ç±»å¿…é¡»åœ¨constructoræ–¹æ³•ä¸­è°ƒç”¨superæ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„thiså¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨superæ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°thiså¯¹è±¡ã€‚ ES6çš„ç»§æ‰¿æœºåˆ¶ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹thisã€‚ arrow function ç®­å¤´å‡½æ•°ES6ä¸­æ–°å¢çš„ç®­å¤´æ“ä½œç¬¦ =&gt; ç®€åŒ–äº†å‡½æ•°çš„ä¹¦å†™ã€‚æ“ä½œç¬¦å·¦è¾¹ä¸ºè¾“å…¥çš„å‚æ•°ï¼Œè€Œå³è¾¹åˆ™æ˜¯è¿›è¡Œçš„æ“ä½œä»¥åŠè¿”å›çš„å€¼ï¼Œå¯ä»¥è¯´æ˜¯ ES6 æœ€æœ€å¸¸ç”¨çš„ä¸€ä¸ªæ–°ç‰¹æ€§äº†ï¼Œçœ‹ä¸‹é¢çš„å®ä¾‹ï¼š1234567891011// ES5let arr = [1, 3, 5, 7, 9];arr.forEach (function(val, key) &#123; return console.log(val, key);&#125;);// ES6let arr = [1, 3, 5, 7, 9];arr.forEach ((val, key) =&gt; console.log(val, key)); JavaScriptè¯­è¨€çš„thiså¯¹è±¡æŒ‡å‘æ˜¯ä¸€ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼Œåœ¨å¯¹è±¡æ–¹æ³•ä¸­ä½¿ç”¨thisï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚123456789101112class Human &#123; constructor(name) &#123; this.name = name; &#125; sleep() &#123; setTimeout(function()&#123; console.log(this.name + \" is sleeping\"); &#125;, 1000) &#125;&#125;let man = new Human(\"Davis\");man.sleep(); // is sleeping ä¸Šé¢ä»£ç ä¹‹æ‰€ä»¥ä¸èƒ½è¾“å‡º Davisï¼Œè¿™æ˜¯å› ä¸ºsetTimeoutä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡ã€‚ä¸ºäº†è®©å®ƒèƒ½å¤Ÿæ­£ç¡®çš„è¿è¡Œï¼Œä¼ ç»Ÿçš„è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š123456789101112// ç¬¬ä¸€ç§ï¼Œå°†thisä¼ ç»™self,å†ç”¨selfæ¥æŒ‡ä»£thissleep() &#123; var self = this; setTimeout(function()&#123; console.log(self.name + \" is sleeping\"); &#125;, 1000)// ç¬¬äºŒç§ï¼Œæ˜¯ç”¨bind(this)sleep() &#123; setTimeout(function()&#123; console.log(self.name + \" is sleeping\") &#125;.bind(this), 1000) ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œéå¸¸æ–¹ä¾¿ï¼š123456789101112class Human &#123; constructor(name)&#123; this.name = name; &#125; sleep() &#123; setTimeout( () =&gt; &#123; console.log(this.name + \"is sleeping\"); &#125;, 1000) &#125;&#125;let man = new Human(\"Davis\");man.sleep(); // Davis is sleeping å½“æˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°æ—¶ï¼Œå‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚å¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®šthisçš„æœºåˆ¶ï¼Œå®é™…åŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„thisï¼Œå®ƒçš„thisæ˜¯ç»§æ‰¿å¤–é¢çš„ï¼Œå› æ­¤å†…éƒ¨çš„thiså°±æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚ template string æ¨¡æ¿å­—ç¬¦ä¸²ES6ä¸­å…è®¸ä½¿ç”¨åå¼•å· ` æ¥åˆ›å»ºå­—ç¬¦ä¸²ï¼Œæ­¤ç§æ–¹æ³•åˆ›å»ºçš„å­—ç¬¦ä¸²é‡Œé¢å¯ä»¥åŒ…å«ç”±ç¾å…ƒç¬¦å·åŠ èŠ±æ‹¬å·åŒ…è£¹çš„å˜é‡${vraible}ã€‚12let num = Math.random();console.log(` num is $&#123;num&#125;`); // num is xx ä¸å†é€šè¿‡ \\ æ¥åšå¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥å¤šè¡Œä¹¦å†™ï¼š1234$(\"#main\").html(` &lt;h1&gt;ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼&lt;/h1&gt; &lt;p&gt;äº§ç”Ÿä¸€ä¸ªéšæœºæ•°$&#123;num&#125;&lt;/p&gt;`); æ¨¡æ¿å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ç©ºæ ¼ã€æ–°è¡Œã€ç¼©è¿›ï¼Œéƒ½ä¼šåŸæ ·è¾“å‡ºåœ¨ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸­ã€‚ destructuring è§£æ„ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ã€‚ ç”¨é€”ä¸€ï¼Œäº¤æ¢å˜é‡çš„å€¼ï¼Œä¸å†éœ€è¦ä¸­é—´å˜é‡1234let a = 1;let b = 2;[a, b] = [b, a];console.log(a, b); // 2 1 ç”¨é€”äºŒï¼Œæå–JSONæ•°æ®123456789let jsonData = &#123; id: 1, title: \"OK\", data: [5, 6]&#125;;let &#123;id, title, data:number&#125; = jsonData;console.log(id, title, number); // 1, \"OK\", [5, 6] ç”¨é€”ä¸‰ï¼Œå‡½æ•°å‚æ•°çš„å®šä¹‰1234567891011 // å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼function f([x, y, z]) &#123; ... &#125;f([1, 2, 3]);// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼function f(&#123;x, y, z&#125;) &#123;...&#125;f(&#123;z: 3, y: 2, x: 1&#125;); defaulté»˜è®¤å‚æ•°defaultå¾ˆç®€å•ï¼Œå°±æ˜¯é»˜è®¤å€¼ã€‚ç°åœ¨å¯ä»¥åœ¨å®šä¹‰å‡½æ•°çš„æ—¶å€™æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œè€Œä¸ç”¨åƒä»¥å‰é‚£æ ·é€šè¿‡é€»è¾‘æˆ–æ“ä½œç¬¦æ¥è¾¾åˆ°ç›®çš„äº†ã€‚1234567891011121314// ä¼ ç»ŸæŒ‡å®šé»˜è®¤å‚æ•°function say1(name) &#123; var name = name || 'Faker'; console.log( 'Hello ' + name );&#125;// ES6é»˜è®¤å‚æ•°function say2(name='Davis') &#123; console.log(`Hello $&#123;name&#125;`);&#125;say1(); // Hello Fakersay1('Tom'); // Hello tomsay2(); //Hello Davissay2('Bob'); // Hello Bob æ³¨æ„ï¼š say2(name=â€™tomâ€™)è¿™é‡Œçš„ç­‰å·ï¼ŒæŒ‡çš„æ˜¯æ²¡æœ‰ä¼ è¿™ä¸ªå‚æ•°ï¼Œåˆ™è®¾ç½®é»˜è®¤å€¼Davisï¼Œè€Œä¸æ˜¯ç»™å‚æ•°èµ‹å€¼ã€‚ restå‚æ•°restå‚æ•°åªåŒ…æ‹¬é‚£äº›æ²¡æœ‰ç»™å‡ºåç§°çš„å‚æ•°ï¼› restå‚æ•°æ˜¯Arrayçš„å®ä¾‹ï¼Œå¯ä»¥ç›´æ¥åº”ç”¨sort, map, forEach, popç­‰æ–¹æ³•ï¼› restå‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶å®ƒå‚æ•°ï¼ˆå³ï¼Œåªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼› å‡½æ•°çš„lengthå±æ€§ï¼Œä¸åŒ…æ‹¬restå‚æ•°ï¼›12345function fn(x, y, ...rest)&#123; console.log(rest)&#125;fn(1, \"cat\", \"dog\", 2); //[\"dog\", 2]console.log(fn.length); //2 Proxy ä»£ç†Proxyå¯ä»¥ç›‘å¬å¯¹è±¡èº«ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œå¹¶åœ¨è¿™äº›äº‹æƒ…å‘ç”Ÿåæ‰§è¡Œä¸€äº›ç›¸åº”çš„æ“ä½œã€‚è®©æˆ‘ä»¬å¯¹ä¸€ä¸ªå¯¹è±¡æœ‰äº†å¾ˆå¼ºçš„è¿½è¸ªèƒ½åŠ›ï¼ŒåŒæ—¶åœ¨æ•°æ®ç»‘å®šæ–¹é¢ä¹Ÿå¾ˆæœ‰ç”¨å¤„ã€‚1234567891011121314//å®šä¹‰è¢«ç›‘å¬çš„ç›®æ ‡å¯¹è±¡let man = &#123; name: 'Davis', age: 21 &#125;;//å®šä¹‰å¤„ç†ç¨‹åºlet handle = &#123; set(receiver, property, value) &#123; console.log(property, 'is changed to', value); receiver[property] = value; &#125;&#125;;//åˆ›å»ºä»£ç†ä»¥è¿›è¡Œä¾¦å¬man = new Proxy(man, handle);//åšä¸€äº›æ”¹åŠ¨æ¥è§¦å‘ä»£ç†man.age = 22; //age is change to 22man.name = \"Faker\"; // name is change to Faker PromisePromiseå¯¹è±¡çŠ¶æ€ Promise/A+è§„èŒƒ, è§„å®šPromiseå¯¹è±¡æ˜¯ä¸€ä¸ªæœ‰é™çŠ¶æ€æœºã€‚å®ƒä¸‰ä¸ªçŠ¶æ€ï¼š pendingï¼ˆæ‰§è¡Œä¸­ï¼‰ Resolvedï¼ˆå·²å®Œæˆï¼‰ Rejectedï¼ˆå·²å¤±è´¥ï¼‰ å…¶ä¸­pendingä¸ºåˆå§‹çŠ¶æ€ï¼ŒResolvedå’Œrejectedä¸ºç»“æŸçŠ¶æ€ï¼ˆè¡¨ç¤ºpromiseçš„ç”Ÿå‘½å‘¨æœŸå·²ç»“æŸï¼‰ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354let val = 1;// æˆ‘ä»¬å‡è®¾step1, step2, step3éƒ½æ˜¯ajaxè°ƒç”¨åç«¯æˆ–è€…æ˜¯åœ¨Node.jsä¸ŠæŸ¥è¯¢æ•°æ®åº“çš„å¼‚æ­¥æ“ä½œ// æ¯ä¸ªæ­¥éª¤éƒ½æœ‰å¯¹åº”çš„å¤±è´¥å’ŒæˆåŠŸå¤„ç†å›è°ƒ// step1ã€step2ã€step3å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œfunction step1(resolve, reject) &#123; console.log('æ­¥éª¤ä¸€ï¼šæ‰§è¡Œ'); if (val &gt;= 1) &#123; resolve('Hello I am No.1'); &#125; else if (val === 0) &#123; reject(val); &#125;&#125;function step2(resolve, reject) &#123; console.log('æ­¥éª¤äºŒï¼šæ‰§è¡Œ'); if (val === 1) &#123; resolve('Hello I am No.2'); &#125; else if (val === 0) &#123; reject(val); &#125;&#125;function step3(resolve, reject) &#123; console.log('æ­¥éª¤ä¸‰ï¼šæ‰§è¡Œ'); if (val === 1) &#123; resolve('Hello I am No.3'); &#125; else if (val === 0) &#123; reject(val); &#125;&#125;new Promise(step1).then(function(val)&#123; console.info(val); return new Promise(step2);&#125;).then(function(val)&#123; console.info(val); return new Promise(step3);&#125;).then(function(val)&#123; console.info(val); return val;&#125;).then(function(val)&#123; console.info(val); return val;&#125;);// æ‰§è¡Œä¹‹åå°†ä¼šæ‰“å°æ­¥éª¤ä¸€ï¼šæ‰§è¡ŒHello I am No.1æ­¥éª¤äºŒï¼šæ‰§è¡ŒHello I am No.2æ­¥éª¤ä¸‰ï¼šæ‰§è¡ŒHello I am No.3Hello I am No.3 å¸¸ç”¨å…³é”®ç‚¹ï¼š åœ¨Promiseå®šä¹‰æ—¶ï¼Œå‡½æ•°å·²ç»æ‰§è¡Œäº†ï¼›Promiseæ„é€ å‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å¸¦æœ‰å¼‚æ­¥é€»è¾‘çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åœ¨ new Promise æ—¶å·²ç»æ‰§è¡Œäº†ã€‚åªä¸è¿‡åœ¨æ²¡æœ‰è°ƒç”¨ then ä¹‹å‰ä¸ä¼š resolve æˆ– rejectã€‚ åœ¨thenæ–¹æ³•ä¸­é€šå¸¸ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ª resolve å‡½æ•°ï¼Œä¸€ä¸ª reject å‡½æ•°ã€‚rejectå°±æ˜¯å‡ºé”™çš„æ—¶å€™è¿è¡Œçš„å‡½æ•°ã€‚resolve å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå€¼æ‰èƒ½æŠŠé“¾å¼è°ƒç”¨è¿›è¡Œä¸‹å»ã€‚ resolve è¿”å›ä¸€ä¸ªæ–° Promiseè¿”å›ä¸€ä¸ªæ–°Promiseä¹‹åå†è°ƒç”¨çš„thenå°±æ˜¯æ–°Promiseä¸­çš„é€»è¾‘äº†ã€‚ resolve è¿”å›ä¸€ä¸ªå€¼è¿”å›ä¸€ä¸ªå€¼ä¼šä¼ é€’åˆ°ä¸‹ä¸€ä¸ªthençš„resolveæ–¹æ³•å‚æ•°ä¸­ã€‚ GeneratorGeneratorå‡½æ•°è·Ÿæ™®é€šå‡½æ•°çš„å†™æ³•æœ‰éå¸¸å¤§çš„åŒºåˆ«ï¼š functionå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ª *ï¼› å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨yieldè¯­å¥ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ï¼› 123456789101112function* f() &#123; yield 'a'; yield 'b'; yield 'c'; return 'ending';&#125;let fn = f();console.log(fn.next()); // &#123; value: 'a', done: false &#125;console.log(fn.next()); // &#123; value: 'b', done: false &#125;console.log(fn.next()); // &#123; value: 'c', done: false &#125;console.log(fn.next()); // &#123; value: 'ending', done: true &#125; ç¬¬ä¸€æ¬¡è¾“å‡ºfn.next()è¿”å›ä¸€ä¸ªç®€å•çš„å¯¹è±¡{value: â€œaâ€, done: false}ï¼Œâ€™aâ€™å°±æ˜¯få‡½æ•°æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªyieldè¯­å¥ä¹‹åå¾—åˆ°çš„å€¼ï¼Œfalseè¡¨ç¤ºfå‡½æ•°è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œåªæ˜¯åœ¨è¿™æš‚åœã€‚ ç¬¬äºŒæ¬¡ï¼Œè¿”å›çš„å°±æ˜¯{value: â€œbâ€, done: false}ï¼Œè¯´æ˜få‡½æ•°è¿è¡Œåˆ°äº†ç¬¬äºŒä¸ªyieldè¯­å¥ï¼Œè¿”å›çš„æ˜¯è¯¥yieldè¯­å¥çš„è¿”å›å€¼â€™bâ€™ã€‚è¿”å›ä¹‹åä¾ç„¶æ˜¯æš‚åœã€‚ ç¬¬ä¸‰æ¬¡ï¼Œç¬¬å››æ¬¡åŒç†ï¼Œè¿™æ ·æ•´ä¸ªfå‡½æ•°å°±è¿è¡Œå®Œæ¯•äº†ã€‚ å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–å†™æ³•Generatorå‡½æ•°çš„æš‚åœæ‰§è¡Œçš„æ•ˆæœï¼Œæ„å‘³ç€å¯ä»¥æŠŠå¼‚æ­¥æ“ä½œå†™åœ¨yieldè¯­å¥é‡Œé¢ï¼Œç­‰åˆ°è°ƒç”¨nextæ–¹æ³•æ—¶å†å¾€åæ‰§è¡Œã€‚è¿™å®é™…ä¸Šç­‰åŒäºä¸éœ€è¦å†™å›è°ƒå‡½æ•°äº†ï¼Œå› ä¸ºå¼‚æ­¥æ“ä½œçš„åç»­æ“ä½œå¯ä»¥æ”¾åœ¨yieldè¯­å¥ä¸‹é¢ï¼Œåæ­£è¦ç­‰åˆ°è°ƒç”¨nextæ–¹æ³•æ—¶å†æ‰§è¡Œã€‚æ‰€ä»¥ï¼ŒGeneratorå‡½æ•°çš„ä¸€ä¸ªé‡è¦å®é™…æ„ä¹‰å°±æ˜¯ç”¨æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ”¹å†™å›è°ƒå‡½æ•°ã€‚ ä¾‹å­ï¼šå‡è®¾æˆ‘åœ¨æµ‹è¯•æœåŠ¡å™¨çš„æŸç›®å½•å»ºäº†4ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯â€™test.htmlâ€™ã€â€™a.htmlâ€™ã€â€™b.htmlâ€™ã€â€™c.htmlâ€™ï¼Œåä¸‰ä¸ªæ–‡ä»¶çš„æ–‡ä»¶å†…å®¹è·Ÿæ–‡ä»¶åç›¸åŒï¼Œç°åœ¨æˆ‘ç¼–è¾‘â€™test.htmlâ€™çš„ä»£ç ï¼Œæƒ³è¦å…ˆajax-getç›¸å¯¹ç½‘å€â€™a.htmlâ€™ï¼Œç„¶åå†å›è°ƒé‡Œajax-getç›¸å¯¹ç½‘å€â€™b.htmlâ€™ï¼Œç„¶ååœ¨å›è°ƒé‡Œajax-getç›¸å¯¹ç½‘å€â€™c.htmlâ€™ã€‚ 12345678910111213141516171819function req(url) &#123; $.get(url, function(res)&#123; it.next(res); &#125;);&#125;// ç”Ÿæˆå™¨å‡½æ•°function* ajaxs() &#123; console.log(yield req('a.html')); console.log(yield req('b.html')); console.log(yield req('c.html'));&#125;var it = ajaxs(); // éå†å™¨å¯¹è±¡it.next();// a.html// b.html// c.html å¼ºè°ƒï¼šåªæœ‰å½“yieldåé¢è·Ÿçš„å‡½æ•°å…ˆæ‰§è¡Œå®Œï¼Œæ— è®ºæ‰§è¡Œä½“é‡Œé¢æœ‰å¤šå°‘å¼‚æ­¥å›è°ƒï¼Œéƒ½è¦ç­‰æ‰€æœ‰å›è°ƒå…ˆæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œç­‰å·èµ‹å€¼ï¼Œä»¥åŠå†åé¢çš„æ“ä½œã€‚è¿™ä¹Ÿæ˜¯yieldæœ€å¤§çš„ç‰¹æ€§ã€‚ exportã€importexportç”¨äºå¯¹å¤–è¾“å‡ºæœ¬æ¨¡å—ï¼ˆä¸€ä¸ªæ–‡ä»¶å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¨¡å—ï¼‰å˜é‡çš„æ¥å£ï¼› importç”¨äºåœ¨ä¸€ä¸ªæ¨¡å—ä¸­åŠ è½½å¦ä¸€ä¸ªå«æœ‰exportæ¥å£çš„æ¨¡å—ã€‚ å¯¼å‡ºä¸€ç»„å¯¹è±¡ å¯¼å‡ºæ¨¡å—æ–‡ä»¶app.jsï¼š123456789101112131415class Human&#123; constructor(name) &#123; this.name = name; &#125; sleep() &#123; console.log(this.name + &quot; is sleeping&quot;); &#125;&#125;function walk() &#123; console.log(&apos;i am walking&apos;);&#125;function play() &#123; console.log(&apos;i am playing&apos;);&#125;export &#123; Human, walk &#125; æ¨¡å—å¯¼å‡ºäº†ä¸¤ä¸ªå¯¹è±¡ï¼šHumanç±»å’Œwalkå‡½æ•°ï¼Œèƒ½è¢«å…¶ä»–æ–‡ä»¶ä½¿ç”¨ã€‚è€Œplayå‡½æ•°æ²¡æœ‰å¯¼å‡ºï¼Œä¸ºæ­¤æ¨¡å—ç§æœ‰ï¼Œä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶ä½¿ç”¨ã€‚ main.jså¯¼å…¥app.jsæ¨¡å—1import &#123; Human, walk &#125; from &apos;app.js&apos;; Defaultå¯¼å‡ºä½¿ç”¨å…³é”®å­—defaultï¼Œå¯å°†å¯¹è±¡æ ‡æ³¨ä¸ºdefaultå¯¹è±¡å¯¼å‡ºã€‚defaultå…³é”®å­—åœ¨æ¯ä¸€ä¸ªæ¨¡å—ä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚12... //ç±»ï¼Œå‡½æ•°ç­‰export default App; main.jså¯¼å…¥app.jsæ¨¡å—1import App from &apos;app.js&apos;; ç»“è¯­ä»¥ä¸Šè¿™äº›æ˜¯ES6æœ€å¸¸ç”¨çš„å‡ ä¸ªè¯­æ³•ï¼ŒåŸºæœ¬ä¸Šå­¦ä¼šå®ƒä»¬ï¼Œå°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸çš„ä½¿ç”¨ï¼ES6çš„æ–°è¯­æ³•ç‰¹æ€§è®©å‰ç«¯å’Œåç«¯çš„å·®å¼‚è¶Šæ¥è¶Šå°äº†ï¼Œæˆ‘ä»¬å¿…é¡»è¦äº†è§£è¿™äº›æ–°çš„å‰æ²¿çŸ¥è¯†ï¼ˆè™½ç„¶ES8å·²ç»åˆ°æ¥ï¼Œä½†æˆ‘ç›¸ä¿¡ç›®å‰è¿˜æ˜¯ES6çš„æ—¶ä»£ï¼‰ï¼Œæ‰èƒ½æ›´å¥½è¿ç”¨äºé¡¹ç›®ä¸­ã€‚ é¡¹ç›®æºç ï¼šhttps://github.com/pengfeidai/lottery-es6","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://pengfeidai.github.io/tags/Javascript/"},{"name":"ES6","slug":"ES6","permalink":"https://pengfeidai.github.io/tags/ES6/"},{"name":"gulp","slug":"gulp","permalink":"https://pengfeidai.github.io/tags/gulp/"}]},{"title":"å“åº”å¼ç½‘é¡µå¼€å‘ä½ ä¸çŸ¥é“çš„é‚£äº›äº‹","slug":"å“åº”å¼ç½‘é¡µå¼€å‘åº”æ³¨æ„çš„é‚£äº›äº‹å„¿","date":"2017-07-11T14:52:28.000Z","updated":"2020-05-22T12:14:57.000Z","comments":true,"path":"2017/07/11/å“åº”å¼ç½‘é¡µå¼€å‘åº”æ³¨æ„çš„é‚£äº›äº‹å„¿/","link":"","permalink":"https://pengfeidai.github.io/2017/07/11/å“åº”å¼ç½‘é¡µå¼€å‘åº”æ³¨æ„çš„é‚£äº›äº‹å„¿/","excerpt":"","text":"ç®€ä»‹å“åº”å¼ç½‘é¡µè®¾è®¡é€šè¿‡ä½¿ç”¨å¼¹æ€§ç½‘æ ¼å’Œå¸ƒå±€ã€å“åº”å¼å›¾ç‰‡ã€CSS media queryç­‰æŠ€æœ¯æ‰‹æ®µï¼Œä½¿é¡µé¢èƒ½å¤Ÿè‡ªåŠ¨åˆ‡æ¢åˆ†è¾¨ç‡ã€å›¾ç‰‡å°ºå¯¸åŠç›¸å…³è„šæœ¬åŠŸèƒ½ï¼Œä»¥é€‚åº”ä¸åŒè®¾å¤‡ï¼Œæ¥æ»¡è¶³ç”¨æˆ·åœ¨å„ç§è®¾å¤‡ç¯å¢ƒä¸‹çš„éœ€æ±‚ã€‚å“åº”å¼ç½‘é¡µè®¾è®¡å°±æ˜¯ä¸€ä¸ªç½‘ç«™èƒ½å¤Ÿå…¼å®¹å¤šä¸ªç»ˆç«¯â€”â€”è€Œä¸æ˜¯ä¸ºæ¯ä¸ªç»ˆç«¯åšä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚ image åª’ä½“æŸ¥è¯¢ä»€ä¹ˆæ˜¯åª’ä½“æŸ¥è¯¢åª’ä½“æŸ¥è¯¢å¯ä»¥è®©æˆ‘ä»¬æ ¹æ®è®¾å¤‡æ˜¾ç¤ºå™¨çš„ç‰¹æ€§ï¼ˆå¦‚è§†å£å®½åº¦ã€å±å¹•æ¯”ä¾‹ã€è®¾å¤‡æ–¹å‘ï¼šæ¨ªå‘æˆ–çºµå‘ï¼‰ä¸ºå…¶è®¾å®šCSSæ ·å¼ï¼Œåª’ä½“æŸ¥è¯¢ç”±åª’ä½“ç±»å‹å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ£€æµ‹åª’ä½“ç‰¹æ€§çš„æ¡ä»¶è¡¨è¾¾å¼ç»„æˆã€‚åª’ä½“æŸ¥è¯¢ä¸­å¯ç”¨äºæ£€æµ‹çš„åª’ä½“ç‰¹æ€§æœ‰ width ã€ height å’Œ color ï¼ˆç­‰ï¼‰ã€‚ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼Œå¯ä»¥åœ¨ä¸æ”¹å˜é¡µé¢å†…å®¹çš„æƒ…å†µä¸‹ï¼Œä¸ºç‰¹å®šçš„ä¸€äº›è¾“å‡ºè®¾å¤‡å®šåˆ¶æ˜¾ç¤ºæ•ˆæœã€‚ å¦‚ä½•åœ¨CSSæ–‡ä»¶ä¸­å¼•å…¥åª’ä½“æŸ¥è¯¢åª’ä½“æŸ¥è¯¢å†™åœ¨CSSæ ·å¼ä»£ç çš„æœ€åï¼ŒCSSæ˜¯å±‚å æ ·å¼è¡¨ï¼Œåœ¨åŒä¸€ç‰¹æ®Šæ€§ä¸‹ï¼Œé åçš„çš„æ ·å¼ä¼šé‡å å‰é¢çš„æ ·å¼ã€‚ æ€æ ·ä½¿ç”¨mediaç¬¬ä¸€æ­¥ï¼šéœ€è¦åœ¨htmlæ–‡æ¡£ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œç”¨æ¥å…¼å®¹ç§»åŠ¨è®¾å¤‡çš„æ˜¾ç¤ºæ•ˆæœ1&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no&quot;&gt; width=device-width:å®½åº¦ç­‰äºå½“å‰è®¾å¤‡çš„å®½åº¦ initial-scale=1ï¼šåˆå§‹çš„ç¼©æ”¾æ¯”ä¾‹ï¼ˆé»˜è®¤ä¸º1ï¼‰ minimum-scale=1ï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°å¾—æœ€å°æ¯”ä¾‹ï¼ˆé»˜è®¤ä¸º1ï¼‰ maximum-scale=1ï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°å¾—æœ€å¤§æ¯”ä¾‹ï¼ˆé»˜è®¤ä¸º1ï¼‰ user-scalable=noï¼šç”¨æˆ·ä¸èƒ½æ‰‹åŠ¨ç¼©æ”¾ ç¬¬äºŒæ­¥ï¼šæ€æ ·åœ¨CSSæ–‡ä»¶ä¸­å†™CSSå“åº”å¼åª’ä½“æŸ¥è¯¢1234567891011121314151617181920body &#123; font-size: 1.6rem; background: #f7f7f7;&#125;@media only screen and (max-width: 50em) &#123; body &#123; font-size: 1.2rem; background: #fff; &#125;&#125;@media only screen and (min-width: 30.0625em) and (max-width:50em)&#123;&#125;@media only screen and (max-width: 30em) &#123; body &#123; font-size: 1.0rem; background: #999; &#125;&#125; åœ¨ä¸åŒå®½åº¦ä¸‹ï¼Œæ”¹å˜èƒŒæ™¯é¢œè‰²å’Œå­—ä½“å¤§å° å…¼å®¹æ€§è§£å†³éƒ¨åˆ†IEæµè§ˆå™¨(IE9ä»¥ä¸‹)ï¼Œä¸æ”¯æŒ html5 å’Œåª’ä½“æŸ¥è¯¢ã€‚éœ€è¦åœ¨ html æ–‡æ¡£ &lt;head&gt;&lt;/head&gt;æ ‡ç­¾ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚1234&lt;!--[if lt IE 9]&gt; &lt;script src=&quot;https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt; html5shivï¼šè§£å†³IEæµè§ˆå™¨(IE6ã€IE7ã€IE8)ä¸æ”¯æŒHTML5çš„é—®é¢˜respondï¼šä½¿IEæµè§ˆå™¨(IE6ã€IE7ã€IE8)æ”¯æŒåª’ä½“æŸ¥è¯¢ä¸­çš„min-widthå’Œmax-width ç›¸å¯¹é•¿åº¦å•ä½px: åƒç´ ï¼Œ1ä¸ªpxç›¸å½“äºä¸€ä¸ªåƒç´  em: å…ƒç´ å­—ä½“é«˜åº¦ï¼Œç›¸å¯¹å‚ç…§ç‰©ä¸ºçˆ¶å…ƒç´ çš„ font-sizeã€‚em çš„å€¼å¹¶ä¸å›ºå®šï¼Œä¼šç»§æ‰¿çˆ¶å…ƒç´ çš„å­—ä½“å¤§å° rem: å…ƒç´ å­—ä½“é«˜åº¦ï¼Œç›¸å¯¹å‚ç…§ç‰©ä¸ºæ ¹å…ƒç´  html,ç›¸äºå‚ç…§å›ºå®šä¸å˜ã€‚ç›®å‰ï¼Œé™¤ IE9 ä»¥ä¸‹ç‰ˆæœ¬ï¼Œæ‰€æœ‰æµè§ˆå™¨å‡å·²æ”¯æŒrem æ³¨æ„ï¼š è‹¥remæ²¡æœ‰åœ¨æ ¹å…ƒç´ ï¼ˆhtmlå­—ä½“ï¼‰æŒ‡å®šå‚ç…§å€¼ï¼Œé‚£æµè§ˆå™¨é»˜è®¤1 remå°±æ˜¯16px,è‹¥remæœ‰æŒ‡å®šå€¼ï¼Œåˆ™1remå°±æ˜¯ç­‰äºæŒ‡å®šå€¼ ã€‚ htmlè®¾ç½®ä¸º62.5%æˆ–è€…10pxæ—¶ä¼šå¤±æ•ˆï¼Œæ˜¯å› ä¸ºå°äº12pxæˆ–è€…75%çš„å­—ä½“å¤§å°ä¸æ”¯æŒæ¢ç®—ã€‚è¿™å¯èƒ½ä¸æœ‰äº›æµè§ˆå™¨ä¸æ”¯æŒ12pxä»¥ä¸‹çš„å¤§å°æœ‰å…³ã€‚æ‰€ä»¥ï¼Œä½¿ç”¨remå•ä½ï¼Œhtmlçš„å­—ä½“é»˜è®¤å­—ä½“å¤§å°å¿…é¡»è®¾ç½®ä¸º12pxæˆ–ä»¥ä¸Šã€‚è‹¥å°äº12pxåˆ™æµè§ˆå™¨æ¢ç®—æ—¶è‡ªåŠ¨é»˜è®¤å­—ä½“ä¸º12pxã€‚123456html &#123; font-size: 62.5%; /* 10Ã·16=62.5% */&#125;body &#123; font-size:1.2rem ; /* 12Ã·10=1.2 */&#125; åœ¨å“åº”å¼ç½‘é¡µå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šæ›´å¤šçš„ä½¿ç”¨åˆ° remï¼Œè€Œå¯¹ pxçš„é€‚åº”åŸºæœ¬å¾ˆå°‘ã€‚ å“åº”å¼å¹¿å‘Šç°åœ¨å¤§éƒ¨åˆ†çš„ç½‘é¡µéƒ½ä¼šæœ‰ä¸€ä¸ªæ»šåŠ¨å¹¿å‘Š(è½®æ’­å›¾)ï¼Œä¸€ä¸ªå¥½çš„å¹¿å‘Šæ»šåŠ¨ç»„ä»¶æ”¯æŒï¼š æ”¯æŒä¸åŒçš„å›¾ç‰‡æ•°é‡ æ”¯æŒå“åº”å¼ å…·æœ‰è‰¯å¥½çš„å…¼å®¹æ€§ ç°åœ¨ç½‘ä¸Šæ»šåŠ¨å¹¿å‘Šç»„ä»¶éå¸¸å¤šï¼Œåœ¨è¿™é‡Œæˆ‘åªæ¨èä¸¤ç§ Owl Carousel 2å’Œ myfocusï¼Œéå¸¸è½»é‡ï¼Œä½¿ç”¨æ–‡æ¡£éå¸¸é½å…¨ã€‚è¿™é‡Œï¼Œä¸»è¦è®²ä¸€ä¸‹ Owl Carousel 2çš„ç”¨æ³•ã€‚ Owl Carousel 2 ä¸‹è½½ä¹‹åçš„ç›®å½•ç»“æ„ï¼š 1234567891011121314Owlcarousel2/â”œâ”€â”€ assets/â”‚ â”œâ”€â”€ owl.carousel.cssâ”‚ â”œâ”€â”€ owl.carousel.min.css // ä¸»æ ·å¼æ–‡ä»¶â”‚ â”œâ”€â”€ owl.theme.default.cssâ”‚ â”œâ”€â”€ owl.theme.default.min.css // çš®è‚¤æ ·å¼æ–‡ä»¶â”‚ â”œâ”€â”€ owl.theme.green.cssâ”‚ â”œâ”€â”€ owl.theme.green.min.cssâ”‚ â””â”€â”€ owl.video.play.pngâ”‚â”œâ”€â”€ owl.carousel.jsâ”œâ”€â”€ owl.carousel.min.jsâ”œâ”€â”€ LICENSE-MITâ””â”€â”€ README.md htmlç»“æ„ï¼š12345678910111213&lt;div class=&quot;ad&quot;&gt; &lt;div class=&quot;owl-carousel owl-theme&quot;&gt; &lt;div class=&quot;item&quot;&gt; &lt;img src=&quot;img/ad001.png&quot; alt=&quot;&quot;&gt; // å›¾ç‰‡å°ºå¯¸480*480 &lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;img src=&quot;img/ad002.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;img src=&quot;img/ad003.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; åœ¨htmlæ–‡ä»¶ä¸­å¼•å…¥css:12&lt;link rel=&quot;stylesheet&quot; href=&quot;OwlCarousel2/assets/owl.carousel.min.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;OwlCarousel2/assets/owl.theme.default.min.css&quot;&gt; åœ¨htmlæ–‡ä»¶ä¸­å¼•å…¥js:123&lt;script src=&quot;js/jquery-3.2.1.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;OwlCarousel2/owl.carousel.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;js/main.js&quot;&gt;&lt;/script&gt; mainæ–‡ä»¶è‡ªå·±å®šä¹‰ï¼š123456789$(document).ready(function()&#123; $(&quot;.owl-carousel&quot;).owlCarousel(&#123; items: 1, // ä¸€å±çœ‹åˆ°çš„å›¾ç‰‡æ•°é‡ loop: true, // å¾ªç¯æ»šåŠ¨ autoplay: true, // è‡ªåŠ¨æ’­æ”¾ autoplayTimeout: 3000, // æ—¶é—´é—´éš” autoplayHoverPause: true //é¼ æ ‡æ”¾åœ¨å›¾ç‰‡ä¸Šæš‚åœæ»šåŠ¨ &#125;);&#125;); å½“ç„¶ç°åœ¨æ»šåŠ¨æ•ˆæœå°±å·²ç»å®Œæˆäº†ã€‚ä¸è¿‡è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“å±å¹•å°ºå¯¸æ”¾å¤§æˆ–ç¼©å°æ—¶ï¼Œå§‹ç»ˆéƒ½æ˜¯480å°ºå¯¸çš„å›¾ç‰‡ï¼Œçœ‹èµ·æ¥å°±æ˜¯ä¸çˆ½ï¼Œé‚£ä¹ˆå¦‚ä½•èƒ½å®ç°è®©å›¾ç‰‡åœ¨ä¸åŒè®¾å¤‡ä¸‹è‡ªåŠ¨åˆ‡æ¢æˆæˆ‘ä»¬æƒ³è¦çš„å°ºå¯¸å‘¢ï¼Ÿé‚£ä¹ˆä¸‹é¢å°±éœ€è¦ç”¨åˆ°å“åº”å¼å›¾ç‰‡~ å“åº”å¼å›¾ç‰‡jså’ŒæœåŠ¡ç«¯æ§åˆ¶æå‰åœ¨å›¾ç‰‡åº“å‡†å¤‡ä¸‰å¼ 480ã€800ã€1600å°ºå¯¸çš„å›¾ç‰‡ã€‚1234567891011121314$(function()&#123; function makeImageResponsive()&#123; var img = $(&apos;.cotent img&apos;); var width = $(window).width(); if(width &lt;= 480)&#123; img.attr(&apos;src&apos;, &apos;480.png&apos;); &#125;else if(width &lt;= 800)&#123; img.attr(&apos;src&apos;, &apos;800.png&apos;); &#125;else&#123; img.attr(&apos;src&apos;, &apos;1600.png&apos;); &#125; &#125;$(window).on(&apos;resize load&apos;, makeImageResponsive);&#125;) srcsetå±æ€§é€šè¿‡ srcset æŒ‡å®šç»™ æ ‡ç­¾æ‰€æœ‰å›¾ç‰‡æºçš„ä¿¡æ¯ã€‚ç„¶åä½¿ç”¨é€—å·åˆ†éš”åˆ—å‡ºä¸€ä¸ªä»å°åˆ°å¤§çš„å›¾ç‰‡æºåˆ—è¡¨ã€‚æ¯ä¸ªå›¾ç‰‡æºåå¯ä»¥è·Ÿwæè¿°ç¬¦æˆ–è€…xæè¿°ç¬¦1&lt;img src=&quot;img/480.png&quot; srcset=&quot;img/480.png 480w,img/800.png 800w, img/1600.png 1600w alt=&quot;&quot;&gt; å¦‚æœæµè§ˆå™¨æ”¯æŒ srcset åˆ™ä¼šæ ¹æ®å±å¹•å®½åº¦é‡‡ç”¨æœ€ä½³çš„å›¾ç‰‡ï¼Œå¦åˆ™ç›´æ¥ä¸‹è½½ src å±æ€§å†…çš„å›¾åƒã€‚ pictureå±æ€§pictureæ˜¯html5æ–°å±æ€§ï¼Œå¯ä»¥æ”¾ç½®å¤šä¸ªsourceæ ‡ç­¾ï¼Œä»¥æŒ‡å®šä¸åŒçš„å›¾åƒæ–‡ä»¶åï¼Œè¿›è€Œæ ¹æ®ä¸åŒçš„æ¡ä»¶è¿›è¡ŒåŠ è½½ã€‚ç”±äºç°åœ¨å¾ˆå¤šæµè§ˆå™¨å¯¹äºpictureè¿™ä¸ªæ ‡ç­¾è¿˜ä¸æ”¯æŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼•ç”¨picturefill.jsæ¥è§£å†³ã€‚ 1234567891011121314151617181920212223242526 &lt;div class=&quot;owl-carousel owl-theme&quot;&gt; &lt;div class=&quot;item&quot;&gt; &lt;picture&gt; &lt;source srcset=&quot;img/ad001-l.png&quot; media=&quot;(min-width: 50em)&quot;&gt; &lt;source srcset=&quot;img/ad001-m.png&quot; media=&quot;(min-width: 30em)&quot;&gt; &lt;img srcset=&quot;img/ad001.png&quot; alt=&quot;&quot;&gt; &lt;/picture&gt; &lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;picture&gt; &lt;source srcset=&quot;img/ad002-l.png&quot; media=&quot;(min-width: 50em)&quot;&gt; &lt;source srcset=&quot;img/ad002-m.png&quot; media=&quot;(min-width: 30em)&quot;&gt; &lt;img srcset=&quot;img/ad002.png&quot; alt=&quot;&quot;&gt; &lt;/picture&gt; &lt;/div&gt; &lt;div class=&quot;item&quot;&gt; &lt;picture&gt; &lt;source srcset=&quot;img/ad003-l.png&quot; media=&quot;(min-width: 50em)&quot;&gt; &lt;source srcset=&quot;img/ad003-m.png&quot; media=&quot;(min-width: 30em)&quot;&gt; &lt;img srcset=&quot;img/ad003.png&quot; alt=&quot;&quot;&gt; &lt;/picture&gt; &lt;/div&gt;&lt;/div&gt;&lt;!-- åœ¨ body æœ«å°¾å¼•å…¥--&gt;&lt;script src=&quot;js/vendor/picturefill.min.js&quot;&gt;&lt;/script&gt; åœ¨å¤§äº800pxçš„æ—¶å€™ï¼Œå±•ç¤ºad00x-lè¿™ä¸ªlargeå›¾ç‰‡ã€‚åœ¨å¤§äº480pxçš„æ—¶å€™ï¼Œå±•ç¤ºad00x-mè¿™ä¸ªmediumå›¾ç‰‡ã€‚å¦åˆ™ï¼Œå±•ç¤ºad00xå°å›¾ç‰‡ã€‚å®Œç¾è§£å†³å›¾ç‰‡å“åº”å¼é—®é¢˜ï¼ŒæåŠ›æ¨èè¿™ç§æ–¹æ³•ã€‚ æ‰“åŒ…å‘å¸ƒå½“æ‰€æœ‰çš„ä»£ç å®Œæˆä¹‹åï¼Œæˆ‘ä»¬çš„ç½‘ç«™å°±å¯ä»¥å‘å¸ƒäº†ï¼Œåœ¨å‘å¸ƒä¹‹å‰æˆ‘ä»¬è¿˜å¯ä»¥å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼š å‹ç¼© åˆå¹¶ å¢åŠ ç‰ˆæœ¬å· åœ¨çº¿å‹ç¼©:(https://javascript-minifier.com/) å·¥å…·æ‰“åŒ…ï¼š Gruntï¼šè‡ªåŠ¨åŒ–æ„å»ºå·¥å…· Gulpï¼šè‡ªåŠ¨åŒ–æ„å»ºå·¥å…· Webpack:é™æ€èµ„æºæ‰“åŒ…å·¥å…· 3ä¸ªä¸»æµå·¥å…·æˆ‘å°±ä¸è¯¦ç»†ä¸€ ä¸€ä»‹ç»äº†ã€‚è¿™é‡Œï¼Œä¸»è¦ä½¿ç”¨ gulp æ¥æ‰“åŒ…å‘å¸ƒï¼Œé¦–å…ˆæ¥å®‰è£…gulpã€‚ ç¬¬ä¸€æ­¥ï¼šå®‰è£…Nodejs åœ¨ Node.js å®˜ç½‘ï¼šhttps://nodejs.org/en/ ä¸‹è½½å®‰è£…åŒ… ä¿æŒé»˜è®¤è®¾ç½®å³å¯ï¼Œä¸€è·¯Nextï¼Œå®‰è£…å¾ˆå¿«å°±ç»“æŸäº†ã€‚ ç„¶åæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œè¾“å…¥ node -vã€npm -vï¼Œå‡ºç°ç‰ˆæœ¬å·åˆ™è¯´æ˜ Node.js ç¯å¢ƒé…ç½®æˆåŠŸï¼Œç¬¬ä¸€æ­¥å®Œæˆï¼ï¼ï¼ ç¬¬äºŒæ­¥ï¼šå®‰è£…Git åœ¨ Git å®˜ç½‘ï¼šhttps://git-scm.com/ ä¸‹è½½å®‰è£…åŒ… å®‰è£…å®Œæˆåï¼Œæ¡Œé¢å³é”®ï¼Œæ‰“å¼€ Git Bush Hereï¼Œè¾“å…¥ git --versionï¼Œå‡ºç°ç‰ˆæœ¬å·åˆ™è¯´æ˜ Git ç¯å¢ƒé…ç½®æˆåŠŸï¼Œç¬¬äºŒæ­¥å®Œæˆï¼ï¼ï¼ ç¬¬ä¸‰æ­¥ï¼šå®‰è£…Gulp(å…¨å±€) æ¡Œé¢å³é”®ï¼Œæ‰“å¼€ Git Bush Hereï¼Œè¾“å…¥npm install gulp -g å®‰è£…å®Œæˆåï¼ŒåŒæ ·è¾“å…¥ gulp -vï¼Œå‡ºç°ç‰ˆæœ¬å·åˆ™è¯´æ˜ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸã€‚ ç¬¬å››æ­¥ï¼šä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…1$ npm install --save-dev gulp ç¬¬äº”æ­¥ï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æ–°å»ºä¸€ä¸ª dist æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾å‹ç¼©åçš„æ–‡ä»¶123456789101112131415161718192021222324252627var gulp = require(&apos;gulp&apos;);var rev = require(&apos;gulp-rev&apos;);var revReplace = require(&apos;gulp-rev-replace&apos;);var useref = require(&apos;gulp-useref&apos;);var filter = require(&apos;gulp-filter&apos;);var uglify = require(&apos;gulp-uglify&apos;);var csso = require(&apos;gulp-csso&apos;);gulp.task(&apos;default&apos;, function() &#123; var jsFilter = filter(&apos;**/*.js&apos;, &#123;restore: true&#125;); var cssFilter = filter(&apos;**/*.css&apos;, &#123;restore: true&#125;); var indexHtmlFilter = filter([&apos;**/*&apos;, &apos;!**/index.html&apos;], &#123;restore: true&#125;); return gulp.src(&apos;src/index.html&apos;) .pipe(useref()) .pipe(jsFilter) .pipe(uglify()) .pipe(jsFilter.restore) .pipe(cssFilter) .pipe(csso()) .pipe(cssFilter.restore) .pipe(indexHtmlFilter) .pipe(rev()) .pipe(indexHtmlFilter.restore) .pipe(revReplace()) .pipe(gulp.dest(&apos;dist&apos;));&#125;); ç¬¬å…­æ­¥ï¼šå®‰è£…ä»¥ä¸Šéœ€è¦çš„gulpæ’ä»¶ï¼š1$ npm install gulp gulp-rev gulp-rev-replace gulp-useref gulp-filter gulp-filter gulp-uglify gulp-csso --save-dev ç¬¬ä¸ƒæ­¥ï¼šå°† htlm ä¸­éœ€è¦æ‰“åŒ…åˆå¹¶çš„æ–‡ä»¶æ·»åŠ æ³¨é‡Š1234567891011121314&lt;!-- build:css css/combined.css --&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/normalize.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;js/vendor/OwlCarousel2/assets/owl.carousel.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;js/vendor/OwlCarousel2/assets/owl.theme.default.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot;&gt;&lt;!-- endbuild --&gt;&lt;!-- build:js js/combined.js --&gt;&lt;script src=&quot;js/jquery-3.2.1.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;js/vendor/OwlCarousel2/owl.carousel.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;js/vendor/picturefill.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;js/main.js&quot;&gt;&lt;/script&gt;&lt;!-- endbuild --&gt; ç¬¬å…«æ­¥ï¼šæ‰§è¡Œgulp1$ gulp æ‰§è¡Œgulpä¹‹åï¼Œä½ ä¼šåœ¨æ–°å»ºçš„ dist æ–‡ä»¶å¤¹ä¸­çœ‹åˆ°æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ï¼Œç›®å½•å¦‚ä¸‹ï¼š12345678dist/â”œâ”€â”€ css/â”‚ â”œâ”€â”€combined-3f8e363e08.css // æ‰“åŒ…åˆå¹¶åçš„cssæ–‡ä»¶â”‚ â””â”€â”€combined-56ca943019.cssâ”œâ”€â”€ img/â”œâ”€â”€ js/â”‚ â””â”€â”€ combined-7762fa2c22.js // æ‰“åŒ…åˆå¹¶åçš„jsæ–‡ä»¶â””â”€â”€ index.html è¿™æ—¶å€™ css, js æ–‡ä»¶éƒ½è¢«å‹ç¼©åˆå¹¶æˆäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œçœ‹èµ·æ¥æ›´åŠ è½»é‡ã€‚å¦‚æœä½ ä¿®æ”¹äº†æºä»£ç ä¸­çš„å†…å®¹ï¼Œåªéœ€å†æ¬¡æ‰§è¡Œgulp ï¼Œåˆ™ä¼šç”Ÿæˆå¦ä¸€ä¸ªå¿ƒå¾—cssæˆ–jsæ–‡ä»¶ï¼Œç‰ˆæœ¬å·ä¼šæ›´æ–°ï¼Œä¸ä¼šè¦†ç›–ä¹‹å‰çš„æ–‡ä»¶ã€‚å¦‚ä¸Šé¢ç”Ÿæˆæ–°çš„ combined-56ca943019.css æ–‡ä»¶ï¼Œä¹Ÿä¿ç•™ä¹‹å‰çš„ combined-3f8e363e08.cssã€‚ æ€»ç»“æœ¬ç¯‡æ–‡ç« åŒ…å«äº†å“åº”å¼ç½‘ç«™å¼€å‘ä¸­å¸¸è§çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›å¯¹çƒ­çˆ±å‰ç«¯å¼€å‘çš„åŒå­¦æœ‰æ‰€å¸®åŠ©ï¼Œèƒ½è®©ä½ ä»¬åœ¨ä»¥åçš„å“åº”å¼å¼€å‘ä¸­å°‘èµ°å¼¯è·¯ã€‚ åœ¨çº¿æ¼”ç¤ºï¼šhttp://https://pengfeidai.github.io/responsive-lichaibao/dist/index é¡¹ç›®æºç ï¼šhttps://github.com/pengfeidai/responsive-lichaibao","categories":[],"tags":[{"name":"HTML","slug":"HTML","permalink":"https://pengfeidai.github.io/tags/HTML/"},{"name":"CSS","slug":"CSS","permalink":"https://pengfeidai.github.io/tags/CSS/"},{"name":"gulp","slug":"gulp","permalink":"https://pengfeidai.github.io/tags/gulp/"},{"name":"å“åº”å¼ç½‘ç«™","slug":"å“åº”å¼ç½‘ç«™","permalink":"https://pengfeidai.github.io/tags/å“åº”å¼ç½‘ç«™/"}]}]}